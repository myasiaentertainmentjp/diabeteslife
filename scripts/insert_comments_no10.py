#!/usr/bin/env python3
"""Insert 150 comments for thread No.10: ã€å ±å‘Šã€‘ä»Šæ—¥ã®HbA1cãƒ»æ¤œæŸ»çµæžœ"""

import uuid
import json
import urllib.request
from datetime import datetime, timedelta

SUPABASE_URL = "https://josanlblwfjdaaezqbnw.supabase.co"
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impvc2FubGJsd2ZqZGFhZXpxYm53Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2Nzg0MjYwNiwiZXhwIjoyMDgzNDE4NjA2fQ.JlTXBmY5HJAqfRD_AazsiBORpgLZfB74fPkNyyfVSQY"

THREAD_ID = "f6c74f94-cb2d-456a-882b-5a25915a7aa5"
THREAD_OWNER_ID = "2033ee1c-28b2-5187-8ba1-c94f7964e33e"

# Dummy user pool (select diverse users)
USERS = [
    "b0000001-0000-0000-0000-000000000001",  # ã‚ˆã£ã—ãƒ¼
    "b0000001-0000-0000-0000-000000000002",  # ã¾ã‚†ã¿
    "b0000001-0000-0000-0000-000000000003",  # ãŸã‘ã—
    "b0000001-0000-0000-0000-000000000004",  # ã•ã¡ã“
    "b0000001-0000-0000-0000-000000000005",  # ã“ã†ãŸ
    "b0000001-0000-0000-0000-000000000006",  # ã‚†ã‹ã‚Š
    "b0000001-0000-0000-0000-000000000007",  # ã¾ã•ã²ã‚
    "b0000001-0000-0000-0000-000000000008",  # ã¨ã‚‚ã“
    "b0000001-0000-0000-0000-000000000009",  # ã—ã‚“ã˜
    "b0000001-0000-0000-0000-000000000010",  # ã²ã‚ã¿
    "b0000001-0000-0000-0000-000000000011",  # ã ã„ã™ã‘
    "b0000001-0000-0000-0000-000000000012",  # ã‚ã‘ã¿
    "b0000001-0000-0000-0000-000000000013",  # ã‘ã‚“ãŸ
    "b0000001-0000-0000-0000-000000000014",  # ã¿ã¡ã“
    "b0000001-0000-0000-0000-000000000015",  # ã‚Šã‚‡ã†ãŸ
    "f0000001-0000-0000-0000-000000000001",  # ã¿ãƒ¼ãƒžãƒž
    "f0000001-0000-0000-0000-000000000002",  # ã‚±ãƒ³ãƒ‘ãƒ‘
    "f0000001-0000-0000-0000-000000000005",  # ã‚†ã†ã“
    "f0000001-0000-0000-0000-000000000006",  # ã‘ã‚“ã˜
    "f0000001-0000-0000-0000-000000000009",  # ã²ãªã®
    "f0000001-0000-0000-0000-000000000010",  # ã¨ã—ã
    "f0000001-0000-0000-0000-000000000008",  # ã¾ã•ãŠ
    "f0000001-0000-0000-0000-000000000003",  # ã•ãã‚‰
    "f0000001-0000-0000-0000-000000000004",  # ãŸã£ãã‚“çˆ¶
    "b0000001-0000-0000-0000-000000000016",  # ãªãŠã“
    "b0000001-0000-0000-0000-000000000017",  # ã¦ã¤ã‚„
    "b0000001-0000-0000-0000-000000000018",  # ã‹ãšãˆ
    "b0000001-0000-0000-0000-000000000019",  # ã‚†ã†ã‚„
    "b0000001-0000-0000-0000-000000000020",  # ã‚Œã„ã“
    THREAD_OWNER_ID,  # Ash (thread owner)
]

# CSV data: (number, reply_to, body, datetime_jst)
COMMENTS = [
    (2, None, "ä»Šæ—¥æ¤œæŸ»è¡Œã£ã¦ããŸï¼HbA1c 6.8%ã§ã—ãŸã€‚å‰å›ž7.2%ã ã£ãŸã‹ã‚‰å¬‰ã—ã„", "2025-12-15 15:00"),
    (3, 2, "ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ä¸‹ãŒã£ã¦ã¾ã™ã­âœ¨", "2025-12-15 15:30"),
    (4, None, "ç§ã‚‚ä»Šæ—¥ã§ã—ãŸã€‚7.1%â†’6.9%ï¼åœ°å‘³ã«å¬‰ã—ã„", "2025-12-15 16:00"),
    (5, 4, "0.2%ã§ã‚‚ä¸‹ãŒã‚‹ã¨é”æˆæ„Ÿã‚ã‚Šã¾ã™ã‚ˆã­", "2025-12-15 16:30"),
    (6, None, "ç©ºè…¹æ™‚è¡€ç³–108ã§ã—ãŸã€‚ã¾ã‚ã¾ã‚ã‹ãª", "2025-12-15 17:00"),
    (7, None, "HbA1c 8.2%â€¦å…¨ç„¶ãƒ€ãƒ¡ã ã£ãŸðŸ˜­", "2025-12-15 19:00"),
    (8, 7, "æ¬¡ãŒã‚ã‚Šã¾ã™ã‚ˆï¼ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†", "2025-12-15 19:30"),
    (9, 7, "ç§ã‚‚æœ€åˆã¯8%å°ã§ã—ãŸã€‚å°‘ã—ãšã¤ä¸‹ãŒã‚Šã¾ã™ã‚ˆ", "2025-12-15 20:00"),
    (10, None, "3ãƒ¶æœˆã¶ã‚Šã®æ¤œæŸ»ç·Šå¼µã™ã‚‹â€¦", "2025-12-16 08:00"),
    (11, 10, "çµæžœå ±å‘Šå¾…ã£ã¦ã¾ã™ï¼", "2025-12-16 08:30"),
    (12, 10, "è¡Œã£ã¦ãã¾ã—ãŸï¼6.5%ã‚­ãƒ¼ãƒ—ã§ãã¦ãŸï¼", "2025-12-16 14:00"),
    (13, 12, "ã™ã”ã„ï¼6.5%ã‚­ãƒ¼ãƒ—ã¯ç´ æ™´ã‚‰ã—ã„ðŸ‘", "2025-12-16 14:30"),
    (14, None, "ä»Šæ—¥ã®ç©ºè…¹æ™‚è¡€ç³–98ï¼ä¹…ã€…ã®2æ¡", "2025-12-16 18:00"),
    (15, 14, "2æ¡ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼", "2025-12-16 18:30"),
    (16, None, "å…ˆç”Ÿã«è¤’ã‚ã‚‰ã‚ŒãŸï¼HbA1c 6.3%", "2025-12-16 19:00"),
    (17, 16, "6.3%ã™ã”ã™ãŽã‚‹â€¦ç›®æ¨™ã«ã—ã¾ã™", "2025-12-16 19:30"),
    (18, None, "è…Žæ©Ÿèƒ½ã‚‚å•é¡Œãªã—ã§ãƒ›ãƒƒã¨ã—ãŸ", "2025-12-17 10:00"),
    (19, 18, "åˆä½µç—‡ã®æ¤œæŸ»ã‚‚å¤§äº‹ã§ã™ã‚ˆã­", "2025-12-17 10:30"),
    (20, None, "LDLã‚³ãƒ¬ã‚¹ãƒ†ãƒ­ãƒ¼ãƒ«ãŒé«˜ã‹ã£ãŸâ€¦ç³–å°¿ç—…ã¨é–¢ä¿‚ã‚ã‚‹ï¼Ÿ", "2025-12-17 12:00"),
    (21, 20, "è„‚è³ªç•°å¸¸ã‚‚åˆä½µã—ã‚„ã™ã„ã¿ãŸã„ã§ã™ã‚ˆ", "2025-12-17 12:30"),
    (22, None, "HbA1c 7.5%ã‹ã‚‰7.0%ã«ä¸‹ãŒã£ãŸï¼", "2025-12-17 15:00"),
    (23, 22, "åŠå¹´ã§0.5%ã¯ç«‹æ´¾ã§ã™ï¼", "2025-12-17 15:30"),
    (24, None, "é£Ÿå¾Œ2æ™‚é–“è¡€ç³–ãŒ180è¶…ãˆã¡ã‚ƒã£ãŸ", "2025-12-17 19:00"),
    (25, 24, "ä½•é£Ÿã¹ã¾ã—ãŸã‹ï¼Ÿ", "2025-12-17 19:30"),
    (26, 25, "ã‚«ãƒ¬ãƒ¼ãƒ©ã‚¤ã‚¹â€¦ã‚„ã£ã±ãƒ€ãƒ¡ã ã£ãŸ", "2025-12-17 20:00"),
    (27, 26, "ã‚«ãƒ¬ãƒ¼ã¯ç³–è³ªã®å¡Šã§ã™ã‚‚ã‚“ã­ðŸ’¦", "2025-12-17 20:30"),
    (28, None, "ä»Šæ—¥ã®æ¤œæŸ»ã€HbA1cå¤‰ã‚ã‚‰ãš7.0%ã€‚ç¾çŠ¶ç¶­æŒ", "2025-12-18 16:00"),
    (29, 28, "æ‚ªããªã£ã¦ãªã„ãªã‚‰è‰¯ã„ã¨æ€ã„ã¾ã™ï¼", "2025-12-18 16:30"),
    (30, None, "å°¿æ¤œæŸ»ã‚‚ç•°å¸¸ãªã—ã ã£ãŸ", "2025-12-18 19:00"),
    (31, None, "æ˜Žæ—¥æ¤œæŸ»ãªã®ã«æ˜¨æ—¥é£Ÿã¹ã™ãŽãŸâ€¦", "2025-12-19 07:00"),
    (32, 31, "1æ—¥ãã‚‰ã„å¤§ä¸ˆå¤«ã§ã™ã‚ˆå¤šåˆ†", "2025-12-19 07:30"),
    (33, None, "HbA1c 6.0%åˆ‡ã‚ŠãŸã„", "2025-12-19 12:00"),
    (34, 33, "5%å°ã¯è–¬ãªã—ã®äººã®ç›®æ¨™ã§ã™ã‚ˆã­", "2025-12-19 12:30"),
    (35, None, "æ¤œæŸ»è¡Œã£ã¦ããŸã€‚7.3%â†’7.1%å¾®æ¸›", "2025-12-19 17:00"),
    (36, 35, "æ¸›ã£ã¦ã‚‹ãªã‚‰é †èª¿ï¼", "2025-12-19 17:30"),
    (37, None, "å¹´å†…æœ€å¾Œã®æ¤œæŸ»çµ‚ã‚ã£ãŸã€œ", "2025-12-20 15:00"),
    (38, 37, "ãŠç–²ã‚Œæ§˜ã§ã™ï¼çµæžœã¯ï¼Ÿ", "2025-12-20 15:30"),
    (39, 38, "6.7%ã§ã—ãŸï¼å¹´è¶Šã—ã§ãã‚‹ç¬‘", "2025-12-20 16:00"),
    (40, 39, "è‰¯ã„æ•°å€¤ã§å¹´è¶Šã—ã§ãã¾ã™ã­âœ¨", "2025-12-20 16:30"),
    (41, None, "ä¸­æ€§è„‚è‚ªãŒä¸‹ãŒã£ã¦ãŸã€‚é‹å‹•ã®åŠ¹æžœã‹ãª", "2025-12-20 19:00"),
    (42, None, "Î³-GTPã‚‚æ­£å¸¸ç¯„å›²ã«ãªã£ãŸ", "2025-12-21 10:00"),
    (43, 42, "ãŠé…’æŽ§ãˆã¦ã¾ã™ã‹ï¼Ÿ", "2025-12-21 10:30"),
    (44, 43, "é€±1ã«æ¸›ã‚‰ã—ã¾ã—ãŸ", "2025-12-21 11:00"),
    (45, None, "ã‚¯ãƒ¬ã‚¢ãƒãƒ‹ãƒ³å€¤ãŒæ°—ã«ãªã‚‹â€¦", "2025-12-21 14:00"),
    (46, 45, "è…Žè‡“å¤§äº‹ã«ã—ãªã„ã¨ã§ã™ã‚ˆã­", "2025-12-21 14:30"),
    (47, None, "ä»Šæ—¥ã®ç©ºè…¹æ™‚115ã€‚ã‚‚ã†å°‘ã—ä¸‹ã’ãŸã„", "2025-12-21 18:00"),
    (48, None, "HbA1c 5.9%å‡ºã¾ã—ãŸï¼è–¬æ¸›ã‚‰ã›ã‚‹ã‹ã‚‚", "2025-12-22 11:00"),
    (49, 48, "5%å°ã™ã”ã„ï¼ï¼ã©ã†ã‚„ã£ã¦ï¼Ÿ", "2025-12-22 11:30"),
    (50, 49, "ç³–è³ªåˆ¶é™ã¨æ¯Žæ—¥30åˆ†ã®ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ã§ã™", "2025-12-22 12:00"),
    (51, 50, "å‚è€ƒã«ãªã‚Šã¾ã™ï¼ç§ã‚‚é ‘å¼µã‚ã†", "2025-12-22 12:30"),
    (52, None, "ä»Šå¹´æœ€å¾Œã®æ¤œæŸ»ã€7.8%ã ã£ãŸâ€¦æ¥å¹´ã“ã", "2025-12-22 17:00"),
    (53, 52, "æ¥å¹´ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ðŸ’ª", "2025-12-22 17:30"),
    (54, None, "è¡€åœ§ã‚‚æ¸¬ã£ã¦ã‚‚ã‚‰ã£ãŸã‚‰é«˜ã‚ã ã£ãŸ", "2025-12-23 10:00"),
    (55, 54, "ç³–å°¿ç—…ã¨é«˜è¡€åœ§ã¯ã‚»ãƒƒãƒˆã«ãªã‚Šã‚„ã™ã„ã§ã™ã‚ˆã­", "2025-12-23 10:30"),
    (56, None, "çœ¼åº•æ¤œæŸ»ã‚‚ç•°å¸¸ãªã—ï¼", "2025-12-23 15:00"),
    (57, 56, "ç›®ã®æ¤œæŸ»ã‚‚å®šæœŸçš„ã«è¡Œã‹ãªã„ã¨ã§ã™ã‚ˆã­", "2025-12-23 15:30"),
    (58, None, "å¹´æœ«é§†ã‘è¾¼ã¿ã§æ¤œæŸ»è¡Œã£ã¦ããŸ", "2025-12-26 14:00"),
    (59, 58, "ç§ã‚‚æ˜Žæ—¥è¡Œãäºˆå®šã§ã™", "2025-12-26 14:30"),
    (60, None, "6.6%ã§ã—ãŸï¼ç›®æ¨™ã®6.5%ã¾ã§ã‚ã¨å°‘ã—", "2025-12-26 17:00"),
    (61, 60, "ã‚‚ã†ã»ã¼é”æˆã˜ã‚ƒãªã„ã§ã™ã‹ï¼", "2025-12-26 17:30"),
    (62, None, "ä»Šå¹´ã®æ¤œæŸ»å…¨éƒ¨çµ‚ã‚ã£ãŸã€œ", "2025-12-27 11:00"),
    (63, 62, "ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼è‰¯ã„ãŠå¹´ã‚’", "2025-12-27 11:30"),
    (64, None, "æ­£æœˆæ˜Žã‘ã®æ¤œæŸ»ãŒä»Šã‹ã‚‰æ€–ã„", "2025-12-28 19:00"),
    (65, 64, "ã‚ã‹ã‚‹â€¦é£Ÿã¹ã™ãŽç¢ºå®šã ã—", "2025-12-28 19:30"),
    (66, None, "1æœˆã®æ¤œæŸ»äºˆç´„å…¥ã‚ŒãŸ", "2025-12-30 10:00"),
    (67, None, "å¹´æ˜Žã‘ä¸€ç™ºç›®ã®æ¤œæŸ»ã€è¦šæ‚Ÿæ±ºã‚ãŸ", "2026-01-04 09:00"),
    (68, 67, "ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼", "2026-01-04 09:30"),
    (69, None, "æ­£æœˆã®å½±éŸ¿å‡ºã¦ã‚‹ã‹ãªâ€¦ãƒ‰ã‚­ãƒ‰ã‚­", "2026-01-06 08:00"),
    (70, None, "æ¤œæŸ»è¡Œã£ã¦ããŸã€‚HbA1c 7.2%â€¦ä¸ŠãŒã£ã¦ãŸðŸ˜­", "2026-01-06 16:00"),
    (71, 70, "æ­£æœˆã ã‹ã‚‰ä»•æ–¹ãªã„ï¼åˆ‡ã‚Šæ›¿ãˆã¾ã—ã‚‡ã†", "2026-01-06 16:30"),
    (72, 70, "ç§ã‚‚ä¸ŠãŒã£ã¦ã¾ã—ãŸã€‚ãŠäº’ã„é ‘å¼µã‚ã†", "2026-01-06 17:00"),
    (73, None, "æ„å¤–ã¨ä¸ŠãŒã£ã¦ãªã‹ã£ãŸï¼6.9%ã‚­ãƒ¼ãƒ—", "2026-01-07 15:00"),
    (74, 73, "æ­£æœˆä¹—ã‚Šè¶Šãˆã¦ã‚­ãƒ¼ãƒ—ã¯ã™ã”ã„ï¼", "2026-01-07 15:30"),
    (75, None, "ç©ºè…¹æ™‚è¡€ç³–125ã€‚æ­£æœˆå‰ã¯110ã ã£ãŸã®ã«", "2026-01-07 18:00"),
    (76, 75, "15ä¸ŠãŒã‚Šã¯æƒ³å®šå†…ã‹ã‚‚ã€‚ã™ãæˆ»ã‚Šã¾ã™ã‚ˆ", "2026-01-07 18:30"),
    (77, None, "ä»Šå¹´ã“ã6%å°ç›®æŒ‡ã™", "2026-01-08 12:00"),
    (78, 77, "ç›®æ¨™å¤§äº‹ã§ã™ã‚ˆã­ï¼å¿œæ´ã—ã¦ã¾ã™", "2026-01-08 12:30"),
    (79, None, "æ¤œæŸ»çµæžœã€LDLãŒã‚„ã°ã‹ã£ãŸ", "2026-01-09 14:00"),
    (80, 79, "ç§ã‚‚LDLé«˜ã„ã§ã™ã€‚ã‚¹ã‚¿ãƒãƒ³é£²ã‚“ã§ã¾ã™", "2026-01-09 14:30"),
    (81, None, "HbA1c 6.4%ï¼è‡ªå·±ãƒ™ã‚¹ãƒˆæ›´æ–°", "2026-01-10 11:00"),
    (82, 81, "ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ðŸŽ‰", "2026-01-10 11:30"),
    (83, 81, "ã™ã”ã„ï¼ç§˜è¨£æ•™ãˆã¦ãã ã•ã„", "2026-01-10 12:00"),
    (84, 83, "é–“é£Ÿã‚’å®Œå…¨ã«ã‚„ã‚ã¾ã—ãŸ", "2026-01-10 12:30"),
    (85, None, "ä»Šæ—¥ã®æ¤œæŸ»ã€ç·Šå¼µã—ãŸã‘ã©7.0%ã‚¸ãƒ£ã‚¹ãƒˆ", "2026-01-13 16:00"),
    (86, 85, "7.0%ã¯åˆæ ¼ãƒ©ã‚¤ãƒ³ã§ã™ã‚ˆã­", "2026-01-13 16:30"),
    (87, None, "å…ˆç”Ÿã«ã€Œã“ã®èª¿å­ã§ã€ã£ã¦è¨€ã‚ã‚ŒãŸ", "2026-01-13 19:00"),
    (88, 87, "è¤’ã‚ã‚‰ã‚Œã‚‹ã¨å¬‰ã—ã„ã§ã™ã‚ˆã­", "2026-01-13 19:30"),
    (89, None, "é£Ÿå¾Œè¡€ç³–æ¸¬ã£ãŸã‚‰200è¶…ãˆã¦ãŸâ€¦", "2026-01-14 20:00"),
    (90, 89, "ä½•é£Ÿã¹ã¾ã—ãŸã‹ï¼Ÿ", "2026-01-14 20:30"),
    (91, 90, "ãƒ©ãƒ¼ãƒ¡ãƒ³+ãƒãƒ£ãƒ¼ãƒãƒ³â€¦", "2026-01-14 21:00"),
    (92, 91, "ãã‚Œã¯ä»•æ–¹ãªã„ç¬‘ æ¬¡æ°—ã‚’ã¤ã‘ã‚Œã°OK", "2026-01-14 21:30"),
    (93, None, "3ãƒ¶æœˆå‰ã‚ˆã‚Š1%ä¸‹ãŒã£ãŸï¼åŠªåŠ›ãŒå ±ã‚ã‚ŒãŸ", "2026-01-15 15:00"),
    (94, 93, "1%ã¯ã™ã”ã„ï¼ä½•ã—ãŸã‚“ã§ã™ã‹ï¼Ÿ", "2026-01-15 15:30"),
    (95, 94, "æ¯Žæ—¥1ä¸‡æ­©ã¨å¤œã®ç‚­æ°´åŒ–ç‰©ã‚«ãƒƒãƒˆ", "2026-01-15 16:00"),
    (96, 95, "çœŸä¼¼ã—ã¦ã¿ã¾ã™ï¼", "2026-01-15 16:30"),
    (97, None, "å¾®é‡ã‚¢ãƒ«ãƒ–ãƒŸãƒ³å‡ºã¦ãŸâ€¦ã‚·ãƒ§ãƒƒã‚¯", "2026-01-17 14:00"),
    (98, 97, "æ—©æœŸç™ºè¦‹ã§ãã¦ã‚ˆã‹ã£ãŸã¨æ€ã„ã¾ã—ã‚‡ã†", "2026-01-17 14:30"),
    (99, 97, "ç§ã‚‚å‡ºã¦ã¾ã™ã€‚è¡€åœ§ç®¡ç†ã‚‚å¤§äº‹ã¿ãŸã„ã§ã™ã‚ˆ", "2026-01-17 15:00"),
    (100, None, "100ã‚³ãƒ¡ãƒ³ãƒˆï¼ã¿ã‚“ãªé ‘å¼µã£ã¦ã‚‹", "2026-01-18 12:00"),
    (101, 100, "å ±å‘Šã—åˆãˆã‚‹ã®åŠ±ã¿ã«ãªã‚Šã¾ã™ã‚ˆã­", "2026-01-18 12:30"),
    (102, None, "ä»Šæœˆ2å›žç›®ã®æ¤œæŸ»ã€‚6.8%ã§å®‰å®š", "2026-01-20 11:00"),
    (103, 102, "å®‰å®šã—ã¦ã‚‹ã®ãŒä¸€ç•ªã§ã™ã‚ˆã­", "2026-01-20 11:30"),
    (104, None, "ã‚¤ãƒ³ã‚¹ãƒªãƒ³å˜ä½æ¸›ã‚‰ã›ã‚‹ã‹ã‚‚ã£ã¦è¨€ã‚ã‚ŒãŸï¼", "2026-01-21 16:00"),
    (105, 104, "ã™ã”ã„ï¼åŠªåŠ›ã®æˆæžœã§ã™ã­", "2026-01-21 16:30"),
    (106, None, "å°¿é…¸å€¤ã‚‚é«˜ã‹ã£ãŸâ€¦ç—›é¢¨æ€–ã„", "2026-01-22 10:00"),
    (107, 106, "ç§ã‚‚å°¿é…¸é«˜ã‚ã€‚ãƒ“ãƒ¼ãƒ«æŽ§ãˆã¦ã¾ã™", "2026-01-22 10:30"),
    (108, None, "ç©ºè…¹æ™‚è¡€ç³–95ï¼åˆã‚ã¦100åˆ‡ã£ãŸ", "2026-01-24 09:00"),
    (109, 108, "2æ¡ãŠã‚ã§ã¨ã†ï¼ç›®æ¨™é”æˆã§ã™ã­", "2026-01-24 09:30"),
    (110, None, "HbA1cæ¨ªã°ã„ã ã£ãŸã‘ã©ä¸ŠãŒã£ã¦ãªã„ã‹ã‚‰OK", "2026-01-25 17:00"),
    (111, 110, "ç¾çŠ¶ç¶­æŒã‚‚ç«‹æ´¾ãªæˆæžœã§ã™ã‚ˆ", "2026-01-25 17:30"),
    (112, None, "ä»Šæ—¥ã®æ¤œæŸ»ã§è–¬è¿½åŠ ã«ãªã£ãŸâ€¦", "2026-01-27 14:00"),
    (113, 112, "è–¬å¢—ãˆã‚‹ã®ã‚·ãƒ§ãƒƒã‚¯ã§ã™ã‚ˆã­ã€‚ã§ã‚‚ä½“ã®ãŸã‚ã§ã™", "2026-01-27 14:30"),
    (114, 112, "ç§ã‚‚æœ€åˆã¯æŠµæŠ—ã‚ã£ãŸã‘ã©ã€æ•°å€¤å®‰å®šã—ã¾ã—ãŸã‚ˆ", "2026-01-27 15:00"),
    # Future comments (after 2026-01-27)
    (115, None, "ã‚°ãƒªã‚³ã‚¢ãƒ«ãƒ–ãƒŸãƒ³æ¤œæŸ»ã‚‚ã—ãŸ", "2026-01-28 11:00"),
    (116, 115, "HbA1cã‚ˆã‚ŠçŸ­æœŸã®å¤‰å‹•ã‚ã‹ã‚‹ã‚„ã¤ã§ã™ã‚ˆã­", "2026-01-28 11:30"),
    (117, None, "2æœˆã®æ¤œæŸ»ã«å‘ã‘ã¦é ‘å¼µã‚‹", "2026-01-30 20:00"),
    (118, 117, "ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼", "2026-01-30 20:30"),
    (119, None, "ä»Šæ—¥æ¤œæŸ»æ—¥ã€‚æœã”é£¯æŠœãã§ç©ºè…¹â€¦", "2026-02-03 08:00"),
    (120, 119, "çµ‚ã‚ã£ãŸã‚‰ã”è¤’ç¾Žã«ä½•ã‹é£Ÿã¹ã¾ã—ã‚‡ã†ç¬‘", "2026-02-03 08:30"),
    (121, 119, "çµæžœå‡ºã¾ã—ãŸï¼6.7%!", "2026-02-03 14:00"),
    (122, 121, "ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼é †èª¿ã§ã™ã­", "2026-02-03 14:30"),
    (123, None, "é£Ÿå¾Œè¡€ç³–ãŒå®‰å®šã—ã¦ããŸã€‚160ä»¥ä¸‹ã§åŽã¾ã‚‹", "2026-02-05 19:00"),
    (124, 123, "ã„ã„æ„Ÿã˜ã§ã™ã­ï¼ä½•ã‹å¤‰ãˆã¾ã—ãŸï¼Ÿ", "2026-02-05 19:30"),
    (125, 124, "é£Ÿäº‹ã®æœ€åˆã«ã‚µãƒ©ãƒ€å±±ç››ã‚Šé£Ÿã¹ã‚‹ã‚ˆã†ã«ã—ãŸ", "2026-02-05 20:00"),
    (126, None, "Cãƒšãƒ—ãƒãƒ‰æ¤œæŸ»ã‚‚ã—ãŸã€‚ã‚¤ãƒ³ã‚¹ãƒªãƒ³åˆ†æ³Œã¾ã ã‚ã‚‹", "2026-02-07 15:00"),
    (127, 126, "åˆ†æ³Œèƒ½åŠ›æ®‹ã£ã¦ã‚‹ã®ã¯è‰¯ã„ã“ã¨ã§ã™ã‚ˆã­", "2026-02-07 15:30"),
    (128, None, "HbA1c 7.5%â€¦ã¾ãŸä¸ŠãŒã£ãŸã€‚ä½•ã§â€¦", "2026-02-10 16:00"),
    (129, 128, "ã‚¹ãƒˆãƒ¬ã‚¹ã¨ã‹ç¡çœ ä¸è¶³ã§ã‚‚ä¸ŠãŒã‚Šã¾ã™ã‚ˆ", "2026-02-10 16:30"),
    (130, 128, "åŽŸå› ç‰¹å®šã§ãã‚‹ã¨å¯¾ç­–ã—ã‚„ã™ã„ã§ã™ã‚ˆ", "2026-02-10 17:00"),
    (131, 130, "ç¢ºã‹ã«æœ€è¿‘ä»•äº‹å¿™ã—ãã¦å¯ä¸è¶³ã ã£ãŸ", "2026-02-10 17:30"),
    (132, None, "çœ¼ç§‘ã®æ¤œè¨ºã‚‚è¡Œã£ã¦ããŸã€‚ç•°å¸¸ãªã—", "2026-02-12 11:00"),
    (133, 132, "ç›®ã®æ¤œæŸ»å¤§äº‹ã§ã™ã‚ˆã­ã€‚ç§ã‚‚è¡Œã‹ãªãã‚ƒ", "2026-02-12 11:30"),
    (134, None, "ç¥žçµŒä¼å°Žæ¤œæŸ»ã‚‚ã—ãŸã€‚å•é¡Œãªã—", "2026-02-14 14:00"),
    (135, 134, "åˆä½µç—‡ã®æ¤œæŸ»ã‚‚å®šæœŸçš„ã«ã‚„ã‚‰ãªã„ã¨ã§ã™ã‚ˆã­", "2026-02-14 14:30"),
    (136, None, "ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ã®ãƒãƒ§ã‚³é£Ÿã¹ãŸå¾Œã«æ¸¬ã£ãŸã‚‰170", "2026-02-14 21:00"),
    (137, 136, "ãƒãƒ§ã‚³1å€‹ãã‚‰ã„ãªã‚‰â€¦ã£ã¦æ€ã£ãŸã‘ã©ãƒ€ãƒ¡ã ã£ãŸ", "2026-02-14 21:30"),
    (138, None, "ä»Šæœˆã®æ¤œæŸ»ã§6.5%åˆ‡ã‚ŠãŸã„", "2026-02-17 09:00"),
    (139, 138, "ã‚ã¨å°‘ã—ã§ã™ã­ï¼å¿œæ´ã—ã¦ã¾ã™", "2026-02-17 09:30"),
    (140, None, "æ¤œæŸ»è¡Œã£ã¦ããŸã€‚6.6%â€¦æƒœã—ã„ï¼", "2026-02-17 17:00"),
    (141, 140, "ã»ã¼é”æˆï¼æ¬¡ã“ãã§ã™ã­", "2026-02-17 17:30"),
    (142, None, "ãƒªãƒ–ãƒ¬ã®ãƒ‡ãƒ¼ã‚¿è¦‹ã›ãŸã‚‰å…ˆç”Ÿã«è¤’ã‚ã‚‰ã‚ŒãŸ", "2026-02-19 15:00"),
    (143, 142, "ãƒ‡ãƒ¼ã‚¿ã‚ã‚‹ã¨èª¬æ˜Žã—ã‚„ã™ã„ã§ã™ã‚ˆã­", "2026-02-19 15:30"),
    (144, None, "ç©ºè…¹æ™‚ãŒå®‰å®šã—ãªã„ã€‚100ã€œ130ã§ä¹±é«˜ä¸‹", "2026-02-21 08:00"),
    (145, 144, "æœã®é‹å‹•ã¨ã‹è©¦ã—ã¦ã¿ã¦ã¯ï¼Ÿ", "2026-02-21 08:30"),
    (146, None, "HbA1c 6.2%ï¼ç›®æ¨™é”æˆï¼", "2026-02-24 16:00"),
    (147, 146, "ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ðŸŽ‰ðŸŽ‰", "2026-02-24 16:30"),
    (148, 146, "ã©ã†ã‚„ã£ã¦é”æˆã—ã¾ã—ãŸã‹ï¼Ÿæ•™ãˆã¦ãã ã•ã„ï¼", "2026-02-24 17:00"),
    (149, 148, "é£Ÿäº‹ç®¡ç†ã¨æ¯Žæ—¥ã®é‹å‹•ã‚’åŠå¹´ç¶šã‘ã¾ã—ãŸ", "2026-02-24 17:30"),
    (150, 149, "ã‚„ã£ã±ã‚Šç¶™ç¶šãŒå¤§äº‹ãªã‚“ã§ã™ã­", "2026-02-24 18:00"),
    (151, None, "æ¥æœˆã®æ¤œæŸ»ã«å‘ã‘ã¦ãƒ©ã‚¹ãƒˆã‚¹ãƒ‘ãƒ¼ãƒˆ", "2026-02-28 20:00"),
]

def jst_to_utc(jst_str):
    """Convert JST datetime string to UTC ISO format"""
    dt = datetime.strptime(jst_str, "%Y-%m-%d %H:%M")
    dt_utc = dt - timedelta(hours=9)
    return dt_utc.strftime("%Y-%m-%dT%H:%M:%S+00:00")

def assign_user_ids(comments):
    """Assign user_ids to comments, keeping conversation consistency"""
    # Map: comment_number -> user_id
    user_map = {}
    user_idx = 0

    for num, reply_to, body, dt in comments:
        if reply_to and reply_to in user_map:
            # Reply: assign a different user than the parent
            parent_user = user_map[reply_to]
            # Pick next available user that's different from parent
            candidate = USERS[user_idx % len(USERS)]
            while candidate == parent_user:
                user_idx += 1
                candidate = USERS[user_idx % len(USERS)]
            user_map[num] = candidate
            user_idx += 1
        else:
            # New topic: assign next user
            user_map[num] = USERS[user_idx % len(USERS)]
            user_idx += 1

    return user_map

def insert_batch(records, batch_num):
    """Insert a batch of records via REST API"""
    url = f"{SUPABASE_URL}/rest/v1/comments"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }

    data = json.dumps(records).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="POST")

    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Batch {batch_num}: {resp.status} - {len(records)} records inserted")
            return True
    except urllib.error.HTTPError as e:
        print(f"  Batch {batch_num}: ERROR {e.code} - {e.read().decode()}")
        return False

def main():
    print(f"Processing {len(COMMENTS)} comments for thread No.10")
    print(f"Thread ID: {THREAD_ID}")

    # Generate UUIDs for each comment
    comment_uuids = {}
    for num, _, _, _ in COMMENTS:
        comment_uuids[num] = str(uuid.uuid4())

    # Assign user IDs
    user_map = assign_user_ids(COMMENTS)

    # Build records
    records = []
    now_utc = datetime.utcnow()
    past_count = 0
    future_count = 0

    for num, reply_to, body, dt_jst in COMMENTS:
        utc_str = jst_to_utc(dt_jst)
        dt_obj = datetime.strptime(dt_jst, "%Y-%m-%d %H:%M") - timedelta(hours=9)

        is_future = dt_obj > now_utc
        if is_future:
            future_count += 1
        else:
            past_count += 1

        parent_id = comment_uuids[reply_to] if reply_to else None

        record = {
            "id": comment_uuids[num],
            "thread_id": THREAD_ID,
            "body": body,
            "user_id": user_map[num],
            "is_hidden": False,
            "created_at": utc_str,
            "parent_id": parent_id,
        }

        records.append(record)

    print(f"Past comments: {past_count}")
    print(f"Future comments: {future_count}")
    print(f"Total: {len(records)}")
    print()

    # Insert in batches of 50
    BATCH_SIZE = 50
    for i in range(0, len(records), BATCH_SIZE):
        batch = records[i:i+BATCH_SIZE]
        batch_num = i // BATCH_SIZE + 1
        success = insert_batch(batch, batch_num)
        if not success:
            print("STOPPING due to error")
            return

    print(f"\nAll {len(records)} comments inserted!")

    # Update comments_count on thread
    print(f"\nUpdating comments_count to {past_count}...")
    url = f"{SUPABASE_URL}/rest/v1/threads?id=eq.{THREAD_ID}"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps({"comments_count": past_count}).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="PATCH")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Updated: {resp.status}")
    except urllib.error.HTTPError as e:
        print(f"  ERROR: {e.code} - {e.read().decode()}")

if __name__ == "__main__":
    main()
