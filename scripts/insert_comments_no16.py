#!/usr/bin/env python3
"""Insert 110 comments for thread No.16: é‹å‹•ã§è¡€ç³–å€¤ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã¦ã‚‹äºº"""

import uuid
import json
import urllib.request
from datetime import datetime, timedelta

SUPABASE_URL = "https://josanlblwfjdaaezqbnw.supabase.co"
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impvc2FubGJsd2ZqZGFhZXpxYm53Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2Nzg0MjYwNiwiZXhwIjoyMDgzNDE4NjA2fQ.JlTXBmY5HJAqfRD_AazsiBORpgLZfB74fPkNyyfVSQY"

THREAD_ID = "262dc88f-c42c-4cfa-bfaf-9edfdecaf441"
THREAD_OWNER_ID = "2033ee1c-28b2-5187-8ba1-c94f7964e33e"

USERS = [
    "b0000001-0000-0000-0000-000000000001",
    "b0000001-0000-0000-0000-000000000002",
    "b0000001-0000-0000-0000-000000000003",
    "b0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000005",
    "b0000001-0000-0000-0000-000000000006",
    "b0000001-0000-0000-0000-000000000007",
    "b0000001-0000-0000-0000-000000000008",
    "b0000001-0000-0000-0000-000000000009",
    "b0000001-0000-0000-0000-000000000010",
    "b0000001-0000-0000-0000-000000000011",
    "b0000001-0000-0000-0000-000000000012",
    "b0000001-0000-0000-0000-000000000013",
    "b0000001-0000-0000-0000-000000000014",
    "b0000001-0000-0000-0000-000000000015",
    "f0000001-0000-0000-0000-000000000001",
    "f0000001-0000-0000-0000-000000000002",
    "f0000001-0000-0000-0000-000000000005",
    "f0000001-0000-0000-0000-000000000006",
    "f0000001-0000-0000-0000-000000000009",
    "f0000001-0000-0000-0000-000000000010",
    "f0000001-0000-0000-0000-000000000008",
    "f0000001-0000-0000-0000-000000000003",
    "f0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000016",
    "b0000001-0000-0000-0000-000000000017",
    "b0000001-0000-0000-0000-000000000018",
    "b0000001-0000-0000-0000-000000000019",
    "b0000001-0000-0000-0000-000000000020",
    THREAD_OWNER_ID,
]

COMMENTS = [
    (2, None, "é£Ÿå¾Œ30åˆ†ã®ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ãŒæ—¥èª²ã«ãªã£ãŸã€‚è¡€ç³–å€¤å…¨ç„¶é•ã†", "2025-12-15 12:00"),
    (3, 2, "ç§ã‚‚é£Ÿå¾Œæ­©ã„ã¦ã¾ã™ï¼ã©ã®ãã‚‰ã„æ­©ãã¾ã™ã‹ï¼Ÿ", "2025-12-15 12:30"),
    (4, 2, "15ã€œ20åˆ†ãã‚‰ã„ã€‚ãã‚Œã§ã‚‚åŠ¹æžœæ„Ÿã˜ã‚‹", "2025-12-15 13:00"),
    (5, None, "ç­‹ãƒˆãƒ¬å§‹ã‚ãŸã‚‰ç©ºè…¹æ™‚è¡€ç³–ãŒä¸‹ãŒã£ã¦ããŸ", "2025-12-15 14:00"),
    (6, 5, "ç­‹è‚‰ã¤ãã¨ç³–ã®æ¶ˆè²»é‡ä¸ŠãŒã‚‹ã‚“ã§ã™ã‚ˆã­", "2025-12-15 14:30"),
    (7, None, "2åž‹ã§é£Ÿäº‹ç™‚æ³•ã¨é‹å‹•ç™‚æ³•ã®ã¿ã€‚é€±5ã§ã‚¸ãƒ é€šã£ã¦ã‚‹", "2025-12-15 18:00"),
    (8, 7, "è–¬ãªã—ã§ç®¡ç†ã§ãã¦ã‚‹ã®ã™ã”ã„ï¼", "2025-12-15 18:30"),
    (9, None, "æœã®ãƒ©ã‚¸ã‚ªä½“æ“ã‹ã‚‰å§‹ã‚ã¦ã¿ãŸ", "2025-12-15 19:00"),
    (10, 9, "ãƒ©ã‚¸ã‚ªä½“æ“ã„ã„ã§ã™ã‚ˆã­ã€‚ç¶šã‘ã‚„ã™ã„", "2025-12-15 19:30"),
    (11, None, "æœ‰é…¸ç´ ã¨ç­‹ãƒˆãƒ¬ã©ã£ã¡ãŒã„ã„ã‚“ã ã‚ã†", "2025-12-15 20:00"),
    (12, 11, "ä¸¡æ–¹ã‚„ã‚‹ã®ãŒãƒ™ã‚¹ãƒˆã£ã¦å…ˆç”Ÿã«è¨€ã‚ã‚Œã¾ã—ãŸ", "2025-12-15 20:30"),
    (13, None, "ãƒªãƒ–ãƒ¬ã§é‹å‹•ã®åŠ¹æžœãŒè¦‹ãˆã‚‹ã®ãŒå¬‰ã—ã„", "2025-12-16 08:00"),
    (14, 13, "æ­©ãã¨çŸ¢å°ãŒä¸‹å‘ãã«ãªã‚‹ã®è¦‹ã‚‹ã¨é”æˆæ„Ÿã‚ã‚‹", "2025-12-16 08:30"),
    (15, None, "ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆæ¯Žæ—¥30å›žã‚„ã£ã¦ã‚‹", "2025-12-16 12:00"),
    (16, 15, "ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆã¯å¤§ãã„ç­‹è‚‰ä½¿ã†ã‹ã‚‰åŠ¹æžœçš„ã§ã™ã‚ˆã­", "2025-12-16 12:30"),
    (17, None, "1åž‹ã ã‘ã©é‹å‹•ã§ã‚¤ãƒ³ã‚¹ãƒªãƒ³é‡æ¸›ã‚‰ã›ãŸ", "2025-12-16 14:00"),
    (18, 17, "1åž‹ã§ã‚‚é‹å‹•åŠ¹æžœã‚ã‚‹ã‚“ã§ã™ã­ï¼", "2025-12-16 14:30"),
    (19, 17, "ä½Žè¡€ç³–ã«æ³¨æ„ã—ãªãŒã‚‰ã‚„ã£ã¦ã¾ã™", "2025-12-16 15:00"),
    (20, None, "æ°´æ³³å§‹ã‚ãŸã€‚è†ã«å„ªã—ã„ã—å…¨èº«é‹å‹•", "2025-12-16 19:00"),
    (21, 20, "æ°´æ³³ã„ã„ã§ã™ã­ï¼ç§ã‚‚ã‚„ã‚ŠãŸã„ã‘ã©è¿‘ãã«ãƒ—ãƒ¼ãƒ«ãŒãªã„", "2025-12-16 19:30"),
    (22, None, "60ä»£ã ã‹ã‚‰ç„¡ç†ã›ãšã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ã‚¤ãƒ³ã«ã—ã¦ã‚‹", "2025-12-16 20:00"),
    (23, 22, "ç¶™ç¶šãŒå¤§äº‹ã§ã™ã‚‚ã‚“ã­", "2025-12-16 20:30"),
    (24, None, "éšŽæ®µä½¿ã†ã‚ˆã†ã«ã—ãŸã‚‰æ„å¤–ã¨åŠ¹æžœã‚ã£ãŸ", "2025-12-17 09:00"),
    (25, 24, "æ—¥å¸¸ã®ä¸­ã§é‹å‹•é‡å¢—ã‚„ã™ã®å¤§äº‹ã§ã™ã‚ˆã­", "2025-12-17 09:30"),
    (26, None, "ãƒ¨ã‚¬å§‹ã‚ãŸã‚‰ã‚¹ãƒˆãƒ¬ã‚¹æ¸›ã£ã¦è¡€ç³–å€¤ã‚‚å®‰å®š", "2025-12-17 12:00"),
    (27, 26, "ã‚¹ãƒˆãƒ¬ã‚¹ã‚‚è¡€ç³–å€¤ã«å½±éŸ¿ã—ã¾ã™ã‚‚ã‚“ã­", "2025-12-17 12:30"),
    (28, None, "é›¨ã®æ—¥ã¯YouTubeã®ç­‹ãƒˆãƒ¬å‹•ç”»ã‚„ã£ã¦ã‚‹", "2025-12-17 19:00"),
    (29, 28, "ç§ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ã¾ã™ç¬‘ å®¶ã§ã§ãã‚‹ã®åŠ©ã‹ã‚‹", "2025-12-17 19:30"),
    (30, None, "æ¯Žæ—¥1ä¸‡æ­©ç›®æ¨™ã«ã—ã¦ã‚‹", "2025-12-17 20:00"),
    (31, 30, "1ä¸‡æ­©ã™ã”ã„ï¼ç§ã¯8000æ­©ãŒé™ç•Œ", "2025-12-17 20:30"),
    (32, None, "é‹å‹•ã™ã‚‹ã¨é£Ÿæ¬²ã‚‚æŠ‘ãˆã‚‰ã‚Œã‚‹æ°—ãŒã™ã‚‹", "2025-12-18 08:00"),
    (33, None, "å¢ƒç•Œåž‹ã ã‘ã©é‹å‹•ã§æ‚ªåŒ–ã‚’é˜²ã„ã§ã‚‹", "2025-12-18 10:00"),
    (34, 33, "äºˆé˜²å¤§äº‹ã§ã™ã‚ˆã­ã€‚ç§ã‚‚å¢ƒç•Œåž‹ã§ã™", "2025-12-18 10:30"),
    (35, None, "è‡ªè»¢è»Šé€šå‹¤ã«å¤‰ãˆãŸã‚‰æ•°å€¤æ”¹å–„ã—ãŸ", "2025-12-18 12:00"),
    (36, 35, "é€šå‹¤ãŒé‹å‹•ã«ãªã‚‹ã®æœ€é«˜ã§ã™ã­", "2025-12-18 12:30"),
    (37, None, "é‹å‹•å¾Œã¯è¡€ç³–å€¤ä¸‹ãŒã‚Šã™ãŽã‚‹ã“ã¨ã‚‚ã‚ã‚‹", "2025-12-18 19:00"),
    (38, 37, "ä½Žè¡€ç³–å¯¾ç­–ã§ãƒ–ãƒ‰ã‚¦ç³–æŒã¡æ­©ã„ã¦ã¾ã™", "2025-12-18 19:30"),
    (39, None, "ã‚¨ã‚¢ãƒ­ãƒã‚¤ã‚¯è²·ã£ãŸã€‚å¤©å€™é–¢ä¿‚ãªãã§ãã‚‹", "2025-12-19 10:00"),
    (40, 39, "ã‚¨ã‚¢ãƒ­ãƒã‚¤ã‚¯ã„ã„ã§ã™ã­ï¼ãƒ†ãƒ¬ãƒ“è¦‹ãªãŒã‚‰ã§ãã‚‹", "2025-12-19 10:30"),
    (41, None, "æœèµ·ãã¦ã™ãã‚¹ãƒˆãƒ¬ãƒƒãƒã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚‹", "2025-12-19 12:00"),
    (42, None, "é€±æœ«ã ã‘ã‚¸ãƒ è¡Œã£ã¦ã‚‹ã€‚å¹³æ—¥ã¯å¿™ã—ãã¦", "2025-12-19 19:00"),
    (43, 42, "é€±æœ«ã ã‘ã§ã‚‚å…¨ç„¶é•ã„ã¾ã™ã‚ˆã­", "2025-12-19 19:30"),
    (44, None, "çŠ¬ã®æ•£æ­©ãŒé‹å‹•ã«ãªã£ã¦ã‚‹", "2025-12-20 08:00"),
    (45, 44, "çŠ¬é£¼ã„ãŸããªã£ã¦ããŸç¬‘", "2025-12-20 08:30"),
    (46, None, "å¯’ããªã£ã¦ãã¦å¤–ã«å‡ºã‚‹ã®ãŒã¤ã‚‰ã„", "2025-12-20 19:00"),
    (47, 46, "ã‚ã‹ã‚‹â€¦ã€‚å®¤å†…ã§ã§ãã‚‹ã“ã¨æŽ¢ã—ã¦ã¾ã™", "2025-12-20 19:30"),
    (48, None, "è¸ã¿å°æ˜‡é™å§‹ã‚ãŸã€‚å ´æ‰€å–ã‚‰ãªãã¦ã„ã„", "2025-12-21 10:00"),
    (49, 48, "è¸ã¿å°æ˜‡é™åŠ¹æžœã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "2025-12-21 10:30"),
    (50, 48, "20åˆ†ã‚„ã‚‹ã¨ã‘ã£ã“ã†æ±—ã‹ãã¾ã™", "2025-12-21 11:00"),
    (51, None, "å¹´æœ«å¹´å§‹ã‚‚é‹å‹•ã‚µãƒœã‚‰ãªã„ã‚ˆã†ã«ã—ãŸã„", "2025-12-22 19:00"),
    (52, 51, "ç§ã‚‚ï¼é£Ÿã¹ã‚‹åˆ†å‹•ã‹ãªã„ã¨", "2025-12-22 19:30"),
    (53, None, "ã‚¯ãƒªã‚¹ãƒžã‚¹é£Ÿã¹ã™ãŽãŸã‹ã‚‰æ­©ã„ã¦ããŸ", "2025-12-25 20:00"),
    (54, 53, "ãˆã‚‰ã„ï¼ç§ã¯æ˜Žæ—¥ã‹ã‚‰â€¦ç¬‘", "2025-12-25 20:30"),
    (55, None, "å¤§æŽƒé™¤ã‚‚é‹å‹•ã«ãªã‚‹ã€‚çª“æ‹­ãç–²ã‚ŒãŸ", "2025-12-28 15:00"),
    (56, 55, "ç¢ºã‹ã«ï¼å®¶äº‹ã‚‚é‹å‹•ã§ã™ã‚ˆã­", "2025-12-28 15:30"),
    (57, None, "åˆè©£ã§çµæ§‹æ­©ã„ãŸã€‚æ··ã‚“ã§ã¦", "2026-01-01 18:00"),
    (58, 57, "æ­£æœˆã®ç¥žç¤¾ã¯æ­©ãã¾ã™ã‚ˆã­", "2026-01-01 18:30"),
    (59, None, "æ­£æœˆå¤ªã‚Šè§£æ¶ˆã®ãŸã‚ã«é‹å‹•é‡å¢—ã‚„ã™", "2026-01-04 09:00"),
    (60, 59, "ç§ã‚‚ä»Šæ—¥ã‹ã‚‰å†é–‹ã—ã¾ã™ï¼", "2026-01-04 09:30"),
    (61, None, "å¯’ã„ã‘ã©é ‘å¼µã£ã¦å¤–æ­©ã„ã¦ã‚‹", "2026-01-06 08:00"),
    (62, 61, "å¯’ã„ä¸­ãˆã‚‰ã„ã§ã™ï¼", "2026-01-06 08:30"),
    (63, None, "ã‚¸ãƒ ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ å‚åŠ ã—å§‹ã‚ãŸã€‚ä»²é–“ãŒã„ã‚‹ã¨ãƒ¢ãƒãƒ™ä¸ŠãŒã‚‹", "2026-01-08 19:00"),
    (64, 63, "ã¿ã‚“ãªã§ã‚„ã‚‹ã¨ç¶šãã¾ã™ã‚ˆã­", "2026-01-08 19:30"),
    (65, None, "é‹å‹•3ãƒ¶æœˆç¶šã‘ãŸã‚‰HbA1c 0.5%ä¸‹ãŒã£ãŸ", "2026-01-10 15:00"),
    (66, 65, "ã™ã”ã„ï¼ãƒ¢ãƒãƒ™ã«ãªã‚Šã¾ã™", "2026-01-10 15:30"),
    (67, 65, "ã©ã‚“ãªé‹å‹•ã—ã¦ã¾ã™ã‹ï¼Ÿ", "2026-01-10 16:00"),
    (68, 65, "ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°30åˆ†ã¨è»½ã„ç­‹ãƒˆãƒ¬ã§ã™", "2026-01-10 16:30"),
    (69, None, "è†ãŒç—›ãã¦æ­©ã‘ãªã„â€¦ã©ã†ã—ã‚ˆã†", "2026-01-12 10:00"),
    (70, 69, "æ°´ä¸­ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ãŠã™ã™ã‚ã§ã™ã€‚è†ã«å„ªã—ã„", "2026-01-12 10:30"),
    (71, 69, "æ¤…å­ã«åº§ã£ã¦ã§ãã‚‹é‹å‹•ã‚‚ã‚ã‚Šã¾ã™ã‚ˆ", "2026-01-12 11:00"),
    (72, None, "ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ãƒžã‚·ãƒ³è²·ãŠã†ã‹è¿·ã£ã¦ã‚‹", "2026-01-15 19:00"),
    (73, 72, "ç§ã¯è²·ã£ã¦ã‚ˆã‹ã£ãŸã§ã™ã€‚é›¨ã®æ—¥ã‚‚æ­©ã‘ã‚‹", "2026-01-15 19:30"),
    (74, None, "50ä»£ã ã‘ã©ç­‹ãƒˆãƒ¬å§‹ã‚ãŸã€‚é…ããªã„ã‚ˆã­ï¼Ÿ", "2026-01-17 12:00"),
    (75, 74, "å…¨ç„¶é…ããªã„ï¼ã„ãã¤ã‹ã‚‰ã§ã‚‚ç­‹è‚‰ã¤ãã¾ã™ã‚ˆ", "2026-01-17 12:30"),
    (76, None, "é£Ÿå¾Œã™ãã®é‹å‹•ãŒã„ã„ã®ã‹ã€å°‘ã—ä¼‘ã‚“ã§ã‹ã‚‰ãŒã„ã„ã®ã‹", "2026-01-19 14:00"),
    (77, 76, "15ã€œ30åˆ†å¾Œãã‚‰ã„ãŒã„ã„ã£ã¦èžãã¾ã—ãŸ", "2026-01-19 14:30"),
    (78, None, "é‹å‹•è¨˜éŒ²ã‚¢ãƒ—ãƒªä½¿ã£ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2026-01-22 10:00"),
    (79, 78, "ç§ã¯æ­©æ•°è¨ˆã‚¢ãƒ—ãƒªä½¿ã£ã¦ã¾ã™", "2026-01-22 10:30"),
    (80, 78, "Apple Watché€£æºã—ã¦è¨˜éŒ²ã—ã¦ã¾ã™", "2026-01-22 11:00"),
    (81, None, "ãƒ€ãƒ³ãƒ™ãƒ«è²·ã£ãŸã€‚å®¶ã§ç­‹ãƒˆãƒ¬", "2026-01-24 19:00"),
    (82, 81, "ä½•ã‚­ãƒ­ã§ã™ã‹ï¼Ÿ", "2026-01-24 19:30"),
    (83, 81, "3ã‚­ãƒ­ã‹ã‚‰å§‹ã‚ã¦ã¾ã™", "2026-01-24 20:00"),
    (84, None, "æœã®é‹å‹•ã¨å¤œã®é‹å‹•ã€ã©ã£ã¡ãŒåŠ¹æžœã‚ã‚‹ï¼Ÿ", "2026-01-27 08:00"),
    (85, 84, "ç¶šã‘ã‚‰ã‚Œã‚‹æ™‚é–“å¸¯ãŒãƒ™ã‚¹ãƒˆã ã¨æ€ã„ã¾ã™", "2026-01-27 08:30"),
    # Future comments
    (86, None, "é‹å‹•å«Œã„ã ã£ãŸã‘ã©ã€è¡€ç³–å€¤ä¸‹ãŒã‚‹ã®è¦‹ã‚‹ã¨ç¶šã‘ã‚‰ã‚Œã‚‹", "2026-01-29 19:00"),
    (87, 86, "çµæžœãŒè¦‹ãˆã‚‹ã¨ãƒ¢ãƒãƒ™ä¸ŠãŒã‚Šã¾ã™ã‚ˆã­", "2026-01-29 19:30"),
    (88, None, "2æœˆã«ãªã£ãŸã€‚å¯’ã„ã‘ã©é ‘å¼µã‚‹", "2026-02-01 09:00"),
    (89, 88, "ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼", "2026-02-01 09:30"),
    (90, None, "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°è©¦ã—ã¦ã‚‹ã€‚æ—©æ­©ãã¨æ™®é€šæ­©ãã‚’äº¤äº’ã«", "2026-02-03 12:00"),
    (91, 90, "åŠ¹æžœã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "2026-02-03 12:30"),
    (92, 90, "æ™®é€šã«æ­©ãã‚ˆã‚Šç–²ã‚Œã‚‹ã‘ã©åŠ¹ã„ã¦ã‚‹æ°—ãŒã™ã‚‹", "2026-02-03 13:00"),
    (93, None, "é€±3æ—¥ã¯é‹å‹•ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚‹", "2026-02-05 19:00"),
    (94, 93, "é€±3æ—¥ã§ã‚‚ååˆ†åŠ¹æžœã‚ã‚Šã¾ã™ã‚ˆã­", "2026-02-05 19:30"),
    (95, None, "ã‚¹ãƒˆãƒ¬ãƒƒãƒãƒãƒ¼ãƒ«è²·ã£ãŸã‚‰ã‚ã£ã¡ã‚ƒæ°—æŒã¡ã„ã„", "2026-02-07 20:00"),
    (96, 95, "ã‚¹ãƒˆãƒ¬ãƒƒãƒãƒãƒ¼ãƒ«ã„ã„ã§ã™ã‚ˆã­ï¼", "2026-02-07 20:30"),
    (97, None, "é‹å‹•ç¿’æ…£ã¤ã„ã¦ã‹ã‚‰ç¡çœ ã®è³ªã‚‚ä¸ŠãŒã£ãŸ", "2026-02-10 08:00"),
    (98, 97, "é‹å‹•ã£ã¦ç¡çœ ã«ã‚‚åŠ¹ãã‚“ã§ã™ã­", "2026-02-10 08:30"),
    (99, None, "ä»Šæ—¥ã¯é›ªã§å¤–å‡ºã‚‰ã‚Œãªã„â€¦å®¶ã§ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆã™ã‚‹", "2026-02-14 10:00"),
    (100, 99, "å®¤å†…é‹å‹•ã‚‚å¤§äº‹ã§ã™ã‚ˆã­", "2026-02-14 10:30"),
    (101, None, "é‹å‹•å§‹ã‚ã¦1å¹´çµŒã£ãŸã€‚ç¿’æ…£ã«ãªã£ãŸ", "2026-02-17 19:00"),
    (102, 101, "1å¹´ç¶šã‘ã‚‰ã‚ŒãŸã®ã™ã”ã„ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™", "2026-02-17 19:30"),
    (103, None, "æœ€è¿‘ã¯ãƒ—ãƒ©ãƒ³ã‚¯ã«ãƒãƒžã£ã¦ã‚‹", "2026-02-20 12:00"),
    (104, 103, "ãƒ—ãƒ©ãƒ³ã‚¯ãã¤ã„ã§ã™ã‚ˆã­ã€‚ä½•ç§’ã‚­ãƒ¼ãƒ—ã§ãã¾ã™ï¼Ÿ", "2026-02-20 12:30"),
    (105, 103, "æœ€åˆã¯30ç§’ãŒã‚„ã£ã¨ã ã£ãŸã‘ã©ä»Šã¯1åˆ†ã§ãã‚‹", "2026-02-20 13:00"),
    (106, None, "æ˜¥ã«ãªã£ãŸã‚‰ã‚‚ã£ã¨å¤–ã§æ­©ããŸã„", "2026-02-24 08:00"),
    (107, 106, "æ—©ãæš–ã‹ããªã£ã¦ã»ã—ã„ã§ã™ã‚ˆã­", "2026-02-24 08:30"),
    (108, None, "é‹å‹•ä»²é–“ãŒã„ã‚‹ã¨ã‚µãƒœã‚Œãªãã¦ã„ã„", "2026-02-27 19:00"),
    (109, 108, "ã“ã®ã‚¹ãƒ¬ãŒé‹å‹•ä»²é–“ã¿ãŸã„ãªã‚‚ã‚“ã§ã™ã­", "2026-02-27 19:30"),
    (110, None, "3æœˆã‚‚å¼•ãç¶šãé‹å‹•é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼", "2026-02-28 20:00"),
    (111, 110, "ã¯ã„ï¼ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ðŸ’ª", "2026-02-28 20:30"),
]

def jst_to_utc(jst_str):
    dt = datetime.strptime(jst_str, "%Y-%m-%d %H:%M")
    dt_utc = dt - timedelta(hours=9)
    return dt_utc.strftime("%Y-%m-%dT%H:%M:%S+00:00")

def assign_user_ids(comments):
    user_map = {}
    user_idx = 0
    for num, reply_to, body, dt in comments:
        if reply_to and reply_to in user_map:
            parent_user = user_map[reply_to]
            candidate = USERS[user_idx % len(USERS)]
            while candidate == parent_user:
                user_idx += 1
                candidate = USERS[user_idx % len(USERS)]
            user_map[num] = candidate
            user_idx += 1
        else:
            user_map[num] = USERS[user_idx % len(USERS)]
            user_idx += 1
    return user_map

def insert_batch(records, batch_num):
    url = f"{SUPABASE_URL}/rest/v1/comments"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps(records).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="POST")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Batch {batch_num}: {resp.status} - {len(records)} records inserted")
            return True
    except urllib.error.HTTPError as e:
        print(f"  Batch {batch_num}: ERROR {e.code} - {e.read().decode()}")
        return False

def main():
    print(f"Processing {len(COMMENTS)} comments for thread No.16")
    print(f"Thread ID: {THREAD_ID}")

    comment_uuids = {}
    for num, _, _, _ in COMMENTS:
        comment_uuids[num] = str(uuid.uuid4())

    user_map = assign_user_ids(COMMENTS)

    records = []
    now_utc = datetime.utcnow()
    past_count = 0
    future_count = 0

    for num, reply_to, body, dt_jst in COMMENTS:
        utc_str = jst_to_utc(dt_jst)
        dt_obj = datetime.strptime(dt_jst, "%Y-%m-%d %H:%M") - timedelta(hours=9)
        if dt_obj > now_utc:
            future_count += 1
        else:
            past_count += 1

        parent_id = comment_uuids[reply_to] if reply_to else None
        record = {
            "id": comment_uuids[num],
            "thread_id": THREAD_ID,
            "body": body,
            "user_id": user_map[num],
            "is_hidden": False,
            "created_at": utc_str,
            "parent_id": parent_id,
        }
        records.append(record)

    print(f"Past comments: {past_count}")
    print(f"Future comments: {future_count}")
    print(f"Total: {len(records)}")
    print()

    BATCH_SIZE = 50
    for i in range(0, len(records), BATCH_SIZE):
        batch = records[i:i+BATCH_SIZE]
        batch_num = i // BATCH_SIZE + 1
        if not insert_batch(batch, batch_num):
            print("STOPPING due to error")
            return

    print(f"\nAll {len(records)} comments inserted!")

    print(f"\nUpdating comments_count to {past_count}...")
    url = f"{SUPABASE_URL}/rest/v1/threads?id=eq.{THREAD_ID}"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps({"comments_count": past_count}).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="PATCH")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Updated: {resp.status}")
    except urllib.error.HTTPError as e:
        print(f"  ERROR: {e.code} - {e.read().decode()}")

if __name__ == "__main__":
    main()
