#!/usr/bin/env python3
"""Insert 140 comments for thread No.12: é£Ÿå¾Œè¡€ç³–å€¤ã€ã¿ã‚“ãªã©ã®ãã‚‰ã„ï¼Ÿ"""

import uuid
import json
import urllib.request
from datetime import datetime, timedelta

SUPABASE_URL = "https://josanlblwfjdaaezqbnw.supabase.co"
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impvc2FubGJsd2ZqZGFhZXpxYm53Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2Nzg0MjYwNiwiZXhwIjoyMDgzNDE4NjA2fQ.JlTXBmY5HJAqfRD_AazsiBORpgLZfB74fPkNyyfVSQY"

THREAD_ID = "71e67423-01b5-4634-8b81-3dfae9afb479"
THREAD_OWNER_ID = "2033ee1c-28b2-5187-8ba1-c94f7964e33e"

# Dummy user pool (select diverse users)
USERS = [
    "b0000001-0000-0000-0000-000000000001",  # ã‚ˆã£ã—ãƒ¼
    "b0000001-0000-0000-0000-000000000002",  # ã¾ã‚†ã¿
    "b0000001-0000-0000-0000-000000000003",  # ãŸã‘ã—
    "b0000001-0000-0000-0000-000000000004",  # ã•ã¡ã“
    "b0000001-0000-0000-0000-000000000005",  # ã“ã†ãŸ
    "b0000001-0000-0000-0000-000000000006",  # ã‚†ã‹ã‚Š
    "b0000001-0000-0000-0000-000000000007",  # ã¾ã•ã²ã‚
    "b0000001-0000-0000-0000-000000000008",  # ã¨ã‚‚ã“
    "b0000001-0000-0000-0000-000000000009",  # ã—ã‚“ã˜
    "b0000001-0000-0000-0000-000000000010",  # ã²ã‚ã¿
    "b0000001-0000-0000-0000-000000000011",  # ã ã„ã™ã‘
    "b0000001-0000-0000-0000-000000000012",  # ã‚ã‘ã¿
    "b0000001-0000-0000-0000-000000000013",  # ã‘ã‚“ãŸ
    "b0000001-0000-0000-0000-000000000014",  # ã¿ã¡ã“
    "b0000001-0000-0000-0000-000000000015",  # ã‚Šã‚‡ã†ãŸ
    "f0000001-0000-0000-0000-000000000001",  # ã¿ãƒ¼ãƒžãƒž
    "f0000001-0000-0000-0000-000000000002",  # ã‚±ãƒ³ãƒ‘ãƒ‘
    "f0000001-0000-0000-0000-000000000005",  # ã‚†ã†ã“
    "f0000001-0000-0000-0000-000000000006",  # ã‘ã‚“ã˜
    "f0000001-0000-0000-0000-000000000009",  # ã²ãªã®
    "f0000001-0000-0000-0000-000000000010",  # ã¨ã—ã
    "f0000001-0000-0000-0000-000000000008",  # ã¾ã•ãŠ
    "f0000001-0000-0000-0000-000000000003",  # ã•ãã‚‰
    "f0000001-0000-0000-0000-000000000004",  # ãŸã£ãã‚“çˆ¶
    "b0000001-0000-0000-0000-000000000016",  # ãªãŠã“
    "b0000001-0000-0000-0000-000000000017",  # ã¦ã¤ã‚„
    "b0000001-0000-0000-0000-000000000018",  # ã‹ãšãˆ
    "b0000001-0000-0000-0000-000000000019",  # ã‚†ã†ã‚„
    "b0000001-0000-0000-0000-000000000020",  # ã‚Œã„ã“
    THREAD_OWNER_ID,  # Ash (thread owner)
]

# CSV data: (number, reply_to, body, datetime_jst)
COMMENTS = [
    (2, None, "é£Ÿå¾Œ2æ™‚é–“ã§å¤§ä½“140ã€œ160ãã‚‰ã„ã€‚ãƒªãƒ–ãƒ¬ã§è¦‹ã¦ã‚‹ã¨é£Ÿã¹ãŸã‚‚ã®ã§å…¨ç„¶é•ã†", "2025-12-15 12:00"),
    (3, 2, "ãƒªãƒ–ãƒ¬ã„ã„ã§ã™ã‚ˆã­ã€‚ç§ã‚‚ä½¿ã£ã¦ã¦ã€é£Ÿå¾Œã®ä¸ŠãŒã‚Šæ–¹ãŒãƒªã‚¢ãƒ«ã«ã‚ã‹ã‚‹", "2025-12-15 12:30"),
    (4, None, "2åž‹ã§é£²ã¿è–¬ã ã‘ã©ã€é£Ÿå¾Œ180è¶…ãˆã‚‹ã“ã¨ãŒå¤šã„â€¦", "2025-12-15 13:00"),
    (5, 4, "180ã¯é«˜ã‚ã§ã™ã­ã€‚ä½•é£Ÿã¹ã¦ã¾ã™ï¼Ÿ", "2025-12-15 13:30"),
    (6, 5, "æ™®é€šã«ã”é£¯é£Ÿã¹ã¦ã¾ã™ã€‚ã‚„ã£ã±ã‚Šç³–è³ªæ¸›ã‚‰ã™ã¹ãã‹ãª", "2025-12-15 14:00"),
    (7, None, "1åž‹ã§ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒªãƒ³æ‰“ã£ã¦ã‚‚é£Ÿå¾Œã¯ä¸ŠãŒã‚‹ã€‚ã‚¿ã‚¤ãƒŸãƒ³ã‚°é›£ã—ã„", "2025-12-15 15:00"),
    (8, 7, "1åž‹ã¯ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒå‘½ã§ã™ã‚ˆã­ã€‚ç§ã‚‚è‹¦åŠ´ã—ã¦ã¾ã™", "2025-12-15 15:30"),
    (9, None, "å¢ƒç•Œåž‹ã§é£Ÿäº‹ç™‚æ³•ã®ã¿ã€‚é£Ÿå¾Œ130ãã‚‰ã„ã§åŽã¾ã£ã¦ã‚‹", "2025-12-15 18:00"),
    (10, 9, "å¢ƒç•Œåž‹ã§130ãªã‚‰å„ªç§€ã˜ã‚ƒãªã„ã§ã™ã‹ï¼", "2025-12-15 18:30"),
    (11, None, "æœ€è¿‘è¨ºæ–­ã•ã‚ŒãŸã°ã‹ã‚Šã§ã€é£Ÿå¾Œè¡€ç³–ãŒã©ã®ãã‚‰ã„ãŒæ™®é€šã‹ã‚ã‹ã‚‰ãªã„", "2025-12-15 19:00"),
    (12, 11, "ç›®å®‰ã¯é£Ÿå¾Œ2æ™‚é–“ã§140ä»¥ä¸‹ãŒã„ã„ã£ã¦è¨€ã‚ã‚Œã¦ã¾ã™", "2025-12-15 19:30"),
    (13, 11, "ç§ã‚‚1å¹´æœªæº€ã§ã™ã€‚æœ€åˆã¯ã‚ã‹ã‚‰ãªã„ã“ã¨å¤šã„ã§ã™ã‚ˆã­", "2025-12-15 20:00"),
    (14, None, "GLP-1å§‹ã‚ã¦ã‹ã‚‰é£Ÿå¾ŒãŒå®‰å®šã—ã¦ããŸã€‚150è¶…ãˆãªããªã£ãŸ", "2025-12-15 20:30"),
    (15, 14, "GLP-1åŠ¹ãã‚“ã§ã™ã­ï¼ç§ã‚‚æ°—ã«ãªã£ã¦ã‚‹", "2025-12-15 21:00"),
    (16, None, "ãƒãƒ³ãƒ—ä½¿ã£ã¦ã¾ã™ã€‚é£Ÿå‰ã«ãƒœãƒ¼ãƒ©ã‚¹æ‰“ã¦ã°å¤§ä½“160ä»¥ä¸‹ã§åŽã¾ã‚‹", "2025-12-16 08:00"),
    (17, 16, "ãƒãƒ³ãƒ—ç¾¨ã¾ã—ã„ã€‚æ³¨å°„ã ã¨ãªã‹ãªã‹ã†ã¾ãã„ã‹ãªã„", "2025-12-16 08:30"),
    (18, None, "Dexcomã§è¦‹ã¦ã‚‹ã¨ã€ãƒ‘ãƒ³ã¯ã”é£¯ã‚ˆã‚Šæ€¥ä¸Šæ˜‡ã™ã‚‹æ°—ãŒã™ã‚‹", "2025-12-16 09:00"),
    (19, 18, "ã‚ã‹ã‚Šã¾ã™ï¼ãƒ‘ãƒ³ã¯è¡€ç³–å€¤ã®ä¸ŠãŒã‚Šæ–¹ã‚¨ã‚°ã„", "2025-12-16 09:30"),
    (20, None, "é£Ÿå¾Œã™ãæ­©ãã¨è¡€ç³–å€¤ã®ä¸ŠãŒã‚ŠãŒç·©ã‚„ã‹ã«ãªã‚‹", "2025-12-16 12:00"),
    (21, 20, "é£Ÿå¾Œ15åˆ†ã®ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°åŠ¹æžœã‚ã‚Šã¾ã™ã‚ˆã­", "2025-12-16 12:30"),
    (22, None, "ä»Šæ—¥ã®æ˜¼é£Ÿå¾Œ145ã€‚ã¾ã‚ã¾ã‚ã‹ãª", "2025-12-16 14:00"),
    (23, 22, "145ãªã‚‰è‰¯ã„ã¨æ€ã„ã¾ã™ï¼", "2025-12-16 14:30"),
    (24, None, "10å¹´ä»¥ä¸Š2åž‹ã ã‘ã©ã€æœ€è¿‘ã‚„ã£ã¨é£Ÿå¾Œ160ä»¥ä¸‹ã§å®‰å®š", "2025-12-16 19:00"),
    (25, 24, "10å¹´ã®ãƒ™ãƒ†ãƒ©ãƒ³ã•ã‚“ï¼ã‚³ãƒ„æ•™ãˆã¦ãã ã•ã„", "2025-12-16 19:30"),
    (26, 25, "é‡Žèœã‹ã‚‰é£Ÿã¹ã‚‹ã€ã‚ˆãå™›ã‚€ã€é£Ÿå¾Œã«å‹•ãã€‚ã“ã‚Œã ã‘", "2025-12-16 20:00"),
    (27, None, "è¡€ç³–æ¸¬å®šå™¨ã®ã¿ã ã‹ã‚‰ã€é£Ÿå¾Œæ¯Žå›žæ¸¬ã‚‹ã®é¢å€’â€¦", "2025-12-16 20:30"),
    (28, 27, "ãƒªãƒ–ãƒ¬ã«ã™ã‚‹ã¨æ¥½ã§ã™ã‚ˆã€‚ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã ã‘", "2025-12-16 21:00"),
    (29, 28, "ãƒªãƒ–ãƒ¬æ°—ã«ãªã‚‹ã‘ã©è²»ç”¨ãŒâ€¦", "2025-12-16 21:30"),
    (30, None, "ãƒ©ãƒ¼ãƒ¡ãƒ³é£Ÿã¹ãŸã‚‰220è¶…ãˆãŸðŸ˜­", "2025-12-17 12:00"),
    (31, 30, "ãƒ©ãƒ¼ãƒ¡ãƒ³ã¯ä»•æ–¹ãªã„ï¼ãŸã¾ã«ã¯ã„ã„ã‚ˆ", "2025-12-17 12:30"),
    (32, None, "ã‚¤ãƒ³ã‚¹ãƒªãƒ³ã¨é£²ã¿è–¬ä½µç”¨ã€‚é£Ÿå¾Œã¯150å‰å¾Œã§è½ã¡ç€ã„ã¦ã‚‹", "2025-12-17 14:00"),
    (33, 32, "ä½µç”¨ã§å®‰å®šã—ã¦ã‚‹ã®ç¾¨ã¾ã—ã„", "2025-12-17 14:30"),
    (34, None, "å¦Šå¨ ç³–å°¿ç—…ã§é£Ÿå¾Œ1æ™‚é–“140ä»¥ä¸‹ã‚’ç›®æŒ‡ã—ã¦ã‚‹ã€‚åŽ³ã—ã„â€¦", "2025-12-17 19:00"),
    (35, 34, "å¦Šå¨ ä¸­ã¯åŸºæº–åŽ³ã—ã„ã§ã™ã‚ˆã­ã€‚é ‘å¼µã£ã¦ï¼", "2025-12-17 19:30"),
    (36, None, "ã†ã©ã‚“ã¯è¡€ç³–å€¤çˆ†ä¸ŠãŒã‚Šã™ã‚‹ã€‚200è¶…ãˆã‚‹", "2025-12-17 20:00"),
    (37, 36, "ã†ã©ã‚“ã¯ç³–è³ªã®å¡Šã ã‚‚ã‚“ã­â€¦", "2025-12-17 20:30"),
    (38, None, "60ä»£ã§2åž‹æ­´5å¹´ã€‚é£²ã¿è–¬ã§é£Ÿå¾Œ170ãã‚‰ã„", "2025-12-18 10:00"),
    (39, 38, "å¹´é½¢çš„ã«ã‚‚ãã®ãã‚‰ã„ãªã‚‰è‰¯ã„ã¨æ€ã„ã¾ã™ã‚ˆ", "2025-12-18 10:30"),
    (40, None, "ãƒªãƒ–ãƒ¬ã®ã‚°ãƒ©ãƒ•è¦‹ã‚‹ã¨ã€å¯ã‚‹å‰ã«é£Ÿã¹ãŸæ™‚ã®å½±éŸ¿ãŒæœã¾ã§ã‚ã‹ã‚‹", "2025-12-18 12:00"),
    (41, 40, "å¤œé£Ÿã¯æœ¬å½“ã«éŸ¿ãã¾ã™ã‚ˆã­â€¦", "2025-12-18 12:30"),
    (42, None, "ä»Šæ—¥ã®é£Ÿå¾Œè¡€ç³–ãƒ™ã‚¹ãƒˆï¼ç™½ç±³æŠœã„ãŸã‚‰125ã ã£ãŸ", "2025-12-18 19:00"),
    (43, 42, "ç™½ç±³æŠœãã¨å…¨ç„¶é•ã„ã¾ã™ã‚ˆã­", "2025-12-18 19:30"),
    (44, None, "ã‚«ãƒ¬ãƒ¼ãƒ©ã‚¤ã‚¹é£Ÿã¹ãŸã‚‰190â€¦ã§ã‚‚é£Ÿã¹ãŸã‹ã£ãŸ", "2025-12-18 20:00"),
    (45, 44, "ãŸã¾ã«ã¯ã„ã„ã‚ˆï¼æˆ‘æ…¢ã—ã™ãŽã‚‚ã‚¹ãƒˆãƒ¬ã‚¹", "2025-12-18 20:30"),
    (46, None, "20ä»£ã§2åž‹ã€‚è‹¥ã„ã®ã«â€¦ã£ã¦è¨€ã‚ã‚Œã‚‹ã®ãŒã¤ã‚‰ã„", "2025-12-19 09:00"),
    (47, 46, "ç§ã‚‚20ä»£ã§è¨ºæ–­ã•ã‚Œã¾ã—ãŸã€‚ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†", "2025-12-19 09:30"),
    (48, None, "é‹å‹•ç™‚æ³•ãƒ¡ã‚¤ãƒ³ã§é ‘å¼µã£ã¦ã‚‹ã€‚é£Ÿå¾Œ1æ™‚é–“æ•£æ­©ã§140ä»¥ä¸‹", "2025-12-19 12:00"),
    (49, 48, "é‹å‹•ã ã‘ã§ãã“ã¾ã§ä¸‹ã’ã‚‰ã‚Œã‚‹ã®ã™ã”ã„ï¼", "2025-12-19 12:30"),
    (50, None, "é£Ÿãƒ‘ãƒ³1æžšã§160ã€‚6æžšåˆ‡ã‚Šãªã®ã«â€¦", "2025-12-19 14:00"),
    (51, 50, "ãƒ‘ãƒ³ã¯ç¨®é¡žã«ã‚ˆã£ã¦ã‚‚é•ã„ã¾ã™ã‚ˆã­", "2025-12-19 14:30"),
    (52, None, "1åž‹ã§10å¹´ä»¥ä¸Šã€‚ãƒãƒ³ãƒ—ã¨Dexcomã§å¤§åˆ†ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ", "2025-12-19 19:00"),
    (53, 52, "ãƒ‡ãƒã‚¤ã‚¹ã®é€²åŒ–ã™ã”ã„ã§ã™ã‚ˆã­", "2025-12-19 19:30"),
    (54, None, "ãŠå¯¿å¸6è²«ã§170ã€‚å°‘ãªã‚ã«ã—ãŸã®ã«â€¦", "2025-12-20 12:00"),
    (55, 54, "å¯¿å¸ã¯é…¢é£¯ãŒæ›²è€…ã§ã™ã‚ˆã­", "2025-12-20 12:30"),
    (56, None, "é£Ÿå¾Œã«çœ ããªã‚‹ã®ã¯è¡€ç³–å€¤ã‚¹ãƒ‘ã‚¤ã‚¯ã®ã‚µã‚¤ãƒ³ã£ã¦èžã„ãŸ", "2025-12-20 14:00"),
    (57, 56, "ç¢ºã‹ã«é«˜ã„æ™‚ã¯çœ ããªã‚‹æ°—ãŒã™ã‚‹", "2025-12-20 14:30"),
    (58, None, "ä»Šæ—¥ã¯å¤–é£Ÿã€‚ã‚¹ãƒ†ãƒ¼ã‚­ã«ã—ãŸã‚‰é£Ÿå¾Œ130ï¼è‚‰ã¯ä¸ŠãŒã‚Šã«ãã„", "2025-12-20 19:00"),
    (59, 58, "ã‚¿ãƒ³ãƒ‘ã‚¯è³ªãƒ¡ã‚¤ãƒ³ã ã¨ä¸ŠãŒã‚Šã«ãã„ã§ã™ã‚ˆã­", "2025-12-20 19:30"),
    (60, None, "å¹´æœ«å¹´å§‹ãŒæ€–ã„â€¦çµ¶å¯¾ä¸ŠãŒã‚‹", "2025-12-21 20:00"),
    (61, 60, "ã‚ã‹ã‚‹ã€‚ãŠæ­£æœˆã¯è¡€ç³–å€¤ç®¡ç†ç„¡ç†ã‚²ãƒ¼", "2025-12-21 20:30"),
    (62, None, "50ä»£å¥³æ€§ã€‚ã‚¤ãƒ³ã‚¹ãƒªãƒ³+é£²ã¿è–¬ã§é£Ÿå¾Œ160å‰å¾Œã€‚ã‚‚ã†å°‘ã—ä¸‹ã’ãŸã„", "2025-12-22 10:00"),
    (63, 62, "160ãªã‚‰æ‚ªããªã„ã¨æ€ã„ã¾ã™ã‚ˆï¼", "2025-12-22 10:30"),
    (64, None, "ã“ã‚“ã«ã‚ƒãéººã§ä»£ç”¨ã—ãŸã‚‰é£Ÿå¾Œ110ï¼ç¥ž", "2025-12-22 12:00"),
    (65, 64, "ã“ã‚“ã«ã‚ƒãéººã„ã„ã§ã™ã‚ˆã­ã€‚ç§ã‚‚æ„›ç”¨ã—ã¦ã‚‹", "2025-12-22 12:30"),
    (66, None, "ã‚¯ãƒªã‚¹ãƒžã‚¹ã‚±ãƒ¼ã‚­æ€–ã„â€¦ã§ã‚‚é£Ÿã¹ãŸã„", "2025-12-23 19:00"),
    (67, 66, "ä½Žç³–è³ªã‚±ãƒ¼ã‚­ãŠã™ã™ã‚ã§ã™ï¼", "2025-12-23 19:30"),
    (68, None, "ã‚±ãƒ¼ã‚­ä¸€åˆ‡ã‚Œã§180ã€‚è¦šæ‚Ÿã—ã¦ãŸã‹ã‚‰ã¾ã‚ã„ã„ã‹", "2025-12-24 21:00"),
    (69, 68, "ã‚¯ãƒªã‚¹ãƒžã‚¹ãã‚‰ã„ã¯ã­âœ¨", "2025-12-24 21:30"),
    (70, None, "ãƒªãƒ–ãƒ¬ã®çŸ¢å°ãŒçœŸä¸Šå‘ãã¨ãƒ“ãƒ“ã‚‹", "2025-12-25 12:00"),
    (71, 70, "æ€¥ä¸Šæ˜‡ã®çŸ¢å°è¦‹ã‚‹ã¨ç„¦ã‚Šã¾ã™ã‚ˆã­ç¬‘", "2025-12-25 12:30"),
    (72, None, "å¹´æœ«ã®ã™ãç„¼ãã€‚ã‚·ãƒ¡ã®ã†ã©ã‚“æˆ‘æ…¢ã—ãŸ", "2025-12-28 19:00"),
    (73, 72, "ãˆã‚‰ã„ï¼ç§ã¯é£Ÿã¹ã¡ã‚ƒã†â€¦", "2025-12-28 19:30"),
    (74, None, "ä»Šå¹´æœ€å¾Œã®æ¸¬å®šã€‚é£Ÿå¾Œ155ã€‚ã¾ã‚æ™®é€š", "2025-12-31 20:00"),
    (75, 74, "æ¥å¹´ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼", "2025-12-31 20:30"),
    (76, None, "ã‚ã‘ãŠã‚ï¼å…ƒæ—¦ã‹ã‚‰é¤…2å€‹ã§200è¶…ãˆðŸ˜…", "2026-01-01 11:00"),
    (77, 76, "æ­£æœˆã ã‹ã‚‰ä»•æ–¹ãªã„ï¼ç¬‘", "2026-01-01 11:30"),
    (78, None, "ãŠé›‘ç…®ã¯1æ¯ã ã‘ã«ã—ãŸã€‚ãã‚Œã§ã‚‚170", "2026-01-01 13:00"),
    (79, None, "ãŠã›ã¡ã®é»’è±†é£Ÿã¹ã™ãŽã¦å¤±æ•—ã—ãŸ", "2026-01-02 10:00"),
    (80, 79, "é»’è±†ç”˜ã„ã‚‚ã‚“ã­â€¦", "2026-01-02 10:30"),
    (81, None, "æ­£æœˆãƒ¢ãƒ¼ãƒ‰çµ‚äº†ã€‚ä»Šæ—¥ã‹ã‚‰é€šå¸¸é‹è»¢ã§140ä»¥ä¸‹ç›®æŒ‡ã™", "2026-01-04 12:00"),
    (82, 81, "ç§ã‚‚ä»Šæ—¥ã‹ã‚‰æ°—åˆã„å…¥ã‚Œç›´ã—ã¾ã™ï¼", "2026-01-04 12:30"),
    (83, None, "ä¸ƒè‰ç²¥ã¯æ„å¤–ã¨è¡€ç³–å€¤ä¸ŠãŒã‚‹ã€‚ãŠç²¥ã ã‹ã‚‰å¸åŽæ—©ã„", "2026-01-07 12:00"),
    (84, 83, "ãŠç²¥ã¯æ¶ˆåŒ–ã„ã„ã‹ã‚‰é€†ã«ãƒ€ãƒ¡ãªã‚“ã§ã™ã‚ˆã­", "2026-01-07 12:30"),
    (85, None, "30ä»£ç”·æ€§ã€‚é£Ÿäº‹ã¨é‹å‹•ã§130ä»¥ä¸‹ã‚­ãƒ¼ãƒ—ã§ãã¦ã‚‹", "2026-01-10 19:00"),
    (86, 85, "è–¬ãªã—ã§ãã‚Œã¯ã™ã”ã„ï¼", "2026-01-10 19:30"),
    (87, None, "40ä»£ã§å¢ƒç•Œåž‹ã‹ã‚‰2åž‹ã«é€²è¡Œã—ãŸã€‚é£Ÿå¾ŒãŒ160è¶…ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸ", "2026-01-12 14:00"),
    (88, 87, "ç§ã‚‚å¢ƒç•Œåž‹ã§ã™ã€‚æ°—ã‚’ã¤ã‘ãªã„ã¨â€¦", "2026-01-12 14:30"),
    (89, None, "ãƒªãƒ–ãƒ¬2ã®ã‚¢ãƒ©ãƒ¼ãƒ æ©Ÿèƒ½ä¾¿åˆ©ã€‚180è¶…ãˆãŸã‚‰æ•™ãˆã¦ãã‚Œã‚‹", "2026-01-15 10:00"),
    (90, 89, "ã‚¢ãƒ©ãƒ¼ãƒ æ©Ÿèƒ½ã„ã„ã§ã™ã‚ˆã­ã€‚æ°—ã¥ã‹ãªã„ã†ã¡ã«ä¸ŠãŒã£ã¦ã‚‹ã“ã¨å¤šã„ã‹ã‚‰", "2026-01-15 10:30"),
    (91, None, "ç‚­æ°´åŒ–ç‰©ã‚’æœ€å¾Œã«é£Ÿã¹ã‚‹ã¨ä¸ŠãŒã‚Šã«ãã„æ°—ãŒã™ã‚‹", "2026-01-17 12:00"),
    (92, 91, "é£Ÿã¹é †å¤§äº‹ã§ã™ã‚ˆã­ã€‚ç§ã‚‚é‡Žèœâ†’è‚‰â†’ã”é£¯ã®é †ç•ª", "2026-01-17 12:30"),
    (93, None, "Dexcom+ãƒãƒ³ãƒ—ã®çµ„ã¿åˆã‚ã›æœ€å¼·ã€‚é£Ÿå¾Œã®è‡ªå‹•èª¿æ•´ãŒæ¥½", "2026-01-19 15:00"),
    (94, 93, "1åž‹ã§ã™ã‹ï¼Ÿé€²ã‚“ã ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã­", "2026-01-19 15:30"),
    (95, 94, "ã¯ã„1åž‹ã§ã™ã€‚é«˜ã„ã‘ã©æŠ•è³‡ã™ã‚‹ä¾¡å€¤ã‚ã‚‹", "2026-01-19 16:00"),
    (96, None, "çŽ„ç±³ã«å¤‰ãˆãŸã‚‰é£Ÿå¾Œè¡€ç³–ãŒ20ãã‚‰ã„ä¸‹ãŒã£ãŸ", "2026-01-22 19:00"),
    (97, 96, "çŽ„ç±³åŠ¹æžœã‚ã‚Šã¾ã™ã‚ˆã­ï¼GIå€¤ä½Žã„ã—", "2026-01-22 19:30"),
    (98, None, "ã‚‚ã¡éº¦ã”é£¯ãŠã™ã™ã‚ã€‚ç™½ç±³ã‚ˆã‚Šä¸ŠãŒã‚Šã«ãã„", "2026-01-24 12:00"),
    (99, 98, "ã‚‚ã¡éº¦è©¦ã—ã¦ã¿ã¾ã™ï¼", "2026-01-24 12:30"),
    (100, None, "100ã‚³ãƒ¡ãƒ³ãƒˆçªç ´ï¼ã¿ã‚“ãªã§æƒ…å ±å…±æœ‰ã§ãã¦å¬‰ã—ã„", "2026-01-25 20:00"),
    (101, 100, "å‚è€ƒã«ãªã‚‹è©±ã°ã‹ã‚Šã§åŠ©ã‹ã£ã¦ã¾ã™", "2026-01-25 20:30"),
    (102, None, "ç„¼è‚‰ãªã‚‰é£Ÿå¾Œ120ã€‚è‚‰æœ€é«˜", "2026-01-27 19:00"),
    (103, 102, "ã‚¿ãƒ¬ã«æ³¨æ„ã™ã‚Œã°è‚‰ã¯ã„ã„ã§ã™ã‚ˆã­", "2026-01-27 19:30"),
    # Future comments (after 2026-01-27)
    (104, None, "ã‚µãƒ©ãƒ€ã«ã‚ªãƒªãƒ¼ãƒ–ã‚ªã‚¤ãƒ«ã‹ã‘ã‚‹ã¨è¡€ç³–å€¤ã®ä¸ŠãŒã‚ŠãŒç·©ã‚„ã‹ã«ãªã‚‹", "2026-01-29 12:00"),
    (105, 104, "æ²¹ã§å¸åŽé…ããªã‚‹ã£ã¦ã“ã¨ã§ã™ã‹ï¼Ÿ", "2026-01-29 12:30"),
    (106, 105, "ãã†ã‚‰ã—ã„ã§ã™ã€‚å…ˆç”Ÿã«æ•™ãˆã¦ã‚‚ã‚‰ã„ã¾ã—ãŸ", "2026-01-29 13:00"),
    (107, None, "50ä»£1åž‹ã€‚ã‚¤ãƒ³ã‚¹ãƒªãƒ³ã®å˜ä½èª¿æ•´ãŒé›£ã—ã„", "2026-02-01 14:00"),
    (108, 107, "1åž‹ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¯2åž‹ã‚ˆã‚Šå¤§å¤‰ã§ã™ã‚ˆã­", "2026-02-01 14:30"),
    (109, None, "ã‚³ãƒ³ãƒ“ãƒ‹ã®ã‚µãƒ©ãƒ€ãƒã‚­ãƒ³ã¯è¡€ç³–å€¤ä¸ŠãŒã‚‰ãªã„ã‹ã‚‰é‡å®ã—ã¦ã‚‹", "2026-02-03 12:00"),
    (110, 109, "ã‚µãƒ©ãƒ€ãƒã‚­ãƒ³ç¥žã§ã™ã‚ˆã­", "2026-02-03 12:30"),
    (111, None, "é£Ÿå¾Œã«é…¢ã‚’é£²ã‚€ã¨ä¸ŠãŒã‚Šã«ãã„ã£ã¦æœ¬å½“ï¼Ÿ", "2026-02-05 19:00"),
    (112, 111, "ç§ã¯é£Ÿå‰ã«ã‚Šã‚“ã”é…¢é£²ã‚“ã§ã¾ã™ã€‚åŠ¹æžœã‚ã‚‹æ°—ãŒã™ã‚‹", "2026-02-05 19:30"),
    (113, None, "å¯’ã„æ—¥ã¯è¡€ç³–å€¤ä¸ŠãŒã‚Šã‚„ã™ã„æ°—ãŒã™ã‚‹", "2026-02-07 08:00"),
    (114, 113, "å†¬ã¯ä»£è¬è½ã¡ã‚‹ã‹ã‚‰ã§ã™ã‹ã­", "2026-02-07 08:30"),
    (115, None, "ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ã®ãƒãƒ§ã‚³ã€é«˜ã‚«ã‚«ã‚ªã«ã—ãŸã‚‰é£Ÿå¾Œ140ã§åŽã¾ã£ãŸ", "2026-02-14 20:00"),
    (116, 115, "é«˜ã‚«ã‚«ã‚ªãªã‚‰ã¾ã ãƒžã‚·ã§ã™ã‚ˆã­", "2026-02-14 20:30"),
    (117, None, "60ä»£ã§é£Ÿäº‹é‹å‹•ã®ã¿ã§é ‘å¼µã£ã¦ã‚‹ã€‚é£Ÿå¾Œ160ãŒé™ç•Œ", "2026-02-17 10:00"),
    (118, 117, "è–¬ãªã—ã§ãã‚Œãªã‚‰ç´ æ™´ã‚‰ã—ã„ã§ã™ï¼", "2026-02-17 10:30"),
    (119, None, "æœé£Ÿå¾ŒãŒä¸€ç•ªé«˜ã„ã€‚150ã€œ170ã«ãªã‚‹", "2026-02-19 08:00"),
    (120, 119, "æšç¾è±¡ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­", "2026-02-19 08:30"),
    (121, None, "æ˜¼ã¯è»½ã‚ã«ã—ã¦ã‚‹ã‹ã‚‰é£Ÿå¾Œ120ãã‚‰ã„", "2026-02-20 13:00"),
    (122, 121, "æ˜¼ã‚’è»½ãã™ã‚‹ã®å¤§äº‹ã§ã™ã‚ˆã­", "2026-02-20 13:30"),
    (123, None, "å¤•é£Ÿå¾ŒãŒ200è¶…ãˆã‚‹æ—¥ãŒã‚ã‚‹ã€‚ç–²ã‚Œã¦ã‚‹æ™‚", "2026-02-22 21:00"),
    (124, 123, "ã‚¹ãƒˆãƒ¬ã‚¹ã‚„ç–²åŠ´ã‚‚å½±éŸ¿ã—ã¾ã™ã‚ˆã­", "2026-02-22 21:30"),
    (125, None, "ã‚ªãƒ¼ãƒˆãƒŸãƒ¼ãƒ«ã®æœé£Ÿã«ã—ãŸã‚‰é£Ÿå¾Œ130ä»¥ä¸‹ã§å®‰å®š", "2026-02-24 08:00"),
    (126, 125, "ã‚ªãƒ¼ãƒˆãƒŸãƒ¼ãƒ«äººæ°—ã§ã™ã‚ˆã­ã€‚ç§ã‚‚å§‹ã‚ã‚ˆã†ã‹ãª", "2026-02-24 08:30"),
    (127, None, "é£Ÿå¾Œè¡€ç³–å€¤ã‚ˆã‚Šè¡€ç³–å€¤ã‚¹ãƒ‘ã‚¤ã‚¯ã®å¹…ãŒå¤§äº‹ã£ã¦è¨€ã‚ã‚ŒãŸ", "2026-02-25 15:00"),
    (128, 127, "æ€¥ä¸Šæ˜‡æ€¥é™ä¸‹ãŒè‰¯ããªã„ã‚“ã§ã™ã‚ˆã­", "2026-02-25 15:30"),
    (129, None, "3å¹´ã‹ã‘ã¦ã‚„ã£ã¨é£Ÿå¾Œ150ä»¥ä¸‹ã§å®‰å®šã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ", "2026-02-26 19:00"),
    (130, 129, "é•·ã„é“ã®ã‚Šã§ã—ãŸã­ã€‚ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼", "2026-02-26 19:30"),
    (131, None, "é£Ÿç‰©ç¹Šç¶­ã‚’å…ˆã«å–ã‚‹ã¨é£Ÿå¾Œè¡€ç³–å€¤ãŒé•ã†", "2026-02-27 12:00"),
    (132, 131, "é‡Žèœãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã¯åŸºæœ¬ã§ã™ã‚ˆã­", "2026-02-27 12:30"),
    (133, None, "ã¿ã‚“ãªã®å ±å‘Šå‚è€ƒã«ãªã‚‹ã€‚ã“ã®ã‚¹ãƒ¬è¦‹ã¦å‹‰å¼·ã—ã¦ã¾ã™", "2026-02-28 10:00"),
    (134, 133, "åŒæ„Ÿã§ã™ï¼ãƒªã‚¢ãƒ«ãªæ•°å­—ãŒä¸€ç•ªå‚è€ƒã«ãªã‚‹", "2026-02-28 10:30"),
    (135, None, "çµå±€ã€è‡ªåˆ†ã®ä½“ã§è©¦ã—ã¦å­¦ã¶ã—ã‹ãªã„ã‚“ã ã‚ˆã­", "2026-02-28 19:00"),
    (136, 135, "äººã«ã‚ˆã£ã¦é•ã†ã‹ã‚‰å®Ÿé¨“å¤§äº‹ã§ã™ã‚ˆã­", "2026-02-28 19:30"),
    (137, None, "ãƒªãƒ–ãƒ¬ä½¿ã„å§‹ã‚ã¦é£Ÿå¾Œè¡€ç³–ã®å‚¾å‘ãŒã‚ã‹ã‚‹ã‚ˆã†ã«ãªã£ãŸ", "2026-02-28 20:00"),
    (138, 137, "CGMã¯ä¸–ç•Œå¤‰ã‚ã‚Šã¾ã™ã‚ˆã­", "2026-02-28 20:30"),
    (139, None, "ã“ã‚Œã‹ã‚‰ã‚‚ã¿ã‚“ãªã§æƒ…å ±å…±æœ‰ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼", "2026-02-28 21:00"),
    (140, 139, "é ‘å¼µã‚Šã¾ã—ã‚‡ã†ðŸ’ª", "2026-02-28 21:30"),
    (141, None, "3æœˆã‚‚å¼•ãç¶šãå ±å‘Šã—ã¦ã„ãã¾ã™ï¼", "2026-02-28 22:00"),
]

def jst_to_utc(jst_str):
    """Convert JST datetime string to UTC ISO format"""
    dt = datetime.strptime(jst_str, "%Y-%m-%d %H:%M")
    dt_utc = dt - timedelta(hours=9)
    return dt_utc.strftime("%Y-%m-%dT%H:%M:%S+00:00")

def assign_user_ids(comments):
    """Assign user_ids to comments, keeping conversation consistency"""
    # Map: comment_number -> user_id
    user_map = {}
    user_idx = 0

    for num, reply_to, body, dt in comments:
        if reply_to and reply_to in user_map:
            # Reply: assign a different user than the parent
            parent_user = user_map[reply_to]
            # Pick next available user that's different from parent
            candidate = USERS[user_idx % len(USERS)]
            while candidate == parent_user:
                user_idx += 1
                candidate = USERS[user_idx % len(USERS)]
            user_map[num] = candidate
            user_idx += 1
        else:
            # New topic: assign next user
            user_map[num] = USERS[user_idx % len(USERS)]
            user_idx += 1

    return user_map

def insert_batch(records, batch_num):
    """Insert a batch of records via REST API"""
    url = f"{SUPABASE_URL}/rest/v1/comments"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }

    data = json.dumps(records).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="POST")

    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Batch {batch_num}: {resp.status} - {len(records)} records inserted")
            return True
    except urllib.error.HTTPError as e:
        print(f"  Batch {batch_num}: ERROR {e.code} - {e.read().decode()}")
        return False

def main():
    print(f"Processing {len(COMMENTS)} comments for thread No.12")
    print(f"Thread ID: {THREAD_ID}")

    # Generate UUIDs for each comment
    comment_uuids = {}
    for num, _, _, _ in COMMENTS:
        comment_uuids[num] = str(uuid.uuid4())

    # Assign user IDs
    user_map = assign_user_ids(COMMENTS)

    # Build records
    records = []
    now_utc = datetime.utcnow()
    past_count = 0
    future_count = 0

    for num, reply_to, body, dt_jst in COMMENTS:
        utc_str = jst_to_utc(dt_jst)
        dt_obj = datetime.strptime(dt_jst, "%Y-%m-%d %H:%M") - timedelta(hours=9)

        is_future = dt_obj > now_utc
        if is_future:
            future_count += 1
        else:
            past_count += 1

        parent_id = comment_uuids[reply_to] if reply_to else None

        record = {
            "id": comment_uuids[num],
            "thread_id": THREAD_ID,
            "body": body,
            "user_id": user_map[num],
            "is_hidden": False,
            "created_at": utc_str,
            "parent_id": parent_id,
        }

        records.append(record)

    print(f"Past comments: {past_count}")
    print(f"Future comments: {future_count}")
    print(f"Total: {len(records)}")
    print()

    # Insert in batches of 50
    BATCH_SIZE = 50
    for i in range(0, len(records), BATCH_SIZE):
        batch = records[i:i+BATCH_SIZE]
        batch_num = i // BATCH_SIZE + 1
        success = insert_batch(batch, batch_num)
        if not success:
            print("STOPPING due to error")
            return

    print(f"\nAll {len(records)} comments inserted!")

    # Update comments_count on thread
    print(f"\nUpdating comments_count to {past_count}...")
    url = f"{SUPABASE_URL}/rest/v1/threads?id=eq.{THREAD_ID}"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps({"comments_count": past_count}).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="PATCH")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Updated: {resp.status}")
    except urllib.error.HTTPError as e:
        print(f"  ERROR: {e.code} - {e.read().decode()}")

if __name__ == "__main__":
    main()
