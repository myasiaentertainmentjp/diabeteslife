#!/usr/bin/env python3
"""Insert 111 comments for thread No.15: ã€æ„šç—´ã€‘ä»Šæ—¥ã®ãƒ¢ãƒ¤ãƒ¢ãƒ¤åãå‡ºã—"""

import uuid
import json
import urllib.request
from datetime import datetime, timedelta, timezone

SUPABASE_URL = "https://josanlblwfjdaaezqbnw.supabase.co"
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impvc2FubGJsd2ZqZGFhZXpxYm53Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2Nzg0MjYwNiwiZXhwIjoyMDgzNDE4NjA2fQ.JlTXBmY5HJAqfRD_AazsiBORpgLZfB74fPkNyyfVSQY"

THREAD_ID = "4fd20952-e2db-473e-9ea4-864a79575d83"
THREAD_OWNER_ID = "2033ee1c-28b2-5187-8ba1-c94f7964e33e"

USERS = [
    "b0000001-0000-0000-0000-000000000001",
    "b0000001-0000-0000-0000-000000000002",
    "b0000001-0000-0000-0000-000000000003",
    "b0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000005",
    "b0000001-0000-0000-0000-000000000006",
    "b0000001-0000-0000-0000-000000000007",
    "b0000001-0000-0000-0000-000000000008",
    "b0000001-0000-0000-0000-000000000009",
    "b0000001-0000-0000-0000-000000000010",
    "b0000001-0000-0000-0000-000000000011",
    "b0000001-0000-0000-0000-000000000012",
    "b0000001-0000-0000-0000-000000000013",
    "b0000001-0000-0000-0000-000000000014",
    "b0000001-0000-0000-0000-000000000015",
    "f0000001-0000-0000-0000-000000000001",
    "f0000001-0000-0000-0000-000000000002",
    "f0000001-0000-0000-0000-000000000005",
    "f0000001-0000-0000-0000-000000000006",
    "f0000001-0000-0000-0000-000000000009",
    "f0000001-0000-0000-0000-000000000010",
    "f0000001-0000-0000-0000-000000000008",
    "f0000001-0000-0000-0000-000000000003",
    "f0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000016",
    "b0000001-0000-0000-0000-000000000017",
    "b0000001-0000-0000-0000-000000000018",
    "b0000001-0000-0000-0000-000000000019",
    "b0000001-0000-0000-0000-000000000020",
    THREAD_OWNER_ID,
]

COMMENTS = [
    (2, None, "è·å ´ã®äººã«ã€Œç”˜ã„ã‚‚ã®é£Ÿã¹ã™ãŽãŸã‚“ã§ã—ã‚‡ã€ã£ã¦è¨€ã‚ã‚ŒãŸã€‚é•ã†ã‚“ã ã‘ã©", "2025-12-15 12:00"),
    (3, 2, "ãã‚Œæœ¬å½“ã«ãƒ ã‚«ã¤ãã€‚ç³–å°¿ç—…ã®åŽŸå› ã‚ã‹ã£ã¦ãªã„äººå¤šã™ãŽ", "2025-12-15 12:30"),
    (4, 2, "éºä¼ã¨ã‹ä½“è³ªã‚‚ã‚ã‚‹ã®ã«ã­â€¦", "2025-12-15 13:00"),
    (5, None, "è¦ªã«ã€Œè‡ªå·±ç®¡ç†ã§ãã¦ãªã„è¨¼æ‹ ã€ã£ã¦è¨€ã‚ã‚Œã¦æ³£ããã†", "2025-12-15 19:00"),
    (6, 5, "ã²ã©ã„â€¦ã€‚é ‘å¼µã£ã¦ã‚‹ã®ã«ç†è§£ã•ã‚Œãªã„ã®è¾›ã„ã§ã™ã‚ˆã­", "2025-12-15 19:30"),
    (7, None, "é£²ã¿ä¼šæ–­ã£ãŸã‚‰ã€Œä»˜ãåˆã„æ‚ªã„ã€ã£ã¦è¨€ã‚ã‚ŒãŸ", "2025-12-15 21:00"),
    (8, 7, "å¥åº·ã®ãŸã‚ãªã®ã«ã€‚ã‚ã‹ã£ã¦ã‚‚ã‚‰ãˆãªã„ã§ã™ã‚ˆã­", "2025-12-15 21:30"),
    (9, None, "æ¤œæŸ»ã®çµæžœæ‚ªãã¦å‡¹ã‚“ã§ã‚‹â€¦é ‘å¼µã£ãŸã®ã«", "2025-12-16 10:00"),
    (10, 9, "åŠªåŠ›ãŒæ•°å€¤ã«å‡ºãªã„æ™‚ã‚ã‚Šã¾ã™ã‚ˆã­ã€‚ãŠç–²ã‚Œæ§˜ã§ã™", "2025-12-16 10:30"),
    (11, None, "ã€Œç³–å°¿ç—…ã£ã¦ä¸€ç”Ÿæ²»ã‚‰ãªã„ã®ï¼Ÿã€ã£ã¦èžã‹ã‚Œã‚‹ã®åœ°å‘³ã«ãã¤ã„", "2025-12-16 14:00"),
    (12, 11, "æ‚ªæ°—ãªãèžã„ã¦ãã‚‹ã‚“ã ã‚ã†ã‘ã©â€¦å‚·ã¤ãã¾ã™ã‚ˆã­", "2025-12-16 14:30"),
    (13, None, "é£Ÿäº‹åˆ¶é™ã—ã¦ã‚‹ã®ã«ä½“é‡æ¸›ã‚‰ãªã„ã€‚ãªã‚“ã§", "2025-12-16 20:00"),
    (14, 13, "ç§ã‚‚ã§ã™â€¦ã€‚è–¬ã®å½±éŸ¿ã‹ã‚‚ã£ã¦è¨€ã‚ã‚ŒãŸ", "2025-12-16 20:30"),
    (15, None, "ä¸»æ²»åŒ»ã«ã€Œã‚‚ã£ã¨é ‘å¼µã£ã¦ã€ã£ã¦è¨€ã‚ã‚ŒãŸã€‚é ‘å¼µã£ã¦ã‚‹ã‚“ã ã‘ã©", "2025-12-17 15:00"),
    (16, 15, "å…ˆç”Ÿã«ãã‚Œè¨€ã‚ã‚Œã‚‹ã¨è¾›ã„ã§ã™ã‚ˆã­â€¦", "2025-12-17 15:30"),
    (17, 15, "è»¢é™¢ã‚‚é¸æŠžè‚¢ã‹ã‚‚ã€‚ç›¸æ€§å¤§äº‹", "2025-12-17 16:00"),
    (18, None, "ä¿é™ºã®å¯©æŸ»è½ã¡ãŸã€‚ç³–å°¿ç—…ã ã‹ã‚‰ã£ã¦", "2025-12-17 19:00"),
    (19, 18, "ç§ã‚‚ç”Ÿå‘½ä¿é™ºå…¥ã‚Œãªã‹ã£ãŸâ€¦å·®åˆ¥ã ã‚ˆã­", "2025-12-17 19:30"),
    (20, None, "æ¯Žæœˆã®åŒ»ç™‚è²»ãŒç—›ã„ã€‚ãªã‚“ã§ã“ã‚“ãªã«ã‹ã‹ã‚‹ã®", "2025-12-18 10:00"),
    (21, 20, "ã‚»ãƒ³ã‚µãƒ¼ä»£ã¨ã‹è–¬ä»£ã¨ã‹â€¦æœ¬å½“ã«é«˜ã„ã§ã™ã‚ˆã­", "2025-12-18 10:30"),
    (22, None, "ä¼šç¤¾ã®å¥åº·è¨ºæ–­ã®çµæžœã€äººäº‹ã«è¦‹ã‚‰ã‚Œã¦ã‚‹ã¨æ€ã†ã¨å«Œ", "2025-12-18 14:00"),
    (23, 22, "ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã®å•é¡Œã§ã™ã‚ˆã­â€¦", "2025-12-18 14:30"),
    (24, None, "ã€Œè¦‹ãŸç›®æ™®é€šãªã®ã«ã€ã£ã¦è¨€ã‚ã‚Œã‚‹ã€‚è¦‹ãŸç›®ã˜ã‚ƒã‚ã‹ã‚‰ãªã„ã‚“ã ã‚ˆ", "2025-12-18 20:00"),
    (25, 24, "ç›®ã«è¦‹ãˆãªã„ç—…æ°—ã£ã¦ç†è§£ã•ã‚Œã«ãã„ã§ã™ã‚ˆã­", "2025-12-18 20:30"),
    (26, None, "å¿˜å¹´ä¼šã®ã‚³ãƒ¼ã‚¹æ–™ç†ã€ç³–è³ªã ã‚‰ã‘ã§é£Ÿã¹ã‚‹ã‚‚ã®ãªã‹ã£ãŸ", "2025-12-19 22:00"),
    (27, 26, "ãŠç–²ã‚Œæ§˜ã§ã™â€¦ã€‚ã‚¢ãƒ©ã‚«ãƒ«ãƒˆãªã‚‰ã¾ã ã„ã„ã®ã«ã­", "2025-12-19 22:30"),
    (28, None, "ã‚¤ãƒ³ã‚¹ãƒªãƒ³æ‰“ã¤å ´æ‰€æŽ¢ã™ã®å¤§å¤‰ã€‚ãƒˆã‚¤ãƒ¬å€Ÿã‚Šã‚‹ã®æ°—ã¾ãšã„", "2025-12-20 12:00"),
    (29, 28, "ã‚ã‹ã‚Šã¾ã™â€¦ã€‚å ‚ã€…ã¨æ‰“ã¦ã‚‹ä¸–ã®ä¸­ã«ãªã£ã¦ã»ã—ã„", "2025-12-20 12:30"),
    (30, None, "ã€Œé‹å‹•ã™ã‚Œã°æ²»ã‚‹ã€ã£ã¦è¨€ã‚ã‚ŒãŸã€‚ãã‚“ãªå˜ç´”ã˜ã‚ƒãªã„", "2025-12-20 19:00"),
    (31, 30, "1åž‹ã®äººã«è¨€ã£ãŸã‚‰æœ€æ‚ªã§ã™ã‚ˆã­", "2025-12-20 19:30"),
    (32, None, "ã‚¯ãƒªã‚¹ãƒžã‚¹ã‚±ãƒ¼ã‚­æˆ‘æ…¢ã—ã¦ã‚‹ã®ã«å®¶æ—ãŒç›®ã®å‰ã§é£Ÿã¹ã¦ã‚‹", "2025-12-24 20:00"),
    (33, 32, "ãã‚Œã¯ãã¤ã„â€¦ã€‚å°‘ã—ãã‚‰ã„é£Ÿã¹ã¦ã‚‚ã„ã„ã¨æ€ã„ã¾ã™ã‚ˆ", "2025-12-24 20:30"),
    (34, None, "å¹´æœ«å¹´å§‹ã€è¦ªæˆšã«ç—…æ°—ã®ã“ã¨èžã‹ã‚Œã‚‹ã®æ†‚é¬±", "2025-12-26 19:00"),
    (35, 34, "ã€Œæœ€è¿‘ã©ã†ï¼Ÿã€ã£ã¦èžã‹ã‚Œã‚‹ã®å«Œã§ã™ã‚ˆã­", "2025-12-26 19:30"),
    (36, None, "æ­£æœˆãã‚‰ã„å¥½ããªã‚‚ã®é£Ÿã¹ãŸã„ã®ã«â€¦", "2025-12-28 20:00"),
    (37, 36, "ãŠæ­£æœˆã¯ç‰¹ã«æˆ‘æ…¢ãŒè¾›ã„ã§ã™ã‚ˆã­", "2025-12-28 20:30"),
    (38, None, "ãŠé¤…é£Ÿã¹ãŸã‚‰è¡€ç³–å€¤çˆ†ä¸ŠãŒã‚Šã€‚ã‚ã‹ã£ã¦ãŸã‘ã©æ‚²ã—ã„", "2026-01-01 15:00"),
    (39, 38, "æ­£æœˆã ã‹ã‚‰ä»•æ–¹ãªã„â€¦ã€‚åˆ‡ã‚Šæ›¿ãˆã¾ã—ã‚‡ã†", "2026-01-01 15:30"),
    (40, None, "è¦ªæˆšã«ã€Œã‚ã‚“ãŸç³–å°¿ãªã®ã«ãã‚“ãªé£Ÿã¹ã¦å¤§ä¸ˆå¤«ï¼Ÿã€ã£ã¦å¤§å£°ã§è¨€ã‚ã‚ŒãŸ", "2026-01-02 18:00"),
    (41, 40, "ãƒ‡ãƒªã‚«ã‚·ãƒ¼ãªã•ã™ãŽâ€¦ã€‚ãã‚Œæœ¬å½“ã«å«Œã§ã™ã­", "2026-01-02 18:30"),
    (42, 40, "å‘¨ã‚Šã«èžã“ãˆã‚‹å£°ã§è¨€ã†ã®ã‚„ã‚ã¦ã»ã—ã„ã§ã™ã‚ˆã­", "2026-01-02 19:00"),
    (43, None, "æ­£æœˆå¤ªã‚Šã—ãŸã€‚ã‚ã‹ã£ã¦ãŸã‘ã©å‡¹ã‚€", "2026-01-04 10:00"),
    (44, 43, "ç§ã‚‚â€¦ã€‚ä»Šæ—¥ã‹ã‚‰é ‘å¼µã‚Šã¾ã—ã‚‡ã†", "2026-01-04 10:30"),
    (45, None, "ã€Œç³–å°¿ç—…ã®è–¬é£²ã‚“ã§ã‚Œã°é£Ÿã¹ã¦ã‚‚å¤§ä¸ˆå¤«ã§ã—ã‚‡ã€ã£ã¦è¨€ã‚ã‚ŒãŸ", "2026-01-06 12:00"),
    (46, 45, "è–¬ã¯é­”æ³•ã˜ã‚ƒãªã„ã®ã«ã­â€¦", "2026-01-06 12:30"),
    (47, None, "ä½Žè¡€ç³–ã§ãƒ•ãƒ©ãƒ•ãƒ©ã—ãŸã€‚èª°ã«ã‚‚è¨€ãˆãªã‹ã£ãŸ", "2026-01-07 19:00"),
    (48, 47, "å¤§ä¸ˆå¤«ã§ã—ãŸã‹ï¼Ÿä½Žè¡€ç³–æ€–ã„ã§ã™ã‚ˆã­", "2026-01-07 19:30"),
    (49, None, "ä»•äº‹ä¸­ã«è¡€ç³–æ¸¬å®šã§ããªã„ã€‚ãƒˆã‚¤ãƒ¬ã«éš ã‚Œã¦ã‚‹", "2026-01-08 14:00"),
    (50, 49, "å ‚ã€…ã¨æ¸¬ã‚Œã‚‹ç’°å¢ƒã«ãªã£ã¦ã»ã—ã„ã§ã™ã‚ˆã­", "2026-01-08 14:30"),
    (51, None, "å‹é”ã¨ãƒ©ãƒ³ãƒè¡Œãã¨æ°—ã‚’ä½¿ã‚ã›ã¦ã—ã¾ã†", "2026-01-10 12:00"),
    (52, 51, "ã€Œã©ã“ã§ã‚‚ã„ã„ã‚ˆã€ã£ã¦è¨€ã£ã¦ãã‚Œã‚‹ã‘ã©ç”³ã—è¨³ãªã„æ°—æŒã¡ã«ãªã‚Šã¾ã™ã‚ˆã­", "2026-01-10 12:30"),
    (53, None, "ãªã‚“ã§è‡ªåˆ†ã ã‘â€¦ã£ã¦æ€ã†æ—¥ãŒã‚ã‚‹", "2026-01-12 21:00"),
    (54, 53, "ãã®æ°—æŒã¡ã‚ã‹ã‚Šã¾ã™ã€‚ã§ã‚‚ä¸€äººã˜ã‚ƒãªã„ã§ã™ã‚ˆ", "2026-01-12 21:30"),
    (55, 53, "ã“ã“ã«ã„ã‚‹ä»²é–“ã¿ã‚“ãªåŒã˜æ°—æŒã¡çµŒé¨“ã—ã¦ã¾ã™", "2026-01-12 22:00"),
    (56, None, "ãƒãƒƒãƒˆã§ã€Œç³–å°¿ç—…ã¯è‡ªæ¥­è‡ªå¾—ã€ã£ã¦è¦‹ã¦è½ã¡è¾¼ã‚“ã ", "2026-01-14 20:00"),
    (57, 56, "ãã†ã„ã†ç„¡çŸ¥ãªäººã®æ„è¦‹ã¯ç„¡è¦–ã§ã„ã„ã§ã™", "2026-01-14 20:30"),
    (58, 56, "éºä¼ã‚„ä½“è³ªã‚‚ã‚ã‚‹ã®ã«ã­ã€‚æ°—ã«ã—ãªã„ã§", "2026-01-14 21:00"),
    (59, None, "åˆä½µç—‡ãŒæ€–ãã¦å¤œçœ ã‚Œãªã„æ™‚ãŒã‚ã‚‹", "2026-01-15 23:00"),
    (60, 59, "ä¸å®‰ã«ãªã‚Šã¾ã™ã‚ˆã­â€¦ã€‚ã§ã‚‚ç®¡ç†ã—ã¦ã‚Œã°å¤§ä¸ˆå¤«", "2026-01-15 23:30"),
    (61, None, "é€šé™¢ã®åº¦ã«ä»•äº‹ä¼‘ã¾ãªãã‚ƒã„ã‘ãªã„ã®è¾›ã„", "2026-01-17 09:00"),
    (62, 61, "æœ‰çµ¦æ¸›ã£ã¦ã„ãã¾ã™ã‚ˆã­â€¦", "2026-01-17 09:30"),
    (63, None, "è–¬ã®å‰¯ä½œç”¨ã§ãŠè…¹å£Šã—ã¦ã‚‹ã€‚ä»•äº‹ä¸­ãã¤ã„", "2026-01-19 14:00"),
    (64, 63, "ãƒ¡ãƒˆãƒ›ãƒ«ãƒŸãƒ³ã§ã™ã‹ï¼Ÿæœ€åˆã¯è¾›ã„ã§ã™ã‚ˆã­", "2026-01-19 14:30"),
    (65, 63, "ãã†ã§ã™â€¦ã€‚æ…£ã‚Œã‚‹ã¾ã§è€ãˆã‚‹ã—ã‹ãªã„ã®ã‹ãª", "2026-01-19 15:00"),
    (66, None, "ã€Œè‹¥ã„ã®ã«ç³–å°¿ç—…ï¼Ÿã€ã£ã¦é©šã‹ã‚Œã‚‹ã®ã—ã‚“ã©ã„", "2026-01-20 19:00"),
    (67, 66, "20ä»£ã§è¨€ã‚ã‚Œã‚‹ã¨ç‰¹ã«ãã¤ã„ã§ã™ã‚ˆã­", "2026-01-20 19:30"),
    (68, None, "å½¼æ°ã«ç³–å°¿ç—…ã®ã“ã¨è¨€ãˆã¦ãªã„ã€‚ã„ã¤è¨€ãŠã†", "2026-01-22 21:00"),
    (69, 68, "é›£ã—ã„ã§ã™ã‚ˆã­â€¦ã€‚ã§ã‚‚ç†è§£ã—ã¦ãã‚Œã‚‹äººã ã¨ã„ã„ã§ã™ã­", "2026-01-22 21:30"),
    (70, None, "ç—…é™¢ã®å¾…ã¡æ™‚é–“é•·ã™ãŽã€‚3æ™‚é–“å¾…ã£ãŸ", "2026-01-24 17:00"),
    (71, 70, "äºˆç´„ã—ã¦ã‚‹ã®ã«å¾…ãŸã•ã‚Œã¾ã™ã‚ˆã­â€¦", "2026-01-24 17:30"),
    (72, None, "ã‚¹ãƒˆãƒ¬ã‚¹ã§è¡€ç³–å€¤ä¸ŠãŒã£ãŸã€‚æ‚ªå¾ªç’°", "2026-01-25 20:00"),
    (73, 72, "ã‚¹ãƒˆãƒ¬ã‚¹ã‚‚æ•µã§ã™ã‚ˆã­ã€‚ãŠç–²ã‚Œæ§˜ã§ã™", "2026-01-25 20:30"),
    (74, None, "é£Ÿã¹ãŸã„ã‚‚ã®æˆ‘æ…¢ã—ç¶šã‘ã‚‹äººç”Ÿã‹ã¨æ€ã†ã¨æ³£ã‘ã¦ãã‚‹", "2026-01-27 22:00"),
    (75, 74, "ãŸã¾ã«ã¯é£Ÿã¹ã¦ã„ã„ã¨æ€ã„ã¾ã™ã‚ˆã€‚å®Œç’§ã˜ã‚ƒãªãã¦ã„ã„", "2026-01-27 22:30"),
    (76, 74, "ç§ã‚‚ãã†æ€ã†æ™‚ã‚ã‚‹ã€‚ã§ã‚‚ä»²é–“ãŒã„ã‚‹ã‹ã‚‰é ‘å¼µã‚Œã‚‹", "2026-01-27 23:00"),
    # Future comments
    (77, None, "è¶³ãŒã—ã³ã‚Œã¦ããŸã€‚åˆä½µç—‡ã‹ãªâ€¦æ€–ã„", "2026-01-29 19:00"),
    (78, 77, "æ—©ã‚ã«å…ˆç”Ÿã«ç›¸è«‡ã—ãŸæ–¹ãŒã„ã„ã§ã™ã‚ˆ", "2026-01-29 19:30"),
    (79, None, "å¥åº·ãªäººãŒç¾¨ã¾ã—ã„ã¨æ€ã£ã¦ã—ã¾ã†è‡ªåˆ†ãŒå«Œ", "2026-01-31 21:00"),
    (80, 79, "ãã®æ°—æŒã¡ã¯è‡ªç„¶ã ã¨æ€ã„ã¾ã™ã‚ˆ", "2026-01-31 21:30"),
    (81, None, "2æœˆã«ãªã£ãŸã€‚æ„šç—´èžã„ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†", "2026-02-01 10:00"),
    (82, 81, "ãŠäº’ã„æ§˜ã§ã™ã€‚ã“ã“ã§åãå‡ºã—ã¾ã—ã‚‡ã†", "2026-02-01 10:30"),
    (83, None, "ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ã€ãƒãƒ§ã‚³ã‚‚ã‚‰ã£ã¦ã‚‚é£Ÿã¹ã‚‰ã‚Œãªã„ã®æ‚²ã—ã„", "2026-02-10 19:00"),
    (84, 83, "å°‘ã—ãªã‚‰å¤§ä¸ˆå¤«ã§ã™ã‚ˆï¼", "2026-02-10 19:30"),
    (85, None, "ä¼šç¤¾ã®äººã«ã€Œç³–å°¿ç—…ã£ã¦ç”˜ãˆã€ã£ã¦è¨€ã‚ã‚ŒãŸã€‚è¨±ã›ãªã„", "2026-02-12 12:00"),
    (86, 85, "ãã‚Œã¯ã²ã©ã™ãŽã‚‹ã€‚ç„¡çŸ¥ã«ã‚‚ç¨‹ãŒã‚ã‚‹", "2026-02-12 12:30"),
    (87, 85, "ãƒ‘ãƒ¯ãƒãƒ©ã˜ã‚ƒãªã„ã§ã™ã‹ï¼Ÿè¨˜éŒ²ã—ã¦ãŠã„ãŸæ–¹ãŒã„ã„", "2026-02-12 13:00"),
    (88, None, "ä»Šæ—¥ã®æ¤œæŸ»ã€HbA1cä¸ŠãŒã£ã¦ãŸã€‚ã‚·ãƒ§ãƒƒã‚¯â€¦", "2026-02-14 16:00"),
    (89, 88, "æ¬¡ãŒã‚ã‚Šã¾ã™ã‚ˆã€‚ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†", "2026-02-14 16:30"),
    (90, None, "å¤œä¸­ã«ä½Žè¡€ç³–ã§ç›®ãŒè¦šã‚ãŸã€‚æ€–ã‹ã£ãŸ", "2026-02-17 08:00"),
    (91, 90, "å¤§ä¸ˆå¤«ã§ã—ãŸã‹ï¼Ÿæž•å…ƒã«ãƒ–ãƒ‰ã‚¦ç³–ç½®ã„ã¦ã¾ã™", "2026-02-17 08:30"),
    (92, None, "æ¯Žæ—¥è–¬é£²ã‚€ã®é¢å€’ã€‚ã§ã‚‚ã‚„ã‚ã‚‰ã‚Œãªã„", "2026-02-19 20:00"),
    (93, 92, "ã‚ã‹ã‚Šã¾ã™ã€‚ç¿’æ…£ã«ãªã‚‹ã¾ã§å¤§å¤‰ã§ã™ã‚ˆã­", "2026-02-19 20:30"),
    (94, None, "å¤–é£Ÿã§ãã‚‹åº—ãŒé™ã‚‰ã‚Œã¦ã¦æ‚²ã—ã„", "2026-02-21 12:00"),
    (95, 94, "ç³–è³ªè¡¨ç¤ºã—ã¦ãã‚Œã‚‹åº—å¢—ãˆã¦ã»ã—ã„ã§ã™ã‚ˆã­", "2026-02-21 12:30"),
    (96, None, "ãƒªãƒ–ãƒ¬ã®ã‚»ãƒ³ã‚µãƒ¼ã€æœã«å¼•ã£ã‹ã‹ã£ã¦å–ã‚ŒãŸã€‚é«˜ã„ã®ã«", "2026-02-22 19:00"),
    (97, 96, "ãã‚Œæœ€æ‚ªã§ã™ã‚ˆã­â€¦ã€‚ç§ã‚‚ã‚„ã£ãŸã“ã¨ã‚ã‚‹", "2026-02-22 19:30"),
    (98, None, "ä¸€ç”Ÿã“ã®ç—…æ°—ã¨ä»˜ãåˆã†ã®ã‹â€¦ã¨æ€ã†ã¨é‡ã„", "2026-02-24 21:00"),
    (99, 98, "ã§ã‚‚ä»²é–“ãŒã„ã¾ã™ã‚ˆã€‚ä¸€äººã˜ã‚ƒãªã„", "2026-02-24 21:30"),
    (100, 98, "åŒ»ç™‚ã‚‚é€²æ­©ã—ã¦ã‚‹ã—ã€ãã£ã¨è‰¯ããªã‚Šã¾ã™ã‚ˆ", "2026-02-24 22:00"),
    (101, None, "ä»Šæ—¥ã‚‚æ„šç—´èžã„ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†", "2026-02-25 20:00"),
    (102, 101, "ãŠäº’ã„æ§˜ã§ã™ï¼åãå‡ºã™ã®å¤§äº‹", "2026-02-25 20:30"),
    (103, None, "æ˜Žæ—¥æ¤œæŸ»ã€‚ç·Šå¼µã—ã¦çœ ã‚Œãªã„", "2026-02-26 23:00"),
    (104, 103, "å¤§ä¸ˆå¤«ã§ã™ã‚ˆã€‚çµæžœå ±å‘Šå¾…ã£ã¦ã¾ã™", "2026-02-26 23:30"),
    (105, None, "ã“ã®ã‚¹ãƒ¬ã‚ã£ã¦ã‚ˆã‹ã£ãŸã€‚ä¸€äººã§æŠ±ãˆè¾¼ã¾ãªãã¦ã„ã„", "2026-02-27 19:00"),
    (106, 105, "æœ¬å½“ã«ãã†ã€‚ã“ã“ã§æ•‘ã‚ã‚Œã¦ã¾ã™", "2026-02-27 19:30"),
    (107, None, "æ„šç—´è¨€ã„åˆãˆã‚‹ä»²é–“ãŒã„ã‚‹ã£ã¦å¹¸ã›", "2026-02-28 10:00"),
    (108, 107, "ãƒªã‚¢ãƒ«ã§ã¯è¨€ãˆãªã„ã“ã¨ã‚‚è¨€ãˆã¾ã™ã‚‚ã‚“ã­", "2026-02-28 10:30"),
    (109, None, "3æœˆã‚‚å¼•ãç¶šãæ„šç—´åãå‡ºã—ã¦ã„ãã¾ã—ã‚‡ã†", "2026-02-28 19:00"),
    (110, 109, "ã¯ã„ï¼æºœã‚è¾¼ã‚€ã®ã¯è‰¯ããªã„ã§ã™ã‚‚ã‚“ã­", "2026-02-28 19:30"),
    (111, None, "ã¿ã‚“ãªã®ãŠã‹ã’ã§é ‘å¼µã‚Œã¦ã¾ã™ã€‚ã‚ã‚ŠãŒã¨ã†", "2026-02-28 21:00"),
    (112, 111, "ã“ã¡ã‚‰ã“ãï¼ã“ã‚Œã‹ã‚‰ã‚‚ã‚ˆã‚ã—ãðŸ’ª", "2026-02-28 21:30"),
]

def jst_to_utc(jst_str):
    dt = datetime.strptime(jst_str, "%Y-%m-%d %H:%M")
    dt_utc = dt - timedelta(hours=9)
    return dt_utc.strftime("%Y-%m-%dT%H:%M:%S+00:00")

def assign_user_ids(comments):
    user_map = {}
    user_idx = 0
    for num, reply_to, body, dt in comments:
        if reply_to and reply_to in user_map:
            parent_user = user_map[reply_to]
            candidate = USERS[user_idx % len(USERS)]
            while candidate == parent_user:
                user_idx += 1
                candidate = USERS[user_idx % len(USERS)]
            user_map[num] = candidate
            user_idx += 1
        else:
            user_map[num] = USERS[user_idx % len(USERS)]
            user_idx += 1
    return user_map

def insert_batch(records, batch_num):
    url = f"{SUPABASE_URL}/rest/v1/comments"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps(records).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="POST")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Batch {batch_num}: {resp.status} - {len(records)} records inserted")
            return True
    except urllib.error.HTTPError as e:
        print(f"  Batch {batch_num}: ERROR {e.code} - {e.read().decode()}")
        return False

def main():
    print(f"Processing {len(COMMENTS)} comments for thread No.15")
    print(f"Thread ID: {THREAD_ID}")

    comment_uuids = {}
    for num, _, _, _ in COMMENTS:
        comment_uuids[num] = str(uuid.uuid4())

    user_map = assign_user_ids(COMMENTS)

    records = []
    now_utc = datetime.now(timezone.utc)
    past_count = 0
    future_count = 0

    for num, reply_to, body, dt_jst in COMMENTS:
        utc_str = jst_to_utc(dt_jst)
        dt_obj = datetime.strptime(dt_jst, "%Y-%m-%d %H:%M").replace(tzinfo=timezone(timedelta(hours=9)))
        if dt_obj > now_utc:
            future_count += 1
        else:
            past_count += 1

        parent_id = comment_uuids[reply_to] if reply_to else None
        record = {
            "id": comment_uuids[num],
            "thread_id": THREAD_ID,
            "body": body,
            "user_id": user_map[num],
            "is_hidden": False,
            "created_at": utc_str,
            "parent_id": parent_id,
        }
        records.append(record)

    print(f"Past comments: {past_count}")
    print(f"Future comments: {future_count}")
    print(f"Total: {len(records)}")
    print()

    BATCH_SIZE = 50
    for i in range(0, len(records), BATCH_SIZE):
        batch = records[i:i+BATCH_SIZE]
        batch_num = i // BATCH_SIZE + 1
        if not insert_batch(batch, batch_num):
            print("STOPPING due to error")
            return

    print(f"\nAll {len(records)} comments inserted!")

    print(f"\nUpdating comments_count to {past_count}...")
    url = f"{SUPABASE_URL}/rest/v1/threads?id=eq.{THREAD_ID}"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps({"comments_count": past_count}).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="PATCH")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Updated: {resp.status}")
    except urllib.error.HTTPError as e:
        print(f"  ERROR: {e.code} - {e.read().decode()}")

if __name__ == "__main__":
    main()
