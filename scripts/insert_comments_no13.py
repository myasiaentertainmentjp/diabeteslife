#!/usr/bin/env python3
"""Insert 130 comments for thread No.13: ãƒªãƒ–ãƒ¬ä½¿ã£ã¦ã‚‹äººé›†åˆï¼"""

import uuid
import json
import urllib.request
from datetime import datetime, timedelta

SUPABASE_URL = "https://josanlblwfjdaaezqbnw.supabase.co"
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impvc2FubGJsd2ZqZGFhZXpxYm53Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2Nzg0MjYwNiwiZXhwIjoyMDgzNDE4NjA2fQ.JlTXBmY5HJAqfRD_AazsiBORpgLZfB74fPkNyyfVSQY"

THREAD_ID = "817f4d09-e85c-4d09-a314-1b09c08f43be"
THREAD_OWNER_ID = "2033ee1c-28b2-5187-8ba1-c94f7964e33e"

# Dummy user pool (select diverse users)
USERS = [
    "b0000001-0000-0000-0000-000000000001",  # ã‚ˆã£ã—ãƒ¼
    "b0000001-0000-0000-0000-000000000002",  # ã¾ã‚†ã¿
    "b0000001-0000-0000-0000-000000000003",  # ãŸã‘ã—
    "b0000001-0000-0000-0000-000000000004",  # ã•ã¡ã“
    "b0000001-0000-0000-0000-000000000005",  # ã“ã†ãŸ
    "b0000001-0000-0000-0000-000000000006",  # ã‚†ã‹ã‚Š
    "b0000001-0000-0000-0000-000000000007",  # ã¾ã•ã²ã‚
    "b0000001-0000-0000-0000-000000000008",  # ã¨ã‚‚ã“
    "b0000001-0000-0000-0000-000000000009",  # ã—ã‚“ã˜
    "b0000001-0000-0000-0000-000000000010",  # ã²ã‚ã¿
    "b0000001-0000-0000-0000-000000000011",  # ã ã„ã™ã‘
    "b0000001-0000-0000-0000-000000000012",  # ã‚ã‘ã¿
    "b0000001-0000-0000-0000-000000000013",  # ã‘ã‚“ãŸ
    "b0000001-0000-0000-0000-000000000014",  # ã¿ã¡ã“
    "b0000001-0000-0000-0000-000000000015",  # ã‚Šã‚‡ã†ãŸ
    "f0000001-0000-0000-0000-000000000001",  # ã¿ãƒ¼ãƒžãƒž
    "f0000001-0000-0000-0000-000000000002",  # ã‚±ãƒ³ãƒ‘ãƒ‘
    "f0000001-0000-0000-0000-000000000005",  # ã‚†ã†ã“
    "f0000001-0000-0000-0000-000000000006",  # ã‘ã‚“ã˜
    "f0000001-0000-0000-0000-000000000009",  # ã²ãªã®
    "f0000001-0000-0000-0000-000000000010",  # ã¨ã—ã
    "f0000001-0000-0000-0000-000000000008",  # ã¾ã•ãŠ
    "f0000001-0000-0000-0000-000000000003",  # ã•ãã‚‰
    "f0000001-0000-0000-0000-000000000004",  # ãŸã£ãã‚“çˆ¶
    "b0000001-0000-0000-0000-000000000016",  # ãªãŠã“
    "b0000001-0000-0000-0000-000000000017",  # ã¦ã¤ã‚„
    "b0000001-0000-0000-0000-000000000018",  # ã‹ãšãˆ
    "b0000001-0000-0000-0000-000000000019",  # ã‚†ã†ã‚„
    "b0000001-0000-0000-0000-000000000020",  # ã‚Œã„ã“
    THREAD_OWNER_ID,  # Ash (thread owner)
]

# CSV data: (number, reply_to, body, datetime_jst)
COMMENTS = [
    (2, None, "ãƒªãƒ–ãƒ¬æ­´2å¹´ã§ã™ï¼ã‚‚ã†æ‰‹æ”¾ã›ãªã„", "2025-12-15 10:00"),
    (3, 2, "ç§ã‚‚ï¼æŒ‡å…ˆç©¿åˆºã«æˆ»ã‚Œãªã„ç¬‘", "2025-12-15 10:30"),
    (4, None, "æœ€è¿‘ãƒªãƒ–ãƒ¬å§‹ã‚ã¾ã—ãŸã€‚é£Ÿäº‹ã®å½±éŸ¿ãŒãƒªã‚¢ãƒ«ã«ã‚ã‹ã£ã¦è¡æ’ƒ", "2025-12-15 12:00"),
    (5, 4, "æœ€åˆã¯è¦‹ã™ãŽã¡ã‚ƒã„ã¾ã™ã‚ˆã­ç¬‘", "2025-12-15 12:30"),
    (6, None, "ã‚»ãƒ³ã‚µãƒ¼ã®ä»˜ã‘æ›¿ãˆã€è…•ã®ã©ã“ã«è²¼ã£ã¦ã¾ã™ã‹ï¼Ÿ", "2025-12-15 14:00"),
    (7, 6, "äºŒã®è…•ã®å¾Œã‚å´ã«è²¼ã£ã¦ã¾ã™ã€‚ç›®ç«‹ã¡ã«ãã„", "2025-12-15 14:30"),
    (8, 6, "ç§ã¯åˆ©ãè…•ã¨åå¯¾å´ã«ã—ã¦ã‚‹", "2025-12-15 15:00"),
    (9, None, "ãƒªãƒ–ãƒ¬2ã®ã‚¢ãƒ©ãƒ¼ãƒ æ©Ÿèƒ½ãŒç¥žã€‚ä½Žè¡€ç³–æ°—ã¥ã‘ã‚‹", "2025-12-15 18:00"),
    (10, 9, "å¤œä¸­ã®ä½Žè¡€ç³–ã‚¢ãƒ©ãƒ¼ãƒ ã§ä½•åº¦ã‚‚åŠ©ã‘ã‚‰ã‚ŒãŸ", "2025-12-15 18:30"),
    (11, None, "1åž‹ã§ã‚¤ãƒ³ã‚¹ãƒªãƒ³ä½¿ã£ã¦ã‚‹ã‹ã‚‰ãƒªãƒ–ãƒ¬å¿…é ˆ", "2025-12-15 19:00"),
    (12, 11, "1åž‹ã•ã‚“ã¯CGMå¤§äº‹ã§ã™ã‚ˆã­", "2025-12-15 19:30"),
    (13, None, "ã‚»ãƒ³ã‚µãƒ¼å¤–ã‚Œãã†ã«ãªã£ãŸæ™‚ã©ã†ã—ã¦ã¾ã™ï¼Ÿ", "2025-12-15 20:00"),
    (14, 13, "é˜²æ°´ãƒ†ãƒ¼ãƒ—è²¼ã£ã¦ã‚‹ã€‚100å‡ã®ã§OK", "2025-12-15 20:30"),
    (15, 13, "ç§ã¯ã‚·ãƒ ã‚¹ã¨ã„ã†å°‚ç”¨ãƒ†ãƒ¼ãƒ—ä½¿ã£ã¦ã¾ã™", "2025-12-15 21:00"),
    (16, None, "ãŠé¢¨å‘‚å…¥ã£ã¦ã‚‚å¤§ä¸ˆå¤«ãªã®æœ€é«˜", "2025-12-16 08:00"),
    (17, None, "ãƒªãƒ–ãƒ¬ã®èª¤å·®ã©ã®ãã‚‰ã„ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "2025-12-16 09:00"),
    (18, 17, "æŒ‡å…ˆã¨æ¯”ã¹ã‚‹ã¨10ã€œ20ãã‚‰ã„é•ã†æ™‚ã‚ã‚‹", "2025-12-16 09:30"),
    (19, 17, "ä½Žè¡€ç³–æ™‚ã¯èª¤å·®å¤§ãã„æ°—ãŒã™ã‚‹", "2025-12-16 10:00"),
    (20, None, "2åž‹ã§é£²ã¿è–¬ã ã‘ã©ã€ãƒªãƒ–ãƒ¬ã§é£Ÿå¾Œã®ä¸ŠãŒã‚Šæ–¹è¦‹ã¦é£Ÿäº‹æ”¹å–„ã§ããŸ", "2025-12-16 12:00"),
    (21, 20, "æ•°å€¤ãŒè¦‹ãˆã‚‹ã¨æ„è­˜å¤‰ã‚ã‚Šã¾ã™ã‚ˆã­", "2025-12-16 12:30"),
    (22, None, "ãƒªãƒ–ãƒ¬ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…ˆç”Ÿã«è¦‹ã›ãŸã‚‰è¤’ã‚ã‚‰ã‚ŒãŸ", "2025-12-16 15:00"),
    (23, 22, "ã‚°ãƒ©ãƒ•ã§èª¬æ˜Žã—ã‚„ã™ã„ã§ã™ã‚ˆã­", "2025-12-16 15:30"),
    (24, None, "ã‚»ãƒ³ã‚µãƒ¼1å€‹2é€±é–“ã€‚ã¡ã‚‡ã†ã©ã„ã„", "2025-12-16 19:00"),
    (25, None, "è²»ç”¨ãŒæ°—ã«ãªã‚‹â€¦ä¿é™ºé©ç”¨ã®æ¡ä»¶ã£ã¦ä½•ï¼Ÿ", "2025-12-16 19:30"),
    (26, 25, "ã‚¤ãƒ³ã‚¹ãƒªãƒ³ä½¿ã£ã¦ã‚‹ã¨ä¿é™ºé©ç”¨ã«ãªã‚Šã¾ã™ã‚ˆ", "2025-12-16 20:00"),
    (27, 25, "ç§ã¯è‡ªè²»ã§è²·ã£ã¦ã‚‹ã€‚æœˆ1ä¸‡ãã‚‰ã„", "2025-12-16 20:30"),
    (28, None, "ãƒªãƒ–ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ—ãƒªä½¿ã£ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2025-12-17 09:00"),
    (29, 28, "ä½¿ã£ã¦ã¾ã™ï¼ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãŒä¾¿åˆ©", "2025-12-17 09:30"),
    (30, None, "å¤ã¯æ±—ã§å‰¥ãŒã‚Œã‚„ã™ã„ã‘ã©å†¬ã¯å®‰å®šã—ã¦ã‚‹", "2025-12-17 12:00"),
    (31, None, "ã‚»ãƒ³ã‚µãƒ¼è£…ç€åˆæ—¥ã¯èª¤å·®å¤§ãããªã„ã§ã™ã‹ï¼Ÿ", "2025-12-17 14:00"),
    (32, 31, "1æ—¥ç›®ã¯å®‰å®šã—ãªã„ã“ã¨ã‚ã‚‹ã€‚2æ—¥ç›®ã‹ã‚‰ä¿¡é ¼ã—ã¦ã‚‹", "2025-12-17 14:30"),
    (33, None, "ãƒªãƒ–ãƒ¬ã§å¤œä¸­ã®è¡€ç³–å€¤è¦‹ãˆã‚‹ã‚ˆã†ã«ãªã£ã¦æšç¾è±¡ç™ºè¦šã—ãŸ", "2025-12-17 19:00"),
    (34, 33, "å¯ã¦ã‚‹é–“ã®å‹•ãè¦‹ãˆã‚‹ã®å¤§äº‹ã§ã™ã‚ˆã­", "2025-12-17 19:30"),
    (35, None, "GLP-1ã¨ãƒªãƒ–ãƒ¬ã®çµ„ã¿åˆã‚ã›ã§ç®¡ç†æ¥½ã«ãªã£ãŸ", "2025-12-17 20:00"),
    (36, None, "ãƒãƒ³ãƒ—ã¨é€£æºã§ãã‚‹ã¨ã„ã„ã®ã«ãª", "2025-12-18 10:00"),
    (37, 36, "Dexcomã¯ãƒãƒ³ãƒ—é€£æºã‚ã‚‹ã¿ãŸã„ã§ã™ã­", "2025-12-18 10:30"),
    (38, None, "ãƒªãƒ–ãƒ¬ã®çŸ¢å°â†‘â†‘ãŒå‡ºã‚‹ã¨ç„¦ã‚‹", "2025-12-18 12:00"),
    (39, 38, "æ€¥ä¸Šæ˜‡ã®çŸ¢å°è¦‹ã‚‹ã¨ã€Œä½•é£Ÿã¹ãŸï¼ï¼Ÿã€ã£ã¦ãªã‚‹ç¬‘", "2025-12-18 12:30"),
    (40, None, "ã‚»ãƒ³ã‚µãƒ¼ã¶ã¤ã‘ã¦å£Šã—ãŸã“ã¨ã‚ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2025-12-18 19:00"),
    (41, 40, "ãƒ‰ã‚¢æž ã«ã¶ã¤ã‘ã¦å–ã‚ŒãŸã“ã¨ã‚ã‚‹ðŸ˜­", "2025-12-18 19:30"),
    (42, 40, "ç§ã‚‚ä¸€åº¦ã‚„ã£ãŸã€‚é«˜ã„ã®ã«ã‚·ãƒ§ãƒƒã‚¯â€¦", "2025-12-18 20:00"),
    (43, None, "ãƒªãƒ–ãƒ¬è¦‹ã™ãŽã¦è¡€ç³–å€¤ã«æŒ¯ã‚Šå›žã•ã‚Œã‚‹æ™‚æœŸãŒã‚ã£ãŸ", "2025-12-19 09:00"),
    (44, 43, "ã‚ã‹ã‚‹ã€‚æœ€åˆã¯æ•°å€¤ã«ä¸€å–œä¸€æ†‚ã—ã¡ã‚ƒã†", "2025-12-19 09:30"),
    (45, None, "ä»Šã¯å‚¾å‘ã‚’è¦‹ã‚‹ã‚ˆã†ã«ã—ã¦ã‚‹ã€‚å¤šå°‘ã®ä¸Šä¸‹ã¯æ°—ã«ã—ãªã„", "2025-12-19 10:00"),
    (46, None, "åŠè¢–ã®å­£ç¯€ã€ã‚»ãƒ³ã‚µãƒ¼è¦‹ãˆã‚‹ã¨èžã‹ã‚Œã‚‹ã“ã¨ã‚ã‚‹", "2025-12-19 12:00"),
    (47, 46, "ã€Œãã‚Œä½•ï¼Ÿã€ã£ã¦èžã‹ã‚Œã‚‹ã®é¢å€’ã§ã™ã‚ˆã­", "2025-12-19 12:30"),
    (48, 46, "å†¬ã¯é•·è¢–ã ã‹ã‚‰éš ã›ã¦æ¥½", "2025-12-19 13:00"),
    (49, None, "ãƒªãƒ–ãƒ¬ã®ãŠã‹ã’ã§HbA1c 1%ä¸‹ãŒã£ãŸ", "2025-12-19 19:00"),
    (50, 49, "ã™ã”ã„ï¼è¦‹ãˆã‚‹åŒ–ã®åŠ¹æžœå¤§ãã„ã§ã™ã‚ˆã­", "2025-12-19 19:30"),
    (51, None, "50ä»£2åž‹ã€‚ãƒªãƒ–ãƒ¬å§‹ã‚ã¦3ãƒ¶æœˆã€‚ã‚‚ã£ã¨æ—©ãä½¿ãˆã°ã‚ˆã‹ã£ãŸ", "2025-12-20 10:00"),
    (52, 51, "ç§ã‚‚åŒã˜ã“ã¨æ€ã„ã¾ã—ãŸç¬‘", "2025-12-20 10:30"),
    (53, None, "ã‚¹ãƒžãƒ›ã§ã‚¹ã‚­ãƒ£ãƒ³ã§ãã‚‹ã®ä¾¿åˆ©ã€‚ãƒªãƒ¼ãƒ€ãƒ¼è¦ã‚‰ãªã„", "2025-12-20 14:00"),
    (54, 53, "iPhoneå¯¾å¿œã—ã¦ã‹ã‚‰æ›´ã«ä¾¿åˆ©ã«ãªã£ãŸ", "2025-12-20 14:30"),
    (55, None, "å¹´æœ«å¹´å§‹ã€ãƒªãƒ–ãƒ¬ã§é£Ÿã¹éŽãŽã‚’å¯è¦–åŒ–ã•ã‚Œã‚‹ã®æ€–ã„ç¬‘", "2025-12-21 19:00"),
    (56, 55, "ãŠæ­£æœˆã®ã‚°ãƒ©ãƒ•è¦‹ãŸããªã„ðŸ˜…", "2025-12-21 19:30"),
    (57, None, "ã‚»ãƒ³ã‚µãƒ¼ã®åœ¨åº«ã€å¹´æœ«å¹´å§‹åˆ†ç¢ºä¿ã—ãŸ", "2025-12-22 10:00"),
    (58, 57, "ç§ã‚‚ï¼ç—…é™¢ä¼‘ã¿ã«ãªã‚‹å‰ã«", "2025-12-22 10:30"),
    (59, None, "ãƒªãƒ–ãƒ¬ä»˜ã‘ã¦ã‹ã‚‰ãƒ‘ãƒ³ã‚’é¿ã‘ã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚ä¸ŠãŒã‚Šæ–¹ã‚¨ã‚°ã„ã‹ã‚‰", "2025-12-22 12:00"),
    (60, 59, "ãƒ‘ãƒ³ã®æ€¥ä¸Šæ˜‡è¦‹ã‚‹ã¨é£Ÿã¹ã‚‹æ°—å¤±ã›ã¾ã™ã‚ˆã­", "2025-12-22 12:30"),
    (61, None, "ã‚¯ãƒªã‚¹ãƒžã‚¹ã‚±ãƒ¼ã‚­ã€ãƒªãƒ–ãƒ¬ã§å®Ÿæ³ã—ãªãŒã‚‰é£Ÿã¹ãŸç¬‘", "2025-12-24 21:00"),
    (62, 61, "ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼ï¼çµæžœã©ã†ã§ã—ãŸï¼Ÿ", "2025-12-24 21:30"),
    (63, 62, "180è¶…ãˆãŸã‘ã©2æ™‚é–“ã§æˆ»ã£ãŸï¼", "2025-12-24 22:00"),
    (64, None, "ãŠé¤…é£Ÿã¹ãŸå¾Œã®ã‚°ãƒ©ãƒ•ãŒã™ã”ã„ã“ã¨ã«ãªã£ã¦ã‚‹", "2026-01-01 12:00"),
    (65, 64, "ãŠé¤…ã¯åˆ¥æ ¼ã§ã™ã‚ˆã­â€¦", "2026-01-01 12:30"),
    (66, None, "æ­£æœˆ3æ—¥é–“ã®ã‚°ãƒ©ãƒ•ã€å±±è„ˆã¿ãŸã„ã«ãªã£ã¦ã‚‹", "2026-01-03 20:00"),
    (67, 66, "ã‚ã‹ã‚‹ç¬‘ ç§ã‚‚è¦‹ã‚‹ã®ãŒæ€–ã„", "2026-01-03 20:30"),
    (68, None, "æ–°å¹´ã‹ã‚‰ã‚»ãƒ³ã‚µãƒ¼æ–°ã—ãã—ãŸã€‚æ°—æŒã¡ã‚‚æ–°ãŸã«", "2026-01-04 09:00"),
    (69, None, "ãƒªãƒ–ãƒ¬ã®TIRï¼ˆç¯„å›²å†…æ™‚é–“ï¼‰ã‚’æ„è­˜ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚‹", "2026-01-06 14:00"),
    (70, 69, "70%ä»¥ä¸Šã‚’ç›®æŒ‡ã—ã¦ã¾ã™", "2026-01-06 14:30"),
    (71, None, "ã‚»ãƒ³ã‚µãƒ¼ä»˜ã‘æ›¿ãˆã®æ™‚ã€å‰ã®ã‚»ãƒ³ã‚µãƒ¼ã®æœ€çµ‚ãƒ‡ãƒ¼ã‚¿è¦‹ã‚‹ã®åˆ‡ãªã„", "2026-01-08 10:00"),
    (72, 71, "2é€±é–“ã®è¨˜éŒ²ã€ãŠç–²ã‚Œæ§˜ã£ã¦æ„Ÿã˜ç¬‘", "2026-01-08 10:30"),
    (73, None, "ãƒªãƒ–ãƒ¬ã§é‹å‹•ã®åŠ¹æžœã‚‚è¦‹ãˆã‚‹ã€‚æ­©ãã¨ä¸‹ãŒã‚‹", "2026-01-10 19:00"),
    (74, 73, "é£Ÿå¾Œã«æ•£æ­©ã™ã‚‹ã¨çŸ¢å°ãŒä¸‹å‘ãã®è¦‹ãˆã¾ã™ã‚ˆã­", "2026-01-10 19:30"),
    (75, None, "ã‚¤ãƒ³ã‚¹ãƒªãƒ³ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°èª¿æ•´ã«ãƒªãƒ–ãƒ¬æ´»ç”¨ã—ã¦ã‚‹", "2026-01-12 15:00"),
    (76, 75, "1åž‹ã•ã‚“ã¯ç‰¹ã«é‡è¦ã§ã™ã‚ˆã­", "2026-01-12 15:30"),
    (77, None, "ãƒªãƒ–ãƒ¬ãªã—ã®ç”Ÿæ´»ã‚‚ã†è€ƒãˆã‚‰ã‚Œãªã„", "2026-01-15 12:00"),
    (78, 77, "åŒæ„Ÿã§ã™ã€‚ãªããªã£ãŸã‚‰å›°ã‚‹", "2026-01-15 12:30"),
    (79, None, "ã‚»ãƒ³ã‚µãƒ¼ã«ã‹ã¶ã‚Œã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2026-01-17 09:00"),
    (80, 79, "ç§ã‹ã¶ã‚Œã¾ã™ã€‚ä¸‹ã«ã‚­ã‚ºãƒ‘ãƒ¯ãƒ¼ãƒ‘ãƒƒãƒ‰è²¼ã£ã¦ã‹ã‚‰ä»˜ã‘ã¦ã‚‹", "2026-01-17 09:30"),
    (81, 79, "ã‚¹ã‚­ãƒ³ã‚¿ãƒƒã‚¯ã¨ã„ã†ãƒãƒªã‚¢å‰¤ãŠã™ã™ã‚ã§ã™", "2026-01-17 10:00"),
    (82, None, "ãƒªãƒ–ãƒ¬3ãŒå‡ºãŸã‚‰è²·ã„æ›¿ãˆãŸã„", "2026-01-19 14:00"),
    (83, 82, "æ—¥æœ¬ç™ºå£²ã„ã¤ã«ãªã‚‹ã‚“ã§ã™ã‹ã­", "2026-01-19 14:30"),
    (84, None, "60ä»£ã§ãƒªãƒ–ãƒ¬ãƒ‡ãƒ“ãƒ¥ãƒ¼ã—ã¾ã—ãŸã€‚å¨˜ã«è¨­å®šã—ã¦ã‚‚ã‚‰ã£ãŸ", "2026-01-22 10:00"),
    (85, 84, "ã„ãã¤ã«ãªã£ã¦ã‚‚æ–°ã—ã„ã“ã¨å§‹ã‚ã‚‰ã‚Œã¾ã™ã­ï¼", "2026-01-22 10:30"),
    (86, None, "é£›è¡Œæ©Ÿä¹—ã‚‹æ™‚ã€ã‚»ãƒ³ã‚µãƒ¼ç”³å‘Šã—ãŸæ–¹ãŒã„ã„ï¼Ÿ", "2026-01-24 19:00"),
    (87, 86, "ç§ã¯ç‰¹ã«ä½•ã‚‚è¨€ã‚ãšã«é€šã‚Œã¾ã—ãŸ", "2026-01-24 19:30"),
    (88, 86, "å¿µã®ãŸã‚è¨ºæ–­æ›¸æŒã£ã¦ã„ãã¨å®‰å¿ƒã‹ã‚‚", "2026-01-24 20:00"),
    (89, None, "MRIæ’®ã‚‹æ™‚ã¯ã‚»ãƒ³ã‚µãƒ¼å¤–ã•ãªã„ã¨ãƒ€ãƒ¡ãªã‚“ã§ã™ã‚ˆã­", "2026-01-27 11:00"),
    (90, 89, "ãã†ã€é‡‘å±žå…¥ã£ã¦ã‚‹ã‹ã‚‰ã€‚ã‚‚ã£ãŸã„ãªã„ã‘ã©ä»•æ–¹ãªã„", "2026-01-27 11:30"),
    # Future comments (after 2026-01-28)
    (91, None, "ä½Žè¡€ç³–ã®ã‚¢ãƒ©ãƒ¼ãƒ ã§å¤œä¸­èµ·ããŸã€‚55ã ã£ãŸðŸ’¦", "2026-01-29 08:00"),
    (92, 91, "ã‚¢ãƒ©ãƒ¼ãƒ ãªã‹ã£ãŸã‚‰æ°—ã¥ã‹ãªã‹ã£ãŸã‹ã‚‚ã€‚å‘½ç¶±ã§ã™ã­", "2026-01-29 08:30"),
    (93, None, "å¢ƒç•Œåž‹ã ã‘ã©è‡ªè²»ã§ãƒªãƒ–ãƒ¬ä½¿ã£ã¦ã‚‹ã€‚äºˆé˜²ã®ãŸã‚", "2026-01-31 14:00"),
    (94, 93, "æ„è­˜é«˜ã„ï¼ç§ã‚‚å¢ƒç•Œåž‹ã®æ™‚ã«ä½¿ã„ãŸã‹ã£ãŸ", "2026-01-31 14:30"),
    (95, None, "2æœˆã«ãªã£ãŸã€‚ä»Šæœˆã‚‚ãƒªãƒ–ãƒ¬ã¨å…±ã«é ‘å¼µã‚‹", "2026-02-01 09:00"),
    (96, None, "ã‚¹ãƒˆãƒ¬ã‚¹ã§è¡€ç³–å€¤ä¸ŠãŒã‚‹ã®ã‚‚ãƒªãƒ–ãƒ¬ã§è¨¼æ˜Žã•ã‚ŒãŸ", "2026-02-03 19:00"),
    (97, 96, "ä»•äº‹ä¸­ã«æ€¥ä¸Šæ˜‡ã—ã¦ã‚‹ã®è¦‹ãˆã¾ã™ã‚ˆã­", "2026-02-03 19:30"),
    (98, None, "ã‚»ãƒ³ã‚µãƒ¼äº¤æ›æ—¥ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«å…¥ã‚Œã¦ã‚‹", "2026-02-05 10:00"),
    (99, 98, "å¿˜ã‚Œã‚‹ã¨åˆ‡ã‚Œã¡ã‚ƒã†ã‚‚ã‚“ã­", "2026-02-05 10:30"),
    (100, None, "100ã‚³ãƒ¡ãƒ³ãƒˆï¼ãƒªãƒ–ãƒ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼å¤šã„ã­", "2026-02-07 20:00"),
    (101, 100, "ä»²é–“ãŒã„ã¦å¿ƒå¼·ã„", "2026-02-07 20:30"),
    (102, None, "å¯è¿”ã‚Šã§ã‚»ãƒ³ã‚µãƒ¼åœ§è¿«ã™ã‚‹ã¨æ•°å€¤ãŠã‹ã—ããªã‚‹", "2026-02-10 08:00"),
    (103, 102, "åœ§è¿«ä½Žè¡€ç³–ã£ã¦ã‚„ã¤ã§ã™ã­ã€‚å®Ÿéš›ã¯ä½Žããªã„", "2026-02-10 08:30"),
    (104, None, "ãƒªãƒ–ãƒ¬ã®ãƒ‡ãƒ¼ã‚¿ã€å®¶æ—ã¨å…±æœ‰ã—ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2026-02-12 14:00"),
    (105, 104, "å¤«ã¨å…±æœ‰ã—ã¦ã¾ã™ã€‚ä½Žè¡€ç³–æ™‚ã«æ°—ã¥ã„ã¦ã‚‚ã‚‰ãˆã‚‹", "2026-02-12 14:30"),
    (106, None, "ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ã®ãƒãƒ§ã‚³ã€ãƒªãƒ–ãƒ¬ã§ç›£è¦–ã—ãªãŒã‚‰é£Ÿã¹ãŸ", "2026-02-14 20:00"),
    (107, 106, "é«˜ã‚«ã‚«ã‚ªã«ã—ãŸã‚‰æ„å¤–ã¨ä¸ŠãŒã‚‰ãªã‹ã£ãŸï¼", "2026-02-14 20:30"),
    (108, None, "ãƒªãƒ–ãƒ¬ä½¿ã„å§‹ã‚ã¦1å¹´è¨˜å¿µæ—¥", "2026-02-17 10:00"),
    (109, 108, "ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼1å¹´ã®ãƒ‡ãƒ¼ã‚¿è²´é‡ã§ã™ã­", "2026-02-17 10:30"),
    (110, None, "é£Ÿäº‹ã¨è¡€ç³–å€¤ã®ç›¸é–¢ãŒãƒ‡ãƒ¼ã‚¿ã§è¦‹ãˆã‚‹ã®ãŒæœ¬å½“ã«ã‚ã‚ŠãŒãŸã„", "2026-02-19 12:00"),
    (111, 110, "è‡ªåˆ†ã®ä½“ã®åå¿œãŒã‚ã‹ã‚Šã¾ã™ã‚ˆã­", "2026-02-19 12:30"),
    (112, None, "æŒ‡å…ˆç©¿åˆºã¯æœˆã«æ•°å›žã€ç¢ºèªç”¨ã«ä½¿ã£ã¦ã‚‹", "2026-02-21 09:00"),
    (113, 112, "èª¤å·®ãƒã‚§ãƒƒã‚¯å¤§äº‹ã§ã™ã‚ˆã­", "2026-02-21 09:30"),
    (114, None, "Dexcomã¨è¿·ã£ãŸã‘ã©ãƒªãƒ–ãƒ¬ã«ã—ãŸã€‚è²»ç”¨çš„ã«", "2026-02-22 19:00"),
    (115, 114, "Dexcomã¯é«˜ã„ã§ã™ã‚‚ã‚“ã­ã€‚ãƒªãƒ–ãƒ¬ã§ååˆ†ã‹ã‚‚", "2026-02-22 19:30"),
    (116, None, "30ä»£ã§ãƒªãƒ–ãƒ¬ä½¿ã£ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿè‹¥ã„ã¨çã—ã„ï¼Ÿ", "2026-02-24 14:00"),
    (117, 116, "30ä»£1åž‹ã§ã™ã€‚ç§ã‚‚ä½¿ã£ã¦ã¾ã™ã‚ˆï¼", "2026-02-24 14:30"),
    (118, 116, "20ä»£2åž‹ã§ã™ãŒãƒªãƒ–ãƒ¬ä½¿ã£ã¦ã¾ã™", "2026-02-24 15:00"),
    (119, None, "AGPï¼ˆå¹³å‡è¡€ç³–ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®ã‚°ãƒ©ãƒ•è¦‹ã‚‹ã¨å‚¾å‘ã‚ã‹ã‚‹", "2026-02-25 10:00"),
    (120, 119, "å…ˆç”Ÿã‚‚AGPã§èª¬æ˜Žã—ã¦ãã‚Œã¾ã™", "2026-02-25 10:30"),
    (121, None, "ãƒªãƒ–ãƒ¬ã®ãŠã‹ã’ã§ç³–å°¿ç—…ã¨å‘ãåˆãˆã‚‹ã‚ˆã†ã«ãªã£ãŸ", "2026-02-26 19:00"),
    (122, 121, "è¦‹ãˆã‚‹åŒ–ã§æ„è­˜ãŒå¤‰ã‚ã‚Šã¾ã™ã‚ˆã­", "2026-02-26 19:30"),
    (123, None, "ä»Šæœˆã®TIR 75%é”æˆï¼", "2026-02-27 20:00"),
    (124, 123, "ã™ã”ã„ï¼ç›®æ¨™é”æˆãŠã‚ã§ã¨ã†ðŸŽ‰", "2026-02-27 20:30"),
    (125, None, "æ¥æœˆã‚‚å¼•ãç¶šããƒªãƒ–ãƒ¬ç”Ÿæ´»", "2026-02-28 10:00"),
    (126, 125, "ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼", "2026-02-28 10:30"),
    (127, None, "ã“ã®ã‚¹ãƒ¬ã§ãƒªãƒ–ãƒ¬ã®æƒ…å ±äº¤æ›ã§ãã¦ã‚ã‚ŠãŒãŸã„", "2026-02-28 19:00"),
    (128, 127, "åŒæ„Ÿã§ã™ï¼çŸ¥ã‚‰ãªã„æƒ…å ±ãŸãã•ã‚“ã‚ã£ãŸ", "2026-02-28 19:30"),
    (129, None, "3æœˆã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™", "2026-02-28 21:00"),
    (130, 129, "ã“ã¡ã‚‰ã“ãï¼ãƒªãƒ–ãƒ¬ä»²é–“ã§ã“ã‚Œã‹ã‚‰ã‚‚ðŸ’ª", "2026-02-28 21:30"),
    (131, None, "ã¾ãŸä½•ã‹ã‚ã£ãŸã‚‰å ±å‘Šã—ã¾ã™ã­ï¼", "2026-02-28 22:00"),
]

def jst_to_utc(jst_str):
    """Convert JST datetime string to UTC ISO format"""
    dt = datetime.strptime(jst_str, "%Y-%m-%d %H:%M")
    dt_utc = dt - timedelta(hours=9)
    return dt_utc.strftime("%Y-%m-%dT%H:%M:%S+00:00")

def assign_user_ids(comments):
    """Assign user_ids to comments, keeping conversation consistency"""
    user_map = {}
    user_idx = 0

    for num, reply_to, body, dt in comments:
        if reply_to and reply_to in user_map:
            parent_user = user_map[reply_to]
            candidate = USERS[user_idx % len(USERS)]
            while candidate == parent_user:
                user_idx += 1
                candidate = USERS[user_idx % len(USERS)]
            user_map[num] = candidate
            user_idx += 1
        else:
            user_map[num] = USERS[user_idx % len(USERS)]
            user_idx += 1

    return user_map

def insert_batch(records, batch_num):
    """Insert a batch of records via REST API"""
    url = f"{SUPABASE_URL}/rest/v1/comments"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }

    data = json.dumps(records).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="POST")

    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Batch {batch_num}: {resp.status} - {len(records)} records inserted")
            return True
    except urllib.error.HTTPError as e:
        print(f"  Batch {batch_num}: ERROR {e.code} - {e.read().decode()}")
        return False

def main():
    print(f"Processing {len(COMMENTS)} comments for thread No.13")
    print(f"Thread ID: {THREAD_ID}")

    # Generate UUIDs for each comment
    comment_uuids = {}
    for num, _, _, _ in COMMENTS:
        comment_uuids[num] = str(uuid.uuid4())

    # Assign user IDs
    user_map = assign_user_ids(COMMENTS)

    # Build records
    records = []
    now_utc = datetime.utcnow()
    past_count = 0
    future_count = 0

    for num, reply_to, body, dt_jst in COMMENTS:
        utc_str = jst_to_utc(dt_jst)
        dt_obj = datetime.strptime(dt_jst, "%Y-%m-%d %H:%M") - timedelta(hours=9)

        is_future = dt_obj > now_utc
        if is_future:
            future_count += 1
        else:
            past_count += 1

        parent_id = comment_uuids[reply_to] if reply_to else None

        record = {
            "id": comment_uuids[num],
            "thread_id": THREAD_ID,
            "body": body,
            "user_id": user_map[num],
            "is_hidden": False,
            "created_at": utc_str,
            "parent_id": parent_id,
        }

        records.append(record)

    print(f"Past comments: {past_count}")
    print(f"Future comments: {future_count}")
    print(f"Total: {len(records)}")
    print()

    # Insert in batches of 50
    BATCH_SIZE = 50
    for i in range(0, len(records), BATCH_SIZE):
        batch = records[i:i+BATCH_SIZE]
        batch_num = i // BATCH_SIZE + 1
        success = insert_batch(batch, batch_num)
        if not success:
            print("STOPPING due to error")
            return

    print(f"\nAll {len(records)} comments inserted!")

    # Update comments_count on thread
    print(f"\nUpdating comments_count to {past_count}...")
    url = f"{SUPABASE_URL}/rest/v1/threads?id=eq.{THREAD_ID}"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps({"comments_count": past_count}).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="PATCH")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Updated: {resp.status}")
    except urllib.error.HTTPError as e:
        print(f"  ERROR: {e.code} - {e.read().decode()}")

if __name__ == "__main__":
    main()
