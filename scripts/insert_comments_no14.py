#!/usr/bin/env python3
"""Insert 145 comments for thread No.14: ç³–è³ªåˆ¶é™ã—ã¦ã‚‹äººã€ä½•é£Ÿã¹ã¦ã‚‹ï¼Ÿ"""

import uuid
import json
import urllib.request
from datetime import datetime, timedelta

SUPABASE_URL = "https://josanlblwfjdaaezqbnw.supabase.co"
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impvc2FubGJsd2ZqZGFhZXpxYm53Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2Nzg0MjYwNiwiZXhwIjoyMDgzNDE4NjA2fQ.JlTXBmY5HJAqfRD_AazsiBORpgLZfB74fPkNyyfVSQY"

THREAD_ID = "668402a5-2089-4fac-90b1-7840d63130ae"
THREAD_OWNER_ID = "2033ee1c-28b2-5187-8ba1-c94f7964e33e"

USERS = [
    "b0000001-0000-0000-0000-000000000001",
    "b0000001-0000-0000-0000-000000000002",
    "b0000001-0000-0000-0000-000000000003",
    "b0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000005",
    "b0000001-0000-0000-0000-000000000006",
    "b0000001-0000-0000-0000-000000000007",
    "b0000001-0000-0000-0000-000000000008",
    "b0000001-0000-0000-0000-000000000009",
    "b0000001-0000-0000-0000-000000000010",
    "b0000001-0000-0000-0000-000000000011",
    "b0000001-0000-0000-0000-000000000012",
    "b0000001-0000-0000-0000-000000000013",
    "b0000001-0000-0000-0000-000000000014",
    "b0000001-0000-0000-0000-000000000015",
    "f0000001-0000-0000-0000-000000000001",
    "f0000001-0000-0000-0000-000000000002",
    "f0000001-0000-0000-0000-000000000005",
    "f0000001-0000-0000-0000-000000000006",
    "f0000001-0000-0000-0000-000000000009",
    "f0000001-0000-0000-0000-000000000010",
    "f0000001-0000-0000-0000-000000000008",
    "f0000001-0000-0000-0000-000000000003",
    "f0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000016",
    "b0000001-0000-0000-0000-000000000017",
    "b0000001-0000-0000-0000-000000000018",
    "b0000001-0000-0000-0000-000000000019",
    "b0000001-0000-0000-0000-000000000020",
    THREAD_OWNER_ID,
]

COMMENTS = [
    (2, None, "ç³–è³ªåˆ¶é™3å¹´ç›®ã€‚æœã¯ã‚†ã§åµã¨ãƒãƒ¼ã‚ºãŒå®šç•ª", "2025-12-15 08:00"),
    (3, 2, "ç§ã‚‚æœã¯åµï¼ç°¡å˜ã§ç³–è³ªã‚¼ãƒ­ã«è¿‘ã„", "2025-12-15 08:30"),
    (4, None, "ã‚ªãƒ¼ãƒˆãƒŸãƒ¼ãƒ«30gã§ãŠç²¥é¢¨ã«ã—ã¦ã‚‹ã€‚è¡€ç³–å€¤ä¸ŠãŒã‚Šã«ãã„", "2025-12-15 09:00"),
    (5, 4, "ã‚ªãƒ¼ãƒˆãƒŸãƒ¼ãƒ«æ°—ã«ãªã£ã¦ãŸï¼è©¦ã—ã¦ã¿ã¾ã™", "2025-12-15 09:30"),
    (6, None, "ã“ã‚“ã«ã‚ƒãéººãŒä¸»é£Ÿã«ãªã‚Šã¤ã¤ã‚ã‚‹", "2025-12-15 12:00"),
    (7, 6, "ã“ã‚“ã«ã‚ƒãéººç¾Žå‘³ã—ã„ã§ã™ã‹ï¼Ÿé£Ÿæ„ŸãŒæ°—ã«ãªã‚‹", "2025-12-15 12:30"),
    (8, 7, "æœ€åˆã¯é•å’Œæ„Ÿã‚ã£ãŸã‘ã©æ…£ã‚ŒãŸï¼ç„¼ããã°é¢¨ãŒãŠã™ã™ã‚", "2025-12-15 13:00"),
    (9, None, "ãƒ–ãƒ­ãƒƒã‚³ãƒªãƒ¼ã‚’ç±³ä»£ã‚ã‚Šã«ã—ã¦ã‚‹ã€‚ãƒ–ãƒ­ãƒƒã‚³ãƒªãƒ¼ãƒ©ã‚¤ã‚¹", "2025-12-15 14:00"),
    (10, 9, "ã‚«ãƒªãƒ•ãƒ©ãƒ¯ãƒ¼ãƒ©ã‚¤ã‚¹ã‚‚è‰¯ã„ã§ã™ã‚ˆï¼", "2025-12-15 14:30"),
    (11, None, "ã‚µãƒ©ãƒ€ãƒã‚­ãƒ³ã«é ¼ã‚Šã™ãŽã¦ã‚‹ã€‚é£½ãã¦ããŸ", "2025-12-15 18:00"),
    (12, 11, "å‘³å¤‰ã§ãƒãƒ¼ãƒ–ã‚½ãƒ«ãƒˆã¨ã‹è©¦ã—ã¦ã¿ã¦ã¯ï¼Ÿ", "2025-12-15 18:30"),
    (13, None, "åŽšæšã’ç„¼ã„ã¦ç”Ÿå§œé†¤æ²¹ã§é£Ÿã¹ã‚‹ã®å¥½ã", "2025-12-15 19:00"),
    (14, 13, "åŽšæšã’è‰¯ã„ã§ã™ã‚ˆã­ï¼ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚ã‚‹ã—", "2025-12-15 19:30"),
    (15, None, "ä½Žç³–è³ªãƒ‘ãƒ³ã€ã©ã“ã®ãŒãŠã™ã™ã‚ã§ã™ã‹ï¼Ÿ", "2025-12-15 20:00"),
    (16, 15, "ã‚·ãƒ£ãƒˆãƒ¬ãƒ¼ã‚¼ã®ç³–è³ªã‚«ãƒƒãƒˆãƒ‘ãƒ³ãŒç¾Žå‘³ã—ã„", "2025-12-15 20:30"),
    (17, 15, "ãƒ­ãƒ¼ã‚½ãƒ³ã®ãƒ–ãƒ©ãƒ³ãƒ‘ãƒ³ã‚‚å®šç•ªã§ã™ã­", "2025-12-15 21:00"),
    (18, None, "2åž‹ã§é£Ÿäº‹ç™‚æ³•ãƒ¡ã‚¤ãƒ³ã€‚1æ—¥ç³–è³ª100gä»¥ä¸‹ã‚’ç›®æ¨™ã«ã—ã¦ã‚‹", "2025-12-16 08:00"),
    (19, 18, "100gã£ã¦çµæ§‹åŽ³ã—ããªã„ã§ã™ã‹ï¼Ÿ", "2025-12-16 08:30"),
    (20, 19, "æœ€åˆã¯ãã¤ã‹ã£ãŸã‘ã©æ…£ã‚Œã¾ã—ãŸ", "2025-12-16 09:00"),
    (21, None, "è±†è…ã‚’è‰²ã€…ã‚¢ãƒ¬ãƒ³ã‚¸ã—ã¦ã‚‹ã€‚éº»å©†è±†è…ã¨ã‹", "2025-12-16 12:00"),
    (22, 21, "è±†è…ã‚¹ãƒ†ãƒ¼ã‚­ã‚‚ãŠã™ã™ã‚ï¼", "2025-12-16 12:30"),
    (23, None, "ã‚‚ã‚„ã—æœ€å¼·èª¬ã€‚å®‰ã„ã—ç³–è³ªä½Žã„", "2025-12-16 14:00"),
    (24, 23, "ã‚‚ã‚„ã—ç‚’ã‚æ¯Žæ—¥é£Ÿã¹ã¦ã‚‹ç¬‘", "2025-12-16 14:30"),
    (25, None, "ãŠã‚„ã¤ã¯ãƒŠãƒƒãƒ„ã«ã—ã¦ã‚‹ã€‚ã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰ã¨ãã‚‹ã¿", "2025-12-16 15:00"),
    (26, 25, "ãƒŠãƒƒãƒ„ã¯è„‚è³ªé«˜ã„ã‹ã‚‰é£Ÿã¹ã™ãŽæ³¨æ„ã§ã™ã‚ˆã­", "2025-12-16 15:30"),
    (27, None, "ãƒãƒ¼ã‚ºãŒé–“é£Ÿã«æœ€é©ã€‚ç³–è³ªã»ã¼ã‚¼ãƒ­", "2025-12-16 19:00"),
    (28, 27, "6Pãƒãƒ¼ã‚ºå¸¸å‚™ã—ã¦ã¾ã™", "2025-12-16 19:30"),
    (29, None, "ç³–è³ªã‚¼ãƒ­éººã§ãƒ‘ã‚¹ã‚¿é¢¨ä½œã£ãŸã€‚ãƒˆãƒžãƒˆã‚½ãƒ¼ã‚¹ã§", "2025-12-16 20:00"),
    (30, 29, "ç³–è³ªã‚¼ãƒ­éººã€ç´€æ–‡ã®ã‚„ã¤ã§ã™ã‹ï¼Ÿ", "2025-12-16 20:30"),
    (31, 30, "ãã†ã§ã™ï¼å¹³éººã‚¿ã‚¤ãƒ—ãŒãƒ‘ã‚¹ã‚¿ã«åˆã†", "2025-12-16 21:00"),
    (32, None, "é¶ã‚€ã­è‚‰ã‚’å¡©éº¹ã«æ¼¬ã‘ã‚‹ã¨æŸ”ã‚‰ã‹ããªã‚‹", "2025-12-17 08:00"),
    (33, 32, "å¡©éº¹ã„ã„ã§ã™ã­ï¼è©¦ã—ã¦ã¿ã¾ã™", "2025-12-17 08:30"),
    (34, None, "åµæ–™ç†ã®ãƒ¬ãƒ‘ãƒ¼ãƒˆãƒªãƒ¼å¢—ã‚„ã—ãŸã„", "2025-12-17 12:00"),
    (35, 34, "ã‚¹ãƒ‘ãƒ‹ãƒƒã‚·ãƒ¥ã‚ªãƒ ãƒ¬ãƒ„ãŠã™ã™ã‚ã€‚é‡ŽèœãŸã£ã·ã‚Šå…¥ã‚Œã‚‰ã‚Œã‚‹", "2025-12-17 12:30"),
    (36, 34, "èŒ¶ç¢—è’¸ã—ã‚‚ç³–è³ªä½Žã„ã§ã™ã‚ˆ", "2025-12-17 13:00"),
    (37, None, "ã‚­ãƒ£ãƒ™ãƒ„ã®åƒåˆ‡ã‚Šå±±ç››ã‚ŠãŒå®šç•ª", "2025-12-17 19:00"),
    (38, 37, "æœ€åˆã«é£Ÿã¹ã‚‹ã¨è¡€ç³–å€¤ã®ä¸ŠãŒã‚Šç·©ã‚„ã‹ã«ãªã‚Šã¾ã™ã‚ˆã­", "2025-12-17 19:30"),
    (39, None, "ã‚¢ãƒœã‚«ãƒ‰ã¯ç³–è³ªä½Žãã¦æ „é¤Šä¾¡é«˜ã„ã€‚æ¯Žæ—¥é£Ÿã¹ã¦ã‚‹", "2025-12-17 20:00"),
    (40, 39, "ã‚¢ãƒœã‚«ãƒ‰é«˜ã„ã‘ã©ä¾¡å€¤ã‚ã‚‹", "2025-12-17 20:30"),
    (41, None, "é«˜é‡Žè±†è…ã‚’ã‹ã‚‰æšã’é¢¨ã«ã—ãŸã‚‰ç¾Žå‘³ã—ã‹ã£ãŸ", "2025-12-18 12:00"),
    (42, 41, "é«˜é‡Žè±†è…ã‚¢ãƒ¬ãƒ³ã‚¸ã„ã„ã§ã™ã­ï¼ãƒ¬ã‚·ãƒ”çŸ¥ã‚ŠãŸã„", "2025-12-18 12:30"),
    (43, 42, "é†¤æ²¹ã¨ã«ã‚“ã«ãã§ä¸‹å‘³ã¤ã‘ã¦ç‰‡æ —ç²‰ã§æšã’ã‚‹ã ã‘", "2025-12-18 13:00"),
    (44, None, "ãã®ã“é¡žã¯ç³–è³ªä½Žã„ã‹ã‚‰ç©æ¥µçš„ã«é£Ÿã¹ã¦ã‚‹", "2025-12-18 14:00"),
    (45, 44, "ã—ã‚ã˜ã€ãˆã®ãã€èˆžèŒ¸ã‚ˆãä½¿ã†", "2025-12-18 14:30"),
    (46, None, "ç³–è³ªåˆ¶é™ã§ä¾¿ç§˜ã«ãªã£ãŸäººã„ã¾ã™ã‹ï¼Ÿ", "2025-12-18 19:00"),
    (47, 46, "ç§ã‚‚ãªã‚Šã¾ã—ãŸã€‚é£Ÿç‰©ç¹Šç¶­æ„è­˜ã—ã¦æ‘‚ã‚‹ã‚ˆã†ã«ã—ã¦ã¾ã™", "2025-12-18 19:30"),
    (48, 46, "ãŠã‹ã‚‰ãƒ‘ã‚¦ãƒ€ãƒ¼å…¥ã‚Œã‚‹ã¨æ”¹å–„ã—ã¾ã—ãŸã‚ˆ", "2025-12-18 20:00"),
    (49, None, "ãŠã‹ã‚‰ãƒ‘ã‚¦ãƒ€ãƒ¼ã§ãŠå¥½ã¿ç„¼ãä½œã‚‹ã¨ä½Žç³–è³ªã§ç¾Žå‘³ã—ã„", "2025-12-19 12:00"),
    (50, 49, "ãŠã‹ã‚‰è’¸ã—ãƒ‘ãƒ³ã‚‚ç°¡å˜ã§è‰¯ã„ã§ã™ã‚ˆ", "2025-12-19 12:30"),
    (51, None, "åˆºèº«ã¯ç³–è³ªã‚¼ãƒ­ã€‚å±…é…’å±‹ã§åŠ©ã‹ã‚‹", "2025-12-19 19:00"),
    (52, 51, "ç„¼ãé³¥ï¼ˆå¡©ï¼‰ã‚‚ç³–è³ªä½Žãã¦ã„ã„ã§ã™ã‚ˆã­", "2025-12-19 19:30"),
    (53, None, "1åž‹ã§ã‚¤ãƒ³ã‚¹ãƒªãƒ³èª¿æ•´ã—ã¦ã‚‹ã‘ã©ç³–è³ªåˆ¶é™ã‚‚ã—ã¦ã‚‹", "2025-12-19 20:00"),
    (54, 53, "1åž‹ã§ã‚‚ç³–è³ªåˆ¶é™åŠ¹æžœã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "2025-12-19 20:30"),
    (55, 54, "ã‚¤ãƒ³ã‚¹ãƒªãƒ³é‡æ¸›ã‚‰ã›ã¦ä½Žè¡€ç³–ãƒªã‚¹ã‚¯ä¸‹ãŒã‚Šã¾ã—ãŸ", "2025-12-19 21:00"),
    (56, None, "å¹´æœ«å¹´å§‹ã®é£Ÿäº‹ãŒå¿ƒé…â€¦", "2025-12-20 19:00"),
    (57, 56, "ãŠã›ã¡ã®ä¸­ã§ä½Žç³–è³ªãªã‚‚ã®é¸ã‚“ã§é£Ÿã¹ã¾ã—ã‚‡ã†", "2025-12-20 19:30"),
    (58, None, "ã‚¨ãƒ“ã‚„ã‹ã¾ã¼ã“ã¯æ„å¤–ã¨ç³–è³ªä½Žã„", "2025-12-20 20:00"),
    (59, None, "ã‚¯ãƒªã‚¹ãƒžã‚¹ã€ãƒ­ãƒ¼ã‚¹ãƒˆãƒã‚­ãƒ³ã¯ç³–è³ªä½Žãã¦ã‚»ãƒ¼ãƒ•", "2025-12-23 12:00"),
    (60, 59, "ã‚±ãƒ¼ã‚­ã ã‘æ³¨æ„ã™ã‚Œã°ã„ã‘ã¾ã™ã­", "2025-12-23 12:30"),
    (61, None, "ä½Žç³–è³ªã‚¯ãƒªã‚¹ãƒžã‚¹ã‚±ãƒ¼ã‚­è²·ã£ãŸï¼", "2025-12-24 15:00"),
    (62, 61, "ã©ã“ã®ã§ã™ã‹ï¼Ÿ", "2025-12-24 15:30"),
    (63, 62, "ã‚·ãƒ£ãƒˆãƒ¬ãƒ¼ã‚¼ã§ã™ã€‚ç³–è³ª5gä»¥ä¸‹", "2025-12-24 16:00"),
    (64, None, "ãŠæ­£æœˆã€ãŠé¤…ã®ä»£ã‚ã‚Šã«ä½•é£Ÿã¹ã¾ã™ï¼Ÿ", "2025-12-28 19:00"),
    (65, 64, "é«˜é‡Žè±†è…ã‚’é¤…ã£ã½ãã™ã‚‹äººã„ã‚‹ã¿ãŸã„", "2025-12-28 19:30"),
    (66, 64, "ç§ã¯è«¦ã‚ã¦å°‘ã—ã ã‘é£Ÿã¹ã‚‹äºˆå®š", "2025-12-28 20:00"),
    (67, None, "ãŠé›‘ç…®ã®é¤…æŠœãã§å…·ã ã‘é£Ÿã¹ãŸ", "2026-01-01 12:00"),
    (68, 67, "ãã‚Œè‰¯ã„ã‚¢ã‚¤ãƒ‡ã‚¢ï¼æ¥å¹´ã‚„ã‚Šã¾ã™", "2026-01-01 12:30"),
    (69, None, "ãŠã›ã¡ã¯æ•°ã®å­ã¨ç”°ä½œã‚Šãƒ¡ã‚¤ãƒ³ã§ä¹—ã‚Šåˆ‡ã£ãŸ", "2026-01-01 18:00"),
    (70, 69, "é»’è±†ã¨æ —ãã‚“ã¨ã‚“é¿ã‘ã‚‹ã®å¤§å¤‰ã ã£ãŸ", "2026-01-01 18:30"),
    (71, None, "æ­£æœˆå¤ªã‚Šå›žé¿ã§ããŸï¼ç³–è³ªåˆ¶é™ã®ãŠã‹ã’", "2026-01-04 10:00"),
    (72, 71, "ã™ã”ã„ï¼ç§ã¯å°‘ã—å¢—ãˆãŸâ€¦", "2026-01-04 10:30"),
    (73, None, "é‹æ–™ç†ã¯ç³–è³ªåˆ¶é™ã®å‘³æ–¹ã€‚ã‚·ãƒ¡ã•ãˆæˆ‘æ…¢ã™ã‚Œã°", "2026-01-06 19:00"),
    (74, 73, "ã‚·ãƒ¡ã‚’è±†è…ã«ã™ã‚‹ã¨æº€è¶³æ„Ÿã‚ã‚‹", "2026-01-06 19:30"),
    (75, None, "ã—ã‚‰ãŸãã§ãƒ©ãƒ¼ãƒ¡ãƒ³é¢¨ä½œã£ãŸã€‚æ„å¤–ã¨ã„ã‘ã‚‹", "2026-01-08 12:00"),
    (76, 75, "ã‚¹ãƒ¼ãƒ—ã¯æ™®é€šã®ã§OKï¼Ÿ", "2026-01-08 12:30"),
    (77, 76, "å¸‚è²©ã®ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚¹ãƒ¼ãƒ—ä½¿ã£ã¦ã¾ã™ã€‚ç³–è³ªå°‘ãªã„ã‚„ã¤", "2026-01-08 13:00"),
    (78, None, "å†¬ã¯é‹ãŒå¤šããªã‚‹ã€‚ç™½èœãŸã£ã·ã‚Šã§", "2026-01-10 19:00"),
    (79, 78, "ç™½èœã¯ç³–è³ªä½Žãã¦ã„ã„ã§ã™ã‚ˆã­", "2026-01-10 19:30"),
    (80, None, "ç³–è³ªåˆ¶é™å§‹ã‚ã¦åŠå¹´ã€‚HbA1c 1.5%ä¸‹ãŒã£ãŸ", "2026-01-12 15:00"),
    (81, 80, "ã™ã”ã„åŠ¹æžœï¼åŠ±ã¿ã«ãªã‚Šã¾ã™", "2026-01-12 15:30"),
    (82, None, "MCTã‚ªã‚¤ãƒ«ä½¿ã£ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2026-01-14 10:00"),
    (83, 82, "ã‚³ãƒ¼ãƒ’ãƒ¼ã«å…¥ã‚Œã¦ã¾ã™ã€‚æº€è…¹æ„ŸæŒç¶šã™ã‚‹", "2026-01-14 10:30"),
    (84, None, "å¤§è±†ç²‰ã§ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ä½œã£ãŸã€‚ãµã‚ãµã‚ã§ç¾Žå‘³ã—ã„", "2026-01-15 12:00"),
    (85, 84, "ãƒ¬ã‚·ãƒ”æ•™ãˆã¦ãã ã•ã„ï¼", "2026-01-15 12:30"),
    (86, 85, "å¤§è±†ç²‰50gã€åµ1å€‹ã€è±†ä¹³50mlã€ãƒ™ãƒ¼ã‚­ãƒ³ã‚°ãƒ‘ã‚¦ãƒ€ãƒ¼å°ã•ã˜1", "2026-01-15 13:00"),
    (87, None, "å¤–é£Ÿã§å›°ã‚‹ã€‚ãƒ¡ãƒ‹ãƒ¥ãƒ¼é¸ã³é›£ã—ã„", "2026-01-17 12:00"),
    (88, 87, "å®šé£Ÿå±‹ã§ã”é£¯å°‘ãªã‚ã£ã¦é ¼ã‚“ã§ã¾ã™", "2026-01-17 12:30"),
    (89, 87, "ãƒ•ã‚¡ãƒŸãƒ¬ã‚¹ã¯ã‚µãƒ©ãƒ€+ã‚¹ãƒ†ãƒ¼ã‚­ãŒå®šç•ª", "2026-01-17 13:00"),
    (90, None, "ã‚†ã§åµã‚’ä½œã‚Šç½®ãã—ã¦ãŠãã¨ä¾¿åˆ©", "2026-01-19 09:00"),
    (91, 90, "ç…®åµã«ã™ã‚‹ã¨å‘³å¤‰ã§ãã¦ã„ã„", "2026-01-19 09:30"),
    (92, None, "æžè±†ã‚‚ãŠã‚„ã¤ã«è‰¯ã„ã€‚ç³–è³ªä½Žã‚ã§ã‚¿ãƒ³ãƒ‘ã‚¯è³ªå–ã‚Œã‚‹", "2026-01-20 15:00"),
    (93, 92, "å†·å‡æžè±†å¸¸å‚™ã—ã¦ã¾ã™", "2026-01-20 15:30"),
    (94, None, "ç³–è³ªåˆ¶é™ã—ã¦ã‚‹ã¨ãŠé‡‘ã‹ã‹ã‚‹æ°—ãŒã™ã‚‹", "2026-01-22 19:00"),
    (95, 94, "ç¢ºã‹ã«â€¦ä½Žç³–è³ªå•†å“é«˜ã„ã§ã™ã‚ˆã­", "2026-01-22 19:30"),
    (96, 94, "ã§ã‚‚åŒ»ç™‚è²»æ¸›ã‚‹ã¨è€ƒãˆã‚Œã°â€¦", "2026-01-22 20:00"),
    (97, None, "ã‚ºãƒƒã‚­ãƒ¼ãƒ‹ã‚’éººä»£ã‚ã‚Šã«ã™ã‚‹ã®ãƒãƒžã£ã¦ã‚‹", "2026-01-24 12:00"),
    (98, 97, "ãƒ”ãƒ¼ãƒ©ãƒ¼ã§è–„ãã‚¹ãƒ©ã‚¤ã‚¹ã™ã‚‹ã‚„ã¤ï¼Ÿ", "2026-01-24 12:30"),
    (99, 98, "ãã†ã§ã™ï¼ã‚ºãƒ¼ãƒ‰ãƒ«ã£ã¦è¨€ã†ã‚‰ã—ã„", "2026-01-24 13:00"),
    (100, None, "100ã‚³ãƒ¡ãƒ³ãƒˆï¼ç³–è³ªåˆ¶é™ä»²é–“ãŸãã•ã‚“ã„ã¦å¬‰ã—ã„", "2026-01-25 20:00"),
    (101, 100, "ãƒ¬ã‚·ãƒ”æƒ…å ±åŠ©ã‹ã£ã¦ã¾ã™ï¼", "2026-01-25 20:30"),
    (102, None, "ã‚µãƒç¼¶ãŒä¾¿åˆ©ã€‚ç³–è³ªã‚¼ãƒ­ã§DHAå–ã‚Œã‚‹", "2026-01-27 12:00"),
    (103, 102, "æ°´ç…®ãŒãƒ™ã‚¹ãƒˆã§ã™ã‚ˆã­ã€‚å‘³å™Œç…®ã¯ç³–è³ªã‚ã‚‹", "2026-01-27 12:30"),
    # Future comments (after 2026-01-28)
    (104, None, "ã‚³ã‚¹ãƒˆã‚³ã®ç³–è³ªã‚ªãƒ•å•†å“ãƒã‚§ãƒƒã‚¯ã—ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2026-01-29 10:00"),
    (105, 104, "ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³ãƒãƒ¼ã¨ã‹è²·ã£ã¦ã¾ã™", "2026-01-29 10:30"),
    (106, None, "è±šã—ã‚ƒã¶ã‚µãƒ©ãƒ€ãŒæœ€è¿‘ã®ãƒ–ãƒ¼ãƒ ", "2026-01-31 12:00"),
    (107, 106, "ãƒãƒ³é…¢ã§é£Ÿã¹ã‚‹ã¨ç¾Žå‘³ã—ã„ã§ã™ã‚ˆã­", "2026-01-31 12:30"),
    (108, None, "2æœˆã«ãªã£ãŸã€‚ç³–è³ªåˆ¶é™ç¶™ç¶šä¸­", "2026-02-01 09:00"),
    (109, None, "æµæ–¹å·»ãã®ä»£ã‚ã‚Šã«ä½•é£Ÿã¹ã¾ã™ï¼Ÿ", "2026-02-01 12:00"),
    (110, 109, "æµ·è‹”å·»ãã®å…·ã ã‘é£Ÿã¹ã‚‹äºˆå®šç¬‘", "2026-02-01 12:30"),
    (111, 109, "è–„ç„¼ãåµã§å·»ããƒ¬ã‚·ãƒ”è¦‹ã¤ã‘ãŸ", "2026-02-01 13:00"),
    (112, None, "ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ã€ä½Žç³–è³ªãƒãƒ§ã‚³ä½œã‚‹äºˆå®š", "2026-02-10 19:00"),
    (113, 112, "ãƒ¬ã‚·ãƒ”çŸ¥ã‚ŠãŸã„ã§ã™ï¼", "2026-02-10 19:30"),
    (114, 113, "ã‚³ã‚³ã‚¢ãƒ‘ã‚¦ãƒ€ãƒ¼ã¨ãƒ©ã‚«ãƒ³ãƒˆã¨ã‚³ã‚³ãƒŠãƒƒãƒ„ã‚ªã‚¤ãƒ«ã§ä½œã‚Œã¾ã™ã‚ˆ", "2026-02-10 20:00"),
    (115, None, "é«˜ã‚«ã‚«ã‚ªãƒãƒ§ã‚³ï¼ˆ86%ä»¥ä¸Šï¼‰ãªã‚‰å°‘ã—ã¯é£Ÿã¹ã¦ã‚‹", "2026-02-14 15:00"),
    (116, 115, "ç§ã‚‚86%ã®ã‚„ã¤å¥½ãã€‚è‹¦ã„ã‘ã©æ…£ã‚ŒãŸ", "2026-02-14 15:30"),
    (117, None, "ç³–è³ªåˆ¶é™1å¹´ç¶šã„ãŸã€‚è‡ªåˆ†ã‚’è¤’ã‚ãŸã„", "2026-02-17 10:00"),
    (118, 117, "1å¹´ç¶™ç¶šã™ã”ã„ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™", "2026-02-17 10:30"),
    (119, None, "ãƒ©ã‚«ãƒ³ãƒˆã¨ã‚¨ãƒªã‚¹ãƒªãƒˆãƒ¼ãƒ«ã€ã©ã£ã¡ä½¿ã£ã¦ã¾ã™ã‹ï¼Ÿ", "2026-02-19 14:00"),
    (120, 119, "ãƒ©ã‚«ãƒ³ãƒˆæ´¾ã€‚è‡ªç„¶ãªç”˜ã•ãŒå¥½ã", "2026-02-19 14:30"),
    (121, 119, "ã‚³ã‚¹ãƒ‘è€ƒãˆã¦ã‚¨ãƒªã‚¹ãƒªãƒˆãƒ¼ãƒ«ä½¿ã£ã¦ã¾ã™", "2026-02-19 15:00"),
    (122, None, "æ²¹æšã’ã§ãƒ”ã‚¶ç”Ÿåœ°ã®ä»£ã‚ã‚Šã«ã™ã‚‹ã®æœ€é«˜", "2026-02-21 12:00"),
    (123, 122, "æ²¹æšã’ãƒ”ã‚¶ã‚„ã£ã¦ã¿ã¾ã™ï¼", "2026-02-21 12:30"),
    (124, None, "ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³é£²ã‚“ã§ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2026-02-22 19:00"),
    (125, 124, "æœé£Ÿä»£ã‚ã‚Šã«é£²ã‚“ã§ã¾ã™ã€‚ç³–è³ªå°‘ãªã„ã‚„ã¤", "2026-02-22 19:30"),
    (126, None, "ç³–è³ªåˆ¶é™ã§è‚Œè’ã‚Œæ²»ã£ãŸäººã„ã‚‹ï¼Ÿ", "2026-02-24 10:00"),
    (127, 126, "ç§ã¯è‰¯ããªã‚Šã¾ã—ãŸï¼ç‚Žç—‡æ¸›ã£ãŸæ°—ãŒã™ã‚‹", "2026-02-24 10:30"),
    (128, None, "ã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰ãƒ•ã‚£ãƒƒã‚·ãƒ¥ãŒåœ°å‘³ã«å¥½ã", "2026-02-25 15:00"),
    (129, 128, "ã‚«ãƒ«ã‚·ã‚¦ãƒ ã‚‚å–ã‚Œã¦ã„ã„ã§ã™ã‚ˆã­", "2026-02-25 15:30"),
    (130, None, "ç‰›è‚‰ã¯ç³–è³ªã‚¼ãƒ­ã€‚ç„¼è‚‰æœ€é«˜", "2026-02-26 19:00"),
    (131, 130, "ã‚¿ãƒ¬ã®ç³–è³ªã ã‘æ³¨æ„ã§ã™ã­", "2026-02-26 19:30"),
    (132, None, "ã‚†ã‚‹ç³–è³ªåˆ¶é™ã«ã—ãŸã‚‰ç¶šã‘ã‚„ã™ããªã£ãŸ", "2026-02-27 10:00"),
    (133, 132, "ã‚¹ãƒˆã‚¤ãƒƒã‚¯ã™ãŽã‚‹ã¨ç¶šã‹ãªã„ã§ã™ã‚‚ã‚“ã­", "2026-02-27 10:30"),
    (134, None, "é€±1ã§å¥½ããªã‚‚ã®é£Ÿã¹ã‚‹æ—¥ä½œã£ã¦ã‚‹", "2026-02-27 12:00"),
    (135, 134, "ãƒãƒ¼ãƒˆãƒ‡ã‚¤å¤§äº‹ã§ã™ã‚ˆã­", "2026-02-27 12:30"),
    (136, None, "ã“ã®ã‚¹ãƒ¬ã®ãŠã‹ã’ã§ãƒ¬ã‚·ãƒ”ã®å¹…åºƒãŒã£ãŸ", "2026-02-28 10:00"),
    (137, 136, "åŒæ„Ÿã§ã™ï¼ã¿ã‚“ãªã®ã‚¢ã‚¤ãƒ‡ã‚¢ã™ã”ã„", "2026-02-28 10:30"),
    (138, None, "ç³–è³ªåˆ¶é™ã¯ä¸€ç”Ÿç¶šã‘ã‚‹è¦šæ‚Ÿ", "2026-02-28 14:00"),
    (139, 138, "ç§ã‚‚ã€‚å¥åº·ã®ãŸã‚ã ã‹ã‚‰", "2026-02-28 14:30"),
    (140, None, "3æœˆã‚‚ç³–è³ªåˆ¶é™é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼", "2026-02-28 19:00"),
    (141, 140, "ã¯ã„ï¼å¼•ãç¶šãæƒ…å ±äº¤æ›ã—ã¾ã—ã‚‡ã†", "2026-02-28 19:30"),
    (142, None, "æ¥æœˆã¯ã²ãªç¥­ã‚Šã®ä½Žç³–è³ªãƒ¡ãƒ‹ãƒ¥ãƒ¼è€ƒãˆãªã„ã¨", "2026-02-28 20:00"),
    (143, 142, "ã¡ã‚‰ã—å¯¿å¸ã®ç±³ã‚’ã‚«ãƒªãƒ•ãƒ©ãƒ¯ãƒ¼ã«ã™ã‚‹äººã„ã‚‹ã¿ãŸã„", "2026-02-28 20:30"),
    (144, None, "ã¿ã‚“ãªã®ãŠã‹ã’ã§æ¥½ã—ãç³–è³ªåˆ¶é™ã§ãã¦ã¾ã™", "2026-02-28 21:00"),
    (145, 144, "ã“ã¡ã‚‰ã“ãï¼ã“ã‚Œã‹ã‚‰ã‚‚ã‚ˆã‚ã—ãðŸ’ª", "2026-02-28 21:30"),
    (146, None, "ã¾ãŸæ–°ã—ã„ãƒ¬ã‚·ãƒ”è¦‹ã¤ã‘ãŸã‚‰å ±å‘Šã—ã¾ã™ï¼", "2026-02-28 22:00"),
]

def jst_to_utc(jst_str):
    dt = datetime.strptime(jst_str, "%Y-%m-%d %H:%M")
    dt_utc = dt - timedelta(hours=9)
    return dt_utc.strftime("%Y-%m-%dT%H:%M:%S+00:00")

def assign_user_ids(comments):
    user_map = {}
    user_idx = 0
    for num, reply_to, body, dt in comments:
        if reply_to and reply_to in user_map:
            parent_user = user_map[reply_to]
            candidate = USERS[user_idx % len(USERS)]
            while candidate == parent_user:
                user_idx += 1
                candidate = USERS[user_idx % len(USERS)]
            user_map[num] = candidate
            user_idx += 1
        else:
            user_map[num] = USERS[user_idx % len(USERS)]
            user_idx += 1
    return user_map

def insert_batch(records, batch_num):
    url = f"{SUPABASE_URL}/rest/v1/comments"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps(records).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="POST")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Batch {batch_num}: {resp.status} - {len(records)} records inserted")
            return True
    except urllib.error.HTTPError as e:
        print(f"  Batch {batch_num}: ERROR {e.code} - {e.read().decode()}")
        return False

def main():
    print(f"Processing {len(COMMENTS)} comments for thread No.14")
    print(f"Thread ID: {THREAD_ID}")

    comment_uuids = {}
    for num, _, _, _ in COMMENTS:
        comment_uuids[num] = str(uuid.uuid4())

    user_map = assign_user_ids(COMMENTS)

    records = []
    now_utc = datetime.utcnow()
    past_count = 0
    future_count = 0

    for num, reply_to, body, dt_jst in COMMENTS:
        utc_str = jst_to_utc(dt_jst)
        dt_obj = datetime.strptime(dt_jst, "%Y-%m-%d %H:%M") - timedelta(hours=9)
        is_future = dt_obj > now_utc
        if is_future:
            future_count += 1
        else:
            past_count += 1

        parent_id = comment_uuids[reply_to] if reply_to else None
        record = {
            "id": comment_uuids[num],
            "thread_id": THREAD_ID,
            "body": body,
            "user_id": user_map[num],
            "is_hidden": False,
            "created_at": utc_str,
            "parent_id": parent_id,
        }
        records.append(record)

    print(f"Past comments: {past_count}")
    print(f"Future comments: {future_count}")
    print(f"Total: {len(records)}")
    print()

    BATCH_SIZE = 50
    for i in range(0, len(records), BATCH_SIZE):
        batch = records[i:i+BATCH_SIZE]
        batch_num = i // BATCH_SIZE + 1
        success = insert_batch(batch, batch_num)
        if not success:
            print("STOPPING due to error")
            return

    print(f"\nAll {len(records)} comments inserted!")

    print(f"\nUpdating comments_count to {past_count}...")
    url = f"{SUPABASE_URL}/rest/v1/threads?id=eq.{THREAD_ID}"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps({"comments_count": past_count}).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="PATCH")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Updated: {resp.status}")
    except urllib.error.HTTPError as e:
        print(f"  ERROR: {e.code} - {e.read().decode()}")

if __name__ == "__main__":
    main()
