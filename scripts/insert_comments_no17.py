#!/usr/bin/env python3
"""Insert 140 comments for thread No.17: é–“é£Ÿãƒ»ãŠã‚„ã¤ã©ã†ã—ã¦ã‚‹ï¼Ÿ"""

import uuid
import json
import urllib.request
from datetime import datetime, timedelta, timezone

SUPABASE_URL = "https://josanlblwfjdaaezqbnw.supabase.co"
SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impvc2FubGJsd2ZqZGFhZXpxYm53Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2Nzg0MjYwNiwiZXhwIjoyMDgzNDE4NjA2fQ.JlTXBmY5HJAqfRD_AazsiBORpgLZfB74fPkNyyfVSQY"

THREAD_ID = "87689a5a-da97-4b4e-9fd9-e4236d825e46"
THREAD_OWNER_ID = "2033ee1c-28b2-5187-8ba1-c94f7964e33e"

USERS = [
    "b0000001-0000-0000-0000-000000000001",
    "b0000001-0000-0000-0000-000000000002",
    "b0000001-0000-0000-0000-000000000003",
    "b0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000005",
    "b0000001-0000-0000-0000-000000000006",
    "b0000001-0000-0000-0000-000000000007",
    "b0000001-0000-0000-0000-000000000008",
    "b0000001-0000-0000-0000-000000000009",
    "b0000001-0000-0000-0000-000000000010",
    "b0000001-0000-0000-0000-000000000011",
    "b0000001-0000-0000-0000-000000000012",
    "b0000001-0000-0000-0000-000000000013",
    "b0000001-0000-0000-0000-000000000014",
    "b0000001-0000-0000-0000-000000000015",
    "f0000001-0000-0000-0000-000000000001",
    "f0000001-0000-0000-0000-000000000002",
    "f0000001-0000-0000-0000-000000000005",
    "f0000001-0000-0000-0000-000000000006",
    "f0000001-0000-0000-0000-000000000009",
    "f0000001-0000-0000-0000-000000000010",
    "f0000001-0000-0000-0000-000000000008",
    "f0000001-0000-0000-0000-000000000003",
    "f0000001-0000-0000-0000-000000000004",
    "b0000001-0000-0000-0000-000000000016",
    "b0000001-0000-0000-0000-000000000017",
    "b0000001-0000-0000-0000-000000000018",
    "b0000001-0000-0000-0000-000000000019",
    "b0000001-0000-0000-0000-000000000020",
    THREAD_OWNER_ID,
]

# parent_id fixes applied: #13â†’11, #19â†’17, #28â†’26, #31â†’29, #39â†’37, #70â†’68, #83â†’81, #129â†’127, #135â†’132
COMMENTS = [
    (2, None, "é–“é£Ÿã‚„ã‚ã‚‰ã‚Œãªã„â€¦ã¿ãªã•ã‚“ã©ã†ã—ã¦ã¾ã™ã‹ï¼Ÿ", "2025-12-16 14:30"),
    (3, 2, "ç§ã‚‚ã§ã™ðŸ’¦ãƒŠãƒƒãƒ„é¡žã«ç½®ãæ›ãˆã¦ã¾ã™", "2025-12-16 15:15"),
    (4, 2, "SUNAOã®ã‚¢ã‚¤ã‚¹ãŠã™ã™ã‚ã§ã™ã‚ˆ", "2025-12-16 16:00"),
    (5, None, "ãƒãƒ¼ã‚ºãŒæœ€å¼·ã ã¨æ€ã£ã¦ã‚‹ã€‚ç³–è³ªã»ã¼ã‚¼ãƒ­ã ã—", "2025-12-16 19:20"),
    (6, 5, "6Pãƒãƒ¼ã‚ºå¸¸å‚™ã—ã¦ã¾ã™ï¼", "2025-12-16 19:45"),
    (7, None, "ãƒ­ãƒ¼ã‚½ãƒ³ã®ä½Žç³–è³ªã‚·ãƒªãƒ¼ã‚ºã«ãƒãƒžã£ã¦ã‚‹", "2025-12-16 20:30"),
    (8, 7, "ãƒ–ãƒ©ãƒ³ãƒ‘ãƒ³ãŠã„ã—ã„ã§ã™ã‚ˆã­", "2025-12-16 21:00"),
    (9, None, "ã‚†ã§åµã‚’é–“é£Ÿã«ã—ã¦ã‚‹ã€‚æº€è¶³æ„Ÿã‚ã‚‹ã—è¡€ç³–å€¤ä¸ŠãŒã‚‰ãªã„", "2025-12-17 10:15"),
    (10, 9, "ã‚³ãƒ³ãƒ“ãƒ‹ã®å‘³ä»˜ã‘åµã‚‚ä¾¿åˆ©ã§ã™ã‚ˆã­", "2025-12-17 10:45"),
    (11, None, "ç´ ç„¼ãã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰æ¯Žæ—¥é£Ÿã¹ã¦ã¾ã™", "2025-12-17 14:20"),
    (12, 11, "ã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰ã„ã„ã§ã™ã‚ˆã­ã€‚1æ—¥ä½•ç²’ãã‚‰ã„é£Ÿã¹ã¦ã¾ã™ã‹ï¼Ÿ", "2025-12-17 14:50"),
    (13, 11, "20ç²’ãã‚‰ã„ã§ã™ã‹ã­ã€‚å°åˆ†ã‘ã«ã—ã¦æŒã¡æ­©ã„ã¦ã¾ã™", "2025-12-17 15:30"),
    (14, None, "ã‚·ãƒ£ãƒˆãƒ¬ãƒ¼ã‚¼ã®ç³–è³ªã‚ªãƒ•ã‚¹ã‚¤ãƒ¼ãƒ„æœ€é«˜", "2025-12-17 19:00"),
    (15, 14, "è¿‘ãã«ã‚·ãƒ£ãƒˆãƒ¬ãƒ¼ã‚¼ãªã„ã®ãŒæ‚”ã—ã„â€¦", "2025-12-17 19:30"),
    (16, 14, "ç³–è³ªã‚ªãƒ•ã®ã©ã‚‰ç„¼ãé£Ÿã¹ã¾ã—ãŸï¼æ™®é€šã«ãŠã„ã—ã‹ã£ãŸ", "2025-12-17 20:00"),
    (17, None, "é«˜ã‚«ã‚«ã‚ªãƒãƒ§ã‚³ï¼ˆ86%ï¼‰ã‚’1ã€œ2æžšã ã‘", "2025-12-17 21:15"),
    (18, 17, "è‹¦ããªã„ã§ã™ã‹ï¼Ÿç§ã¯72%ãŒé™ç•Œâ€¦", "2025-12-17 21:45"),
    (19, 17, "æ…£ã‚Œã¾ã™ã‚ˆï¼æœ€åˆã¯è‹¦ã‹ã£ãŸã‘ã©ä»Šã¯ç”˜ãæ„Ÿã˜ã‚‹", "2025-12-17 22:10"),
    (20, None, "ãŠã‚„ã¤é£Ÿã¹ãŸããªã£ãŸã‚‰ç‚­é…¸æ°´é£²ã‚“ã§ã”ã¾ã‹ã—ã¦ã‚‹", "2025-12-18 09:30"),
    (21, 20, "ã‚¦ã‚£ãƒ«ã‚­ãƒ³ã‚½ãƒ³æ„›é£²ã—ã¦ã¾ã™ç¬‘", "2025-12-18 10:00"),
    (22, None, "ãƒªãƒ–ãƒ¬ã¤ã‘ã¦ã‹ã‚‰ãŠã‚„ã¤æ¸›ã£ãŸã€‚ã‚°ãƒ©ãƒ•è¦‹ã‚‹ã¨é£Ÿã¹ã‚‹æ°—ãªããªã‚‹", "2025-12-18 14:15"),
    (23, 22, "ã‚ã‹ã‚‹ï¼å¯è¦–åŒ–ã•ã‚Œã‚‹ã¨æŠ‘æ­¢åŠ›ã«ãªã‚Šã¾ã™ã‚ˆã­", "2025-12-18 14:45"),
    (24, None, "å°é­šã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰ã£ã¦ã©ã†ã§ã™ã‹ï¼Ÿ", "2025-12-18 16:00"),
    (25, 24, "ã‚«ãƒ«ã‚·ã‚¦ãƒ ã‚‚å–ã‚Œã¦ã„ã„ã§ã™ã‚ˆï¼ãŸã å¡©åˆ†æ³¨æ„", "2025-12-18 16:30"),
    (26, None, "ç„¡å°ã®ç³–è³ª10gä»¥ä¸‹ã‚·ãƒªãƒ¼ã‚ºå…¨éƒ¨è©¦ã—ãŸ", "2025-12-18 19:00"),
    (27, 26, "ã©ã‚ŒãŒä¸€ç•ªãŠã™ã™ã‚ã§ã™ã‹ï¼Ÿ", "2025-12-18 19:30"),
    (28, 26, "ãƒã‚¦ãƒ ã‚¯ãƒ¼ãƒ˜ãƒ³ãŒä¸€ç•ªãŠã„ã—ã‹ã£ãŸï¼", "2025-12-18 20:00"),
    (29, None, "å¯’å¤©ã‚¼ãƒªãƒ¼è‡ªåˆ†ã§ä½œã£ã¦ã¾ã™ã€‚0ã‚«ãƒ­ãƒªãƒ¼ã ã—", "2025-12-18 21:30"),
    (30, 29, "ãƒ¬ã‚·ãƒ”æ•™ãˆã¦ã»ã—ã„ã§ã™ï¼", "2025-12-18 22:00"),
    (31, 29, "ç²‰å¯’å¤©ï¼‹ãƒ©ã‚«ãƒ³ãƒˆï¼‹ãƒ¬ãƒ¢ãƒ³æ±ã§ç°¡å˜ã«ã§ãã¾ã™ã‚ˆ", "2025-12-18 22:30"),
    (32, None, "3æ™‚ã®ãŠã‚„ã¤ã¯ç¿’æ…£ã ã‹ã‚‰ãªã‹ãªã‹ã‚„ã‚ã‚‰ã‚Œãªã„â€¦", "2025-12-19 15:00"),
    (33, 32, "ã‚ã‹ã‚Šã¾ã™ã€‚ç§ã¯æ™‚é–“ã‚’ãšã‚‰ã—ã¦4æ™‚ã«ã—ã¾ã—ãŸ", "2025-12-19 15:30"),
    (34, None, "ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³ãƒãƒ¼ã£ã¦ã©ã†ãªã‚“ã§ã—ã‚‡ã†ï¼Ÿ", "2025-12-19 17:00"),
    (35, 34, "ã‚‚ã®ã«ã‚ˆã£ã¦ã¯ç³–è³ªé«˜ã„ã®ã§è¦ãƒã‚§ãƒƒã‚¯ã§ã™", "2025-12-19 17:30"),
    (36, 34, "inãƒãƒ¼ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³ã®ãƒ™ã‚¤ã‚¯ãƒ‰ãƒãƒ§ã‚³ã¯ç³–è³ª10gä»¥ä¸‹ã§ãŠã™ã™ã‚", "2025-12-19 18:00"),
    (37, None, "ãŠã‹ã‚‰ã‚¯ãƒƒã‚­ãƒ¼æ‰‹ä½œã‚Šã—ã¦ã¾ã™", "2025-12-19 20:30"),
    (38, 37, "ã™ã”ã„ï¼ç§ã«ã¯ãƒãƒ¼ãƒ‰ãƒ«é«˜ã„â€¦", "2025-12-19 21:00"),
    (39, 37, "ç”ŸãŠã‹ã‚‰ï¼‹åµï¼‹ãƒ©ã‚«ãƒ³ãƒˆã ã‘ã§æ„å¤–ã¨ç°¡å˜ã§ã™ã‚ˆ", "2025-12-19 21:30"),
    (40, None, "ã‚ãŸã‚Šã‚æœ€å¼·èª¬", "2025-12-20 12:00"),
    (41, 40, "é¡ŽãŒç–²ã‚Œã¦é£Ÿã¹ã™ãŽé˜²æ­¢ã«ã‚‚ãªã‚Šã¾ã™ã‚ˆã­ç¬‘", "2025-12-20 12:30"),
    (42, None, "å¹´æœ«å¹´å§‹ãŒæ€–ã„â€¦ãŠã‚„ã¤ã®èª˜æƒ‘ãŒã™ã”ãã†", "2025-12-20 19:00"),
    (43, 42, "å®Ÿå®¶å¸°ã‚‹ã¨è¦ªãŒãŠè“å­å‡ºã—ã¦ãã‚‹ã‚“ã§ã™ã‚ˆã­â€¦", "2025-12-20 19:30"),
    (44, 43, "è‡ªåˆ†ã§ä½Žç³–è³ªãŠã‚„ã¤æŒå‚ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã¾ã™", "2025-12-20 20:00"),
    (45, None, "ã‚®ãƒªã‚·ãƒ£ãƒ¨ãƒ¼ã‚°ãƒ«ãƒˆã«å†·å‡ãƒ–ãƒ«ãƒ¼ãƒ™ãƒªãƒ¼å…¥ã‚Œã¦ãƒ‡ã‚¶ãƒ¼ãƒˆã«ã—ã¦ã‚‹", "2025-12-20 21:30"),
    (46, 45, "ãã‚ŒãŠã„ã—ãã†ï¼æ˜Žæ—¥ã‚„ã£ã¦ã¿ã¾ã™", "2025-12-20 22:00"),
    (47, None, "ã¿ã‚“ãªé ‘å¼µã£ã¦ã‚‹ãªãâ€¦ç§ã¯é€±1ã§æ™®é€šã®ãŠã‚„ã¤è§£ç¦ã—ã¦ã¾ã™", "2025-12-21 14:00"),
    (48, 47, "ã”è¤’ç¾Žãƒ‡ãƒ¼ã„ã„ã§ã™ã­ï¼ã‚¹ãƒˆãƒ¬ã‚¹æºœã‚ã™ãŽã‚‚è‰¯ããªã„ã—", "2025-12-21 14:30"),
    (49, None, "QBBã®ãƒ™ãƒ“ãƒ¼ãƒãƒ¼ã‚ºã€å‘³ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å¤šãã¦é£½ããªã„", "2025-12-21 16:00"),
    (50, 49, "ã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰å…¥ã‚ŠãŒå¥½ã", "2025-12-21 16:30"),
    (51, None, "ã“ã‚“ã«ã‚ƒãã‚¼ãƒªãƒ¼é£Ÿã¹ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2025-12-21 19:00"),
    (52, 51, "è’Ÿè’»ç•‘ã‚ˆãè²·ã„ã¾ã™ï¼ç³–è³ªã¯ãã“ãã“ã‚ã‚‹ã‘ã©ã‚«ãƒ­ãƒªãƒ¼ä½Žã‚", "2025-12-21 19:30"),
    (53, 52, "ã‚ªãƒªãƒ’ãƒ­ã®ã·ã‚‹ã‚“ã¨è’Ÿè’»ã‚¼ãƒªãƒ¼ã®æ–¹ãŒç³–è³ªä½Žã‚ã§ã™ã‚ˆ", "2025-12-21 20:00"),
    (54, None, "SUNAOã®ã‚¯ãƒƒã‚­ãƒ¼ã€ç³–è³ª9.2gãªã®ã«æº€è¶³æ„Ÿã‚ã‚‹", "2025-12-22 10:30"),
    (55, 54, "ç™ºé…µãƒã‚¿ãƒ¼å‘³ãŠã„ã—ã„ã§ã™ã‚ˆã­", "2025-12-22 11:00"),
    (56, None, "ã‚¯ãƒªã‚¹ãƒžã‚¹ã‚±ãƒ¼ã‚­ã©ã†ã—ã‚ˆã†â€¦", "2025-12-22 15:00"),
    (57, 56, "ã‚·ãƒ£ãƒˆãƒ¬ãƒ¼ã‚¼ã®ç³–è³ªã‚ªãƒ•ã‚±ãƒ¼ã‚­äºˆç´„ã—ã¾ã—ãŸï¼", "2025-12-22 15:30"),
    (58, 56, "ä¸€å£ã ã‘é£Ÿã¹ã¦æˆ‘æ…¢ã™ã‚‹äºˆå®šâ€¦", "2025-12-22 16:00"),
    (59, None, "ã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã«ãƒãƒžã£ã¦ã‚‹", "2025-12-22 19:30"),
    (60, None, "èŒŽã‚ã‹ã‚ã£ã¦é–“é£Ÿã«ã©ã†ã§ã™ã‹ï¼Ÿ", "2025-12-22 21:00"),
    (61, 60, "é£Ÿç‰©ç¹Šç¶­å–ã‚Œã¦ã„ã„ã§ã™ã‚ˆï¼ãŸã å¡©åˆ†æ³¨æ„", "2025-12-22 21:30"),
    (62, None, "å¹²ã—èŠ‹ã¯ç³–è³ªé«˜ã„ã‘ã©è¡€ç³–å€¤ä¸ŠãŒã‚Šã«ãã„ã£ã¦èžã„ãŸ", "2025-12-23 14:00"),
    (63, 62, "ä½ŽGIã ã‹ã‚‰ã‚†ã‚‹ã‚„ã‹ã«ä¸ŠãŒã‚‹ã‚‰ã—ã„ã§ã™ã­ã€‚ã§ã‚‚é£Ÿã¹ã™ãŽæ³¨æ„", "2025-12-23 14:30"),
    (64, None, "æ˜Žæ²»ã®ã‚ªãƒªã‚´ã‚¹ãƒžãƒ¼ãƒˆæ¯Žæ—¥é£Ÿã¹ã¦ã‚‹", "2025-12-23 17:00"),
    (65, 64, "ã‚ã‚ŒãŠã„ã—ã„ã§ã™ã‚ˆã­ã€‚æ™®é€šã®ãƒãƒ§ã‚³ã¨å¤‰ã‚ã‚‰ãªã„", "2025-12-23 17:30"),
    (66, None, "ãã‚‹ã¿ã‚‚è¡€ç³–å€¤ä¸ŠãŒã‚Šã«ãã„ã§ã™ã‚ˆ", "2025-12-23 20:00"),
    (67, 66, "ãƒŠãƒƒãƒ„é¡žã¯è„‚è³ªãŒæ°—ã«ãªã‚‹ã‘ã©è‰¯è³ªãªæ²¹ã ã‹ã‚‰ã„ã„ã®ã‹ãª", "2025-12-23 20:30"),
    (68, None, "1åž‹ã ã‘ã©ãŠã‚„ã¤å‰ã«ã‚¤ãƒ³ã‚¹ãƒªãƒ³æ‰“ã£ã¦ã‹ã‚‰é£Ÿã¹ã¦ã‚‹", "2025-12-24 10:00"),
    (69, 68, "ã‚«ãƒ¼ãƒœã‚«ã‚¦ãƒ³ãƒˆã—ã¦ã‚‹ã‚“ã§ã™ã‹ï¼Ÿ", "2025-12-24 10:30"),
    (70, 68, "ã¯ã„ã€ç³–è³ªé‡ã«åˆã‚ã›ã¦å˜ä½èª¿æ•´ã—ã¦ã¾ã™", "2025-12-24 11:00"),
    (71, None, "ä»Šæ—¥ã¯ã‚¯ãƒªã‚¹ãƒžã‚¹ã‚¤ãƒ–ã ã‹ã‚‰è‡ªåˆ†ã«ã‚±ãƒ¼ã‚­è¨±å¯ã—ãŸ", "2025-12-24 19:00"),
    (72, 71, "ãƒ¡ãƒªãƒ¼ã‚¯ãƒªã‚¹ãƒžã‚¹ðŸŽ„ãŸã¾ã«ã¯ã„ã„ã§ã™ã‚ˆã­", "2025-12-24 19:30"),
    (73, None, "ã‚±ãƒ¼ã‚­é£Ÿã¹ãŸã‚‰è¡€ç³–å€¤çˆ†ä¸ŠãŒã‚Šã—ãŸâ€¦å¾Œæ‚”ðŸ˜­", "2025-12-24 22:00"),
    (74, 73, "ã‚¯ãƒªã‚¹ãƒžã‚¹ã§ã™ã‚‚ã‚“ä»•æ–¹ãªã„ï¼æ˜Žæ—¥ã‹ã‚‰é ‘å¼µã‚Šã¾ã—ã‚‡ã†", "2025-12-24 22:30"),
    (75, None, "ãƒ•ã‚¡ãƒŸãƒžã®ãƒ©ã‚¤ã‚¶ãƒƒãƒ—ã‚³ãƒ©ãƒœã‚¹ã‚¤ãƒ¼ãƒ„ã©ã†ã§ã™ã‹ï¼Ÿ", "2025-12-25 14:00"),
    (76, 75, "ç³–è³ªä½Žãã¦ãŠã„ã—ã„ã§ã™ã‚ˆï¼ãƒ—ãƒªãƒ³ãŒå¥½ã", "2025-12-25 14:30"),
    (77, None, "å¹´æœ«ã®è²·ã„å‡ºã—ã§ä½Žç³–è³ªãŠã‚„ã¤å¤§é‡è²·ã„ã—ã¦ããŸ", "2025-12-26 16:00"),
    (78, 77, "å‚™ãˆã‚ã‚Œã°æ†‚ã„ãªã—ã§ã™ã­ï¼", "2025-12-26 16:30"),
    (79, None, "ãŠã›ã¡ã®ãŠã‚„ã¤ä»£ã‚ã‚Šã«æ —ãã‚“ã¨ã‚“é£Ÿã¹ãŸã„ã‘ã©ç³–è³ªã‚„ã°ã„ã‚ˆã­", "2025-12-27 19:00"),
    (80, 79, "æ —ãã‚“ã¨ã‚“ã¯ç³–è³ªã®å¡Šâ€¦å°‘é‡ã§æˆ‘æ…¢ã™ã‚‹ã—ã‹ãªã„", "2025-12-27 19:30"),
    (81, None, "ãŠæ­£æœˆç”¨ã«ä½Žç³–è³ªç¾Šç¾¹è²·ã£ã¦ã¿ãŸ", "2025-12-28 11:00"),
    (82, 81, "ã©ã“ã®ï¼Ÿé è—¤è£½é¤¡ï¼Ÿ", "2025-12-28 11:30"),
    (83, 81, "ãã†ã§ã™ï¼ã‚¼ãƒ­ã‚«ãƒ­ãƒªãƒ¼ç¾Šç¾¹ã£ã¦ã‚„ã¤", "2025-12-28 12:00"),
    (84, None, "å¤œä¸­ã«ãŠè…¹ç©ºãã‚“ã ã‘ã©ä½•ã‹é£Ÿã¹ã¦ã„ã„ã®ã‹ãª", "2025-12-28 23:30"),
    (85, 84, "ãƒ›ãƒƒãƒˆãƒŸãƒ«ã‚¯é£²ã‚€ã¨è½ã¡ç€ãã¾ã™ã‚ˆ", "2025-12-29 00:00"),
    (86, 84, "ãƒãƒ¼ã‚º1å€‹ãã‚‰ã„ãªã‚‰å¤§ä¸ˆå¤«ã§ã¯ï¼Ÿ", "2025-12-29 07:30"),
    (87, None, "å¹´æœ«ã®è¦ªæˆšã®é›†ã¾ã‚Šã§ãŠè“å­åœ°ç„ã«ãªã‚Šãã†", "2025-12-29 15:00"),
    (88, 87, "æ–­ã‚‹å‹‡æ°—ã‚‚å¤§äº‹ã§ã™ã‚ˆã­â€¦é›£ã—ã„ã‘ã©", "2025-12-29 15:30"),
    (89, None, "ã‚½ã‚¤ã‚¸ãƒ§ã‚¤ã£ã¦ç³–è³ªã©ã®ãã‚‰ã„ã§ã™ã‹ï¼Ÿ", "2025-12-29 18:00"),
    (90, 89, "ç¨®é¡žã«ã‚ˆã‚‹ã‘ã©5ã€œ11gãã‚‰ã„ã§ã™", "2025-12-29 18:30"),
    (91, 90, "ãƒ”ãƒ¼ãƒŠãƒƒãƒ„å‘³ãŒä¸€ç•ªç³–è³ªä½Žã„ã¿ãŸã„ã§ã™ã‚ˆ", "2025-12-29 19:00"),
    (92, None, "ä»Šå¹´æœ€å¾Œã®ãŠã‚„ã¤ä½•ã«ã—ã‚ˆã†", "2025-12-31 15:00"),
    (93, 92, "ç§ã¯é«˜ã‚«ã‚«ã‚ªãƒãƒ§ã‚³ã§ã—ã‚ã¾ã™ç¬‘", "2025-12-31 15:30"),
    (94, None, "å¹´è¶Šã—ãã°ã®ä»£ã‚ã‚Šã«ç³–è³ª0éººé£Ÿã¹ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2025-12-31 19:00"),
    (95, 94, "ç´€æ–‡ã®ç³–è³ª0éººä½¿ã£ã¦ã¾ã™ï¼", "2025-12-31 19:30"),
    (96, None, "ã‚ã‘ã¾ã—ã¦ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ðŸŽä»Šå¹´ã‚‚ãŠã‚„ã¤é ‘å¼µã‚ã†", "2026-01-01 10:00"),
    (97, 96, "ã‚ã‘ãŠã‚ã§ã™ï¼ä»Šå¹´ã‚‚æƒ…å ±äº¤æ›ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™", "2026-01-01 10:30"),
    (98, None, "ãŠé›‘ç…®ã®ãŠé¤…æˆ‘æ…¢ã§ããªã‹ã£ãŸâ€¦1å€‹ã ã‘é£Ÿã¹ãŸ", "2026-01-01 13:00"),
    (99, 98, "ãŠæ­£æœˆãã‚‰ã„ã„ã„ã¨æ€ã„ã¾ã™ï¼", "2026-01-01 13:30"),
    (100, None, "ä½Žç³–è³ªã®é»’è±†ã‚ã‚‹ã£ã¦çŸ¥ã£ã¦ã¾ã—ãŸï¼Ÿ", "2026-01-02 14:00"),
    (101, 100, "ç ‚ç³–ã®ä»£ã‚ã‚Šã«ãƒ©ã‚«ãƒ³ãƒˆä½¿ã£ãŸã‚„ã¤ã§ã™ã‚ˆã­", "2026-01-02 14:30"),
    (102, None, "æ­£æœˆå¤ªã‚ŠãŒæ€–ã„â€¦ãŠã‚„ã¤æŽ§ãˆã‚ã«ã—ãªãã‚ƒ", "2026-01-03 11:00"),
    (103, 102, "ç§ã‚‚2kgå¢—ãˆãŸðŸ˜±", "2026-01-03 11:30"),
    (104, None, "ã‚»ãƒ–ãƒ³ã®å¯’å¤©ã‚¼ãƒªãƒ¼ã‚¼ãƒ­ã‚«ãƒ­ãƒªãƒ¼ã§åŠ©ã‹ã‚‹", "2026-01-03 16:00"),
    (105, 104, "ã‚Šã‚“ã”å‘³ãŠã„ã—ã„ã§ã™ã‚ˆã­", "2026-01-03 16:30"),
    (106, None, "ã‚¨ãƒªã‚¹ãƒªãƒˆãƒ¼ãƒ«ã£ã¦æœ¬å½“ã«è¡€ç³–å€¤ä¸ŠãŒã‚‰ãªã„ã‚“ã§ã™ã‹ï¼Ÿ", "2026-01-04 10:00"),
    (107, 106, "ç§ã¯ãƒªãƒ–ãƒ¬ã§ç¢ºèªã—ãŸã‘ã©ä¸ŠãŒã‚‰ãªã‹ã£ãŸã§ã™ã‚ˆ", "2026-01-04 10:30"),
    (108, 107, "å€‹äººå·®ã‚ã‚‹ã¿ãŸã„ã ã‹ã‚‰è‡ªåˆ†ã§è©¦ã™ã®ãŒä¸€ç•ªã§ã™ã­", "2026-01-04 11:00"),
    (109, None, "iHerbã§ä½Žç³–è³ªã®ãŠè“å­è²·ã£ã¦ã‚‹äººã„ã¾ã™ã‹ï¼Ÿ", "2026-01-05 14:00"),
    (110, 109, "Quest Barã‚ˆãè²·ã„ã¾ã™ï¼", "2026-01-05 14:30"),
    (111, 110, "æµ·å¤–ã®æ–¹ãŒç¨®é¡žå¤šã„ã§ã™ã‚ˆã­", "2026-01-05 15:00"),
    (112, None, "ãƒ­ãƒ¼ã‚½ãƒ³ã®ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ¼ãƒŠãƒ„ã«ãƒãƒžã£ã¦ã‚‹", "2026-01-06 16:00"),
    (113, 112, "ç³–è³ª13gãã‚‰ã„ã ã£ã‘ï¼Ÿãã‚Œã§ãƒ‰ãƒ¼ãƒŠãƒ„é£Ÿã¹ã‚‰ã‚Œã‚‹ã®ã™ã”ã„", "2026-01-06 16:30"),
    (114, None, "ãƒ”ã‚¹ã‚¿ãƒã‚ªã‚‚ãŠã‚„ã¤ã«ã„ã„ã§ã™ã‚ˆ", "2026-01-06 20:00"),
    (115, 114, "æ®»ã‚€ãã®ãŒé¢å€’ã ã‘ã©é£Ÿã¹ã™ãŽé˜²æ­¢ã«ãªã‚‹ã‹ã‚‚", "2026-01-06 20:30"),
    (116, None, "ã‚¯ãƒªãƒ¼ãƒ ãƒãƒ¼ã‚ºã«ãƒ©ã‚«ãƒ³ãƒˆã‹ã‘ã¦ãƒ‡ã‚¶ãƒ¼ãƒˆã«ã—ã¦ã¾ã™", "2026-01-07 19:00"),
    (117, 116, "ãã‚Œã‚ã£ã¡ã‚ƒãŠã„ã—ãã†ï¼", "2026-01-07 19:30"),
    (118, None, "ä»•äº‹ä¸­ã«ç”˜ã„ã‚‚ã®é£Ÿã¹ãŸããªã‚‹â€¦ãƒ‡ã‚¹ã‚¯ã«ä½•ç½®ã„ã¦ã¾ã™ã‹ï¼Ÿ", "2026-01-08 14:00"),
    (119, 118, "ç´ ç„¼ããƒŠãƒƒãƒ„ã®å°è¢‹å¸¸å‚™ã—ã¦ã¾ã™", "2026-01-08 14:30"),
    (120, 118, "ç§ã¯ãƒãƒ¼ã‚ºãŠã‚„ã¤å…¥ã‚Œã¦ã¾ã™", "2026-01-08 15:00"),
    (121, None, "ä½Žç³–è³ªãƒ—ãƒªãƒ³ä½œã£ã¦ã¿ãŸã‘ã©é›£ã—ã‹ã£ãŸ", "2026-01-09 20:00"),
    (122, 121, "è±†ä¹³ä½¿ã†ã¨ãƒ˜ãƒ«ã‚·ãƒ¼ã«ãªã‚Šã¾ã™ã‚ˆ", "2026-01-09 20:30"),
    (123, None, "ãƒžã‚«ãƒ€ãƒŸã‚¢ãƒŠãƒƒãƒ„ã‚‚ç³–è³ªä½Žã„ã§ã™ã‚ˆã­", "2026-01-10 11:00"),
    (124, 123, "é«˜ã„ã‘ã©ãŠã„ã—ã„â€¦ã”è¤’ç¾Žç”¨ã«ã—ã¦ã¾ã™", "2026-01-10 11:30"),
    (125, None, "ã‚¢ãƒ¼ãƒ¢ãƒ³ãƒ‰ãƒŸãƒ«ã‚¯ã§ã‚¹ãƒ ãƒ¼ã‚¸ãƒ¼ä½œã£ã¦ã‚‹", "2026-01-11 15:00"),
    (126, 125, "ãƒ•ãƒ«ãƒ¼ãƒ„å…¥ã‚Œã™ãŽã‚‹ã¨ç³–è³ªä¸ŠãŒã‚‹ã‹ã‚‰æ³¨æ„ã§ã™ã­", "2026-01-11 15:30"),
    (127, None, "ããªç²‰ãƒ¨ãƒ¼ã‚°ãƒ«ãƒˆãŠã™ã™ã‚ã§ã™", "2026-01-12 10:00"),
    (128, 127, "ããªç²‰ã¯ç³–è³ªæ°—ã«ãªã‚‰ãªã„ï¼Ÿ", "2026-01-12 10:30"),
    (129, 127, "å¤§ã•ã˜1ãã‚‰ã„ãªã‚‰å¤§ä¸ˆå¤«ã§ã™ã‚ˆ", "2026-01-12 11:00"),
    (130, None, "ã‚³ã‚¹ãƒˆã‚³ã®ãƒ­ã‚«ãƒœãƒŠãƒƒãƒ„å¤§é‡è²·ã„ã—ãŸ", "2026-01-13 14:00"),
    (131, 130, "ã‚³ã‚¹ãƒ‘ã„ã„ã§ã™ã‚ˆã­ï¼", "2026-01-13 14:30"),
    (132, None, "ãŠã‚„ã¤ã‚„ã‚ã¦1ãƒ¶æœˆçµŒã£ãŸã‘ã©ã‚‚ã†æ…£ã‚ŒãŸ", "2026-01-14 19:00"),
    (133, 132, "ã™ã”ã„ï¼æ„å¿—å¼·ã„ã§ã™ã­", "2026-01-14 19:30"),
    (134, 132, "HbA1cä¸‹ãŒã‚Šã¾ã—ãŸï¼Ÿ", "2026-01-14 20:00"),
    (135, 132, "æ¥æœˆæ¤œæŸ»ãªã®ã§ãƒ‰ã‚­ãƒ‰ã‚­ã§ã™", "2026-01-14 20:30"),
    (136, None, "ãƒ©ã‚«ãƒ³ãƒˆé«˜ã„ã‹ã‚‰ä»£ã‚ã‚Šã«ãƒ‘ãƒ«ã‚¹ã‚¤ãƒ¼ãƒˆä½¿ã£ã¦ã‚‹", "2026-01-15 16:00"),
    (137, 136, "ãƒ‘ãƒ«ã‚¹ã‚¤ãƒ¼ãƒˆã‚‚ä¾¿åˆ©ã§ã™ã‚ˆã­", "2026-01-15 16:30"),
    (138, None, "çµå±€ãŠã‚„ã¤ã¯å®Œå…¨ã«ã‚„ã‚ã‚‹ã‚ˆã‚Šä¸Šæ‰‹ã«ä»˜ãåˆã†ã®ãŒå¤§äº‹ã ã¨æ€ã†", "2026-01-16 20:00"),
    (139, 138, "åŒæ„Ÿã§ã™ï¼ã‚¹ãƒˆãƒ¬ã‚¹æºœã‚ã™ãŽã‚‚ã‚ˆããªã„ã—", "2026-01-16 20:30"),
    (140, None, "ã“ã®ã‚¹ãƒ¬å‚è€ƒã«ãªã‚‹ã€‚ã¿ã‚“ãªã‚ã‚ŠãŒã¨ã†", "2026-01-17 19:00"),
    (141, 140, "æƒ…å ±äº¤æ›ã§ãã¦å¬‰ã—ã„ã§ã™ðŸ˜Š", "2026-01-17 19:30"),
]


def jst_to_utc(jst_str):
    dt = datetime.strptime(jst_str, "%Y-%m-%d %H:%M")
    dt_utc = dt - timedelta(hours=9)
    return dt_utc.strftime("%Y-%m-%dT%H:%M:%S+00:00")


def assign_user_ids(comments):
    user_map = {}
    user_idx = 0
    for num, reply_to, body, dt in comments:
        if reply_to and reply_to in user_map:
            parent_user = user_map[reply_to]
            candidate = USERS[user_idx % len(USERS)]
            while candidate == parent_user:
                user_idx += 1
                candidate = USERS[user_idx % len(USERS)]
            user_map[num] = candidate
            user_idx += 1
        else:
            user_map[num] = USERS[user_idx % len(USERS)]
            user_idx += 1
    return user_map


def insert_batch(records, batch_num):
    url = f"{SUPABASE_URL}/rest/v1/comments"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps(records).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="POST")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Batch {batch_num}: {resp.status} - {len(records)} records inserted")
            return True
    except urllib.error.HTTPError as e:
        print(f"  Batch {batch_num}: ERROR {e.code} - {e.read().decode()}")
        return False


def main():
    print(f"Processing {len(COMMENTS)} comments for thread No.17")
    print(f"Thread ID: {THREAD_ID}")

    comment_uuids = {}
    for num, _, _, _ in COMMENTS:
        comment_uuids[num] = str(uuid.uuid4())

    user_map = assign_user_ids(COMMENTS)

    records = []
    now_utc = datetime.now(timezone.utc)
    past_count = 0
    future_count = 0

    for num, reply_to, body, dt_jst in COMMENTS:
        utc_str = jst_to_utc(dt_jst)
        dt_obj = datetime.strptime(dt_jst, "%Y-%m-%d %H:%M").replace(tzinfo=timezone(timedelta(hours=9)))
        if dt_obj > now_utc:
            future_count += 1
        else:
            past_count += 1

        parent_id = comment_uuids[reply_to] if reply_to else None
        record = {
            "id": comment_uuids[num],
            "thread_id": THREAD_ID,
            "body": body,
            "user_id": user_map[num],
            "is_hidden": False,
            "created_at": utc_str,
            "parent_id": parent_id,
        }
        records.append(record)

    print(f"Past comments: {past_count}")
    print(f"Future comments: {future_count}")
    print(f"Total: {len(records)}")
    print()

    BATCH_SIZE = 50
    for i in range(0, len(records), BATCH_SIZE):
        batch = records[i:i+BATCH_SIZE]
        batch_num = i // BATCH_SIZE + 1
        if not insert_batch(batch, batch_num):
            print("STOPPING due to error")
            return

    print(f"\nAll {len(records)} comments inserted!")

    print(f"\nUpdating comments_count to {past_count}...")
    url = f"{SUPABASE_URL}/rest/v1/threads?id=eq.{THREAD_ID}"
    headers = {
        "apikey": SUPABASE_KEY,
        "Authorization": f"Bearer {SUPABASE_KEY}",
        "Content-Type": "application/json",
        "Prefer": "return=minimal",
    }
    data = json.dumps({"comments_count": past_count}).encode("utf-8")
    req = urllib.request.Request(url, data=data, headers=headers, method="PATCH")
    try:
        with urllib.request.urlopen(req) as resp:
            print(f"  Updated: {resp.status}")
    except urllib.error.HTTPError as e:
        print(f"  ERROR: {e.code} - {e.read().decode()}")


if __name__ == "__main__":
    main()
